<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libemf.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>libemf.h</h1><div class="fragment"><pre>00001 <font class="comment">/* -*- c++ -*-</font>
00002 <font class="comment"> * EMF: A library for generating ECMA-234 Enhanced Metafiles</font>
00003 <font class="comment"> * Copyright (C) 2002 lignum Computing, Inc. &lt;libemf@lignumcomputing.com&gt;</font>
00004 <font class="comment"> * $Id: libemf_8h-source.html,v 1.5 2003/01/14 03:57:22 allen Exp $</font>
00005 <font class="comment"> *</font>
00006 <font class="comment"> * This library is free software; you can redistribute it and/or</font>
00007 <font class="comment"> * modify it under the terms of the GNU Lesser General Public</font>
00008 <font class="comment"> * License as published by the Free Software Foundation; either</font>
00009 <font class="comment"> * version 2.1 of the License, or (at your option) any later version.</font>
00010 <font class="comment"> *</font>
00011 <font class="comment"> * This library is distributed in the hope that it will be useful,</font>
00012 <font class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment"> * Lesser General Public License for more details.</font>
00015 <font class="comment"> *</font>
00016 <font class="comment"> * You should have received a copy of the GNU Lesser General Public</font>
00017 <font class="comment"> * License along with this library; if not, write to the Free Software</font>
00018 <font class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</font>
00019 <font class="comment"> *</font>
00020 <font class="comment"> */</font>
00021 <font class="preprocessor">#ifndef _LIBEMF_H</font>
00022 <font class="preprocessor"></font><font class="preprocessor">#define _LIBEMF_H 1</font>
00023 <font class="preprocessor"></font>
00024 <font class="preprocessor">#include &lt;cmath&gt;</font>
00025 <font class="preprocessor">#include &lt;vector&gt;</font>
00026 <font class="preprocessor">#include &lt;map&gt;</font>
00027 <font class="preprocessor">#include &lt;functional&gt;</font>
00028 <font class="preprocessor">#include &lt;algorithm&gt;</font>
00029 
00030 <font class="preprocessor">#include &lt;config.h&gt;</font>
00031 <font class="preprocessor">#include &lt;libEMF/emf.h&gt;</font>
00032 
00033 <font class="preprocessor">#include &lt;libEMF/wine/w16.h&gt;</font>
00034 
00035 <font class="keyword">namespace </font>EMF {
00040 <font class="preprocessor">#if 1</font>
00041 <font class="preprocessor"></font>  <font class="keyword">const</font> <font class="keywordtype">int</font> XMAX_PIXELS = 1024; <font class="comment">/*(INT_MAX)*/</font>
00042 <font class="preprocessor">#else</font>
00043 <font class="preprocessor"></font>  <font class="keyword">const</font> <font class="keywordtype">int</font> XMAX_PIXELS = 1280; <font class="comment">/*(INT_MAX)*/</font>
00044 <font class="preprocessor">#endif</font>
00045 <font class="preprocessor"></font>
00049 <font class="preprocessor">#if 1</font>
00050 <font class="preprocessor"></font>  <font class="keyword">const</font> <font class="keywordtype">int</font> YMAX_PIXELS = 768; <font class="comment">/*(INT_MAX)*/</font>
00051 <font class="preprocessor">#else</font>
00052 <font class="preprocessor"></font>  <font class="keyword">const</font> <font class="keywordtype">int</font> YMAX_PIXELS = 1024; <font class="comment">/*(INT_MAX)*/</font>
00053 <font class="preprocessor">#endif</font>
00054 <font class="preprocessor"></font>
00059   <font class="keyword">const</font> <font class="keywordtype">int</font> XMAX_MM = 320;
00065   <font class="keyword">const</font> <font class="keywordtype">int</font> YMAX_MM = 240;
00069   <font class="keyword">const</font> <font class="keywordtype">int</font> RESOLUTION = 96;
00073   <font class="keyword">static</font> <font class="keyword">inline</font> <font class="keywordtype">int</font> ROUND_TO_LONG ( <font class="keywordtype">int</font> n )<font class="keyword"> </font>{ <font class="keywordflow">return</font> ((n+3)/4)*4; }
00074 
00076 
<a name="l00081"></a><a class="code" href="structEMF_1_1WCHARSTR.html">00081</a>   <font class="keyword">struct </font>WCHARSTR {
<a name="l00082"></a><a class="code" href="structEMF_1_1WCHARSTR.html#m0">00082</a>     WCHAR *<font class="keyword">const</font> string_;       
<a name="l00083"></a><a class="code" href="structEMF_1_1WCHARSTR.html#m1">00083</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> length_;          
00084 
<a name="l00089"></a><a class="code" href="structEMF_1_1WCHARSTR.html#a0">00089</a>     <a class="code" href="structEMF_1_1WCHARSTR.html#a0">WCHARSTR</a> ( WCHAR *<font class="keyword">const</font> string, <font class="keyword">const</font> <font class="keywordtype">int</font> length )
00090       : string_( string ), length_( length ) {}
00091   };
00092 
00094 
<a name="l00099"></a><a class="code" href="structEMF_1_1CHARSTR.html">00099</a>   <font class="keyword">struct </font>CHARSTR {
<a name="l00100"></a><a class="code" href="structEMF_1_1CHARSTR.html#m0">00100</a>     CHAR *<font class="keyword">const</font> string_;        
<a name="l00101"></a><a class="code" href="structEMF_1_1CHARSTR.html#m1">00101</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> length_;          
00102 
<a name="l00107"></a><a class="code" href="structEMF_1_1CHARSTR.html#a0">00107</a>     <a class="code" href="structEMF_1_1CHARSTR.html#a0">CHARSTR</a> ( CHAR *<font class="keyword">const</font> string, <font class="keyword">const</font> <font class="keywordtype">int</font> length )
00108       : string_( string ), length_( length ) {}
00109   };
00110 
00112 
<a name="l00116"></a><a class="code" href="structEMF_1_1BYTEARRAY.html">00116</a>   <font class="keyword">struct </font>BYTEARRAY {
<a name="l00117"></a><a class="code" href="structEMF_1_1BYTEARRAY.html#m0">00117</a>     BYTE *<font class="keyword">const</font> array_;         
<a name="l00118"></a><a class="code" href="structEMF_1_1BYTEARRAY.html#m1">00118</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> n_;               
00119 
<a name="l00124"></a><a class="code" href="structEMF_1_1BYTEARRAY.html#a0">00124</a>     <a class="code" href="structEMF_1_1BYTEARRAY.html#a0">BYTEARRAY</a> ( BYTE *<font class="keyword">const</font> array, <font class="keyword">const</font> <font class="keywordtype">int</font> n )
00125       : array_( array ), n_( n ) {}
00126   };
00127 
00129 
<a name="l00132"></a><a class="code" href="structEMF_1_1POINTLARRAY.html">00132</a>   <font class="keyword">struct </font>POINTLARRAY {
<a name="l00133"></a><a class="code" href="structEMF_1_1POINTLARRAY.html#m0">00133</a>     POINTL *<font class="keyword">const</font> points_;      
<a name="l00134"></a><a class="code" href="structEMF_1_1POINTLARRAY.html#m1">00134</a>     <font class="keyword">const</font> DWORD n_;             
00135 
<a name="l00140"></a><a class="code" href="structEMF_1_1POINTLARRAY.html#a0">00140</a>     <a class="code" href="structEMF_1_1POINTLARRAY.html#a0">POINTLARRAY</a> ( POINTL *<font class="keyword">const</font> points, <font class="keyword">const</font> DWORD n )
00141       : points_( points ), n_( n ) {}
00142   };
00143 
00145 
<a name="l00148"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html">00148</a>   <font class="keyword">struct </font>POINT16ARRAY {
<a name="l00149"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html#m0">00149</a>     POINT16 *<font class="keyword">const</font> points_;     
<a name="l00150"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html#m1">00150</a>     <font class="keyword">const</font> DWORD n_;             
00151 
<a name="l00156"></a><a class="code" href="structEMF_1_1POINT16ARRAY.html#a0">00156</a>     <a class="code" href="structEMF_1_1POINT16ARRAY.html#a0">POINT16ARRAY</a> ( POINT16 *<font class="keyword">const</font> points, <font class="keyword">const</font> DWORD n )
00157       : points_( points ), n_( n ) {}
00158   };
00159 
00161 
<a name="l00164"></a><a class="code" href="structEMF_1_1INTARRAY.html">00164</a>   <font class="keyword">struct </font>INTARRAY {
<a name="l00165"></a><a class="code" href="structEMF_1_1INTARRAY.html#m0">00165</a>     INT *<font class="keyword">const</font> ints_;           
<a name="l00166"></a><a class="code" href="structEMF_1_1INTARRAY.html#m1">00166</a>     <font class="keyword">const</font> DWORD n_;             
00167 
<a name="l00172"></a><a class="code" href="structEMF_1_1INTARRAY.html#a0">00172</a>     <a class="code" href="structEMF_1_1INTARRAY.html#a0">INTARRAY</a> ( INT *<font class="keyword">const</font> ints, <font class="keyword">const</font> DWORD n )
00173       : ints_( ints ), n_( n ) {}
00174   };
00175 
00177 
<a name="l00180"></a><a class="code" href="structEMF_1_1DWORDARRAY.html">00180</a>   <font class="keyword">struct </font>DWORDARRAY {
<a name="l00181"></a><a class="code" href="structEMF_1_1DWORDARRAY.html#m0">00181</a>     DWORD *<font class="keyword">const</font> dwords_;       
<a name="l00182"></a><a class="code" href="structEMF_1_1DWORDARRAY.html#m1">00182</a>     <font class="keyword">const</font> DWORD n_;             
00183 
<a name="l00188"></a><a class="code" href="structEMF_1_1DWORDARRAY.html#a0">00188</a>     <a class="code" href="structEMF_1_1DWORDARRAY.html#a0">DWORDARRAY</a> ( DWORD *<font class="keyword">const</font> dwords, <font class="keyword">const</font> DWORD n )
00189       : dwords_( dwords ), n_( n ) {}
00190   };
00191 
00193 
<a name="l00196"></a><a class="code" href="structEMF_1_1PADDING.html">00196</a>   <font class="keyword">struct </font>PADDING {
<a name="l00197"></a><a class="code" href="structEMF_1_1PADDING.html#p0">00197</a>     <font class="keyword">static</font> <font class="keyword">const</font> <font class="keywordtype">char</font> padding_[4]; 
<a name="l00198"></a><a class="code" href="structEMF_1_1PADDING.html#m0">00198</a>     <font class="keyword">const</font> <font class="keywordtype">int</font> size_;            
00199 
<a name="l00203"></a><a class="code" href="structEMF_1_1PADDING.html#a0">00203</a>     <a class="code" href="structEMF_1_1PADDING.html#a0">PADDING</a> ( <font class="keyword">const</font> <font class="keywordtype">int</font> size ) : size_( size ) {}
00204   };
00205   
00207 
<a name="l00214"></a><a class="code" href="classEMF_1_1DATASTREAM.html">00214</a>   <font class="keyword">class </font>DATASTREAM {
00215     <font class="keywordtype">bool</font> swap_;
00216     ::FILE* fp_;
00217 
00218     <font class="keyword">static</font> <font class="keywordtype">bool</font> bigEndian ( <font class="keywordtype">void</font> );
00219   <font class="keyword">public</font>:
<a name="l00225"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a0">00225</a>     <a class="code" href="classEMF_1_1DATASTREAM.html#a0">DATASTREAM</a> ( ::FILE* fp = 0 ) : swap_( bigEndian() ), fp_( fp ) {}
<a name="l00230"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a1">00230</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1DATASTREAM.html#a1">setStream</a> ( ::FILE* fp )<font class="keyword"> </font>{ fp_ = fp; }
<a name="l00235"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a2">00235</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> BYTE&amp; byte )<font class="keyword"></font>
00236 <font class="keyword">    </font>{
00237       fwrite( &amp;byte, <font class="keyword">sizeof</font>(BYTE), 1, fp_ );
00238       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00239     }
<a name="l00244"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a3">00244</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( BYTE&amp; byte )<font class="keyword"></font>
00245 <font class="keyword">    </font>{
00246       fread( &amp;byte, <font class="keyword">sizeof</font>(BYTE), 1, fp_ );
00247       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00248     }
<a name="l00253"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a4">00253</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> WORD&amp; word )<font class="keyword"></font>
00254 <font class="keyword">    </font>{
00255       <font class="keywordflow">if</font> ( swap_ ) {
00256         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font> * p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;word;
00257         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00258         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00259       }
00260       <font class="keywordflow">else</font>
00261         fwrite( &amp;word, <font class="keyword">sizeof</font>(WORD), 1, fp_ );
00262       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00263     }
<a name="l00268"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a5">00268</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( WORD&amp; word )<font class="keyword"></font>
00269 <font class="keyword">    </font>{
00270       <font class="keywordflow">if</font> ( swap_ ) {
00271         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;word;
00272         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00273         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00274       }
00275       <font class="keywordflow">else</font>
00276         fread( &amp;word, <font class="keyword">sizeof</font>(WORD), 1, fp_ );
00277       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00278     }
<a name="l00283"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a6">00283</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> INT16&amp; word )<font class="keyword"></font>
00284 <font class="keyword">    </font>{
00285       <font class="keywordflow">if</font> ( swap_ ) {
00286         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font> * p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;word;
00287         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00288         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00289       }
00290       <font class="keywordflow">else</font>
00291         fwrite( &amp;word, <font class="keyword">sizeof</font>(INT16), 1, fp_ );
00292       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00293     }
<a name="l00298"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a7">00298</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( INT16&amp; word )<font class="keyword"></font>
00299 <font class="keyword">    </font>{
00300       <font class="keywordflow">if</font> ( swap_ ) {
00301         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;word;
00302         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00303         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00304       }
00305       <font class="keywordflow">else</font>
00306         fread( &amp;word, <font class="keyword">sizeof</font>(INT16), 1, fp_ );
00307       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00308     }
<a name="l00313"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a8">00313</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> DWORD&amp; dword )<font class="keyword"></font>
00314 <font class="keyword">    </font>{
00315       <font class="keywordflow">if</font> ( swap_ ) {
00316         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;dword;
00317         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00318         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00319         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00320         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00321       }
00322       <font class="keywordflow">else</font>
00323         fwrite( &amp;dword, <font class="keyword">sizeof</font>(DWORD), 1, fp_ );
00324       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00325     }
<a name="l00330"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a9">00330</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( DWORD&amp; dword )<font class="keyword"></font>
00331 <font class="keyword">    </font>{
00332       <font class="keywordflow">if</font> ( swap_ ) {
00333         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;dword;
00334         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00335         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00336         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00337         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00338       }
00339       <font class="keywordflow">else</font>
00340         fread( &amp;dword, <font class="keyword">sizeof</font>(DWORD), 1, fp_ );
00341       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00342     }
<a name="l00347"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a10">00347</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LONG&amp; long_ )<font class="keyword"></font>
00348 <font class="keyword">    </font>{
00349       <font class="keywordflow">if</font> ( swap_ ) {
00350         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;long_;
00351         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00352         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00353         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00354         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00355       }
00356       <font class="keywordflow">else</font>
00357         fwrite( &amp;long_, <font class="keyword">sizeof</font>(LONG), 1, fp_ );
00358       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00359     }
<a name="l00364"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a11">00364</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LONG&amp; long_ )<font class="keyword"></font>
00365 <font class="keyword">    </font>{
00366       <font class="keywordflow">if</font> ( swap_ ) {
00367         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;long_;
00368         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00369         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00370         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00371         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00372       }
00373       <font class="keywordflow">else</font>
00374         fread( &amp;long_, <font class="keyword">sizeof</font>(LONG), 1, fp_ );
00375       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00376     }
<a name="l00381"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a12">00381</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> INT&amp; int_ )<font class="keyword"></font>
00382 <font class="keyword">    </font>{
00383       <font class="keywordflow">if</font> ( swap_ ) {
00384         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;int_;
00385         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00386         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00387         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00388         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00389       }
00390       <font class="keywordflow">else</font>
00391         fwrite( &amp;int_, <font class="keyword">sizeof</font>(INT), 1, fp_ );
00392       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00393     }
<a name="l00398"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a13">00398</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( INT&amp; int_ )<font class="keyword"></font>
00399 <font class="keyword">    </font>{
00400       <font class="keywordflow">if</font> ( swap_ ) {
00401         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;int_;
00402         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00403         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00404         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00405         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00406       }
00407       <font class="keywordflow">else</font>
00408         fread( &amp;int_, <font class="keyword">sizeof</font>(INT), 1, fp_ );
00409       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00410     }
<a name="l00415"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a14">00415</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> UINT&amp; uint )<font class="keyword"></font>
00416 <font class="keyword">    </font>{
00417       <font class="keywordflow">if</font> ( swap_ ) {
00418         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;uint;
00419         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00420         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00421         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00422         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00423       }
00424       <font class="keywordflow">else</font>
00425         fwrite( &amp;uint, <font class="keyword">sizeof</font>(UINT), 1, fp_ );
00426       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00427     }
<a name="l00432"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a15">00432</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( UINT&amp; uint )<font class="keyword"></font>
00433 <font class="keyword">    </font>{
00434       <font class="keywordflow">if</font> ( swap_ ) {
00435         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;uint;
00436         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00437         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00438         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00439         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00440       }
00441       <font class="keywordflow">else</font>
00442         fread( &amp;uint, <font class="keyword">sizeof</font>(UINT), 1, fp_ );
00443       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00444     }
<a name="l00449"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a16">00449</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> FLOAT&amp; float_ )<font class="keyword"></font>
00450 <font class="keyword">    </font>{
00451       <font class="keywordflow">if</font> ( swap_ ) {
00452         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> <font class="keyword">const</font>*)&amp;float_;
00453         fwrite( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00454         fwrite( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00455         fwrite( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00456         fwrite( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00457       }
00458       <font class="keywordflow">else</font>
00459         fwrite( &amp;float_, <font class="keyword">sizeof</font>(FLOAT), 1, fp_ );
00460       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00461     }
<a name="l00466"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a17">00466</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( FLOAT&amp; float_ )<font class="keyword"></font>
00467 <font class="keyword">    </font>{
00468       <font class="keywordflow">if</font> ( swap_ ) {
00469         <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>* p = (<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>*)&amp;float_;
00470         fread( &amp;p[3], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00471         fread( &amp;p[2], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00472         fread( &amp;p[1], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00473         fread( &amp;p[0], <font class="keyword">sizeof</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>), 1, fp_ );
00474       }
00475       <font class="keywordflow">else</font>
00476         fread( &amp;float_, <font class="keyword">sizeof</font>(FLOAT), 1, fp_ );
00477       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00478     }
<a name="l00483"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a18">00483</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> PADDING&amp; padding )<font class="keyword"></font>
00484 <font class="keyword">    </font>{
00485       <font class="keywordflow">if</font> ( padding.size_ != 0 )
00486         fwrite( &amp;padding.padding_, <font class="keyword">sizeof</font>(CHAR), padding.size_, fp_ );
00487       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00488     }
<a name="l00493"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a19">00493</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> RECTL&amp; rectl )<font class="keyword"></font>
00494 <font class="keyword">    </font>{
00495       *<font class="keyword">this</font> &lt;&lt; rectl.left &lt;&lt; rectl.top &lt;&lt; rectl.right &lt;&lt; rectl.bottom;
00496       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00497     }
<a name="l00502"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a20">00502</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( RECTL&amp; rectl )<font class="keyword"></font>
00503 <font class="keyword">    </font>{
00504       *<font class="keyword">this</font> &gt;&gt; rectl.left &gt;&gt; rectl.top &gt;&gt; rectl.right &gt;&gt; rectl.bottom;
00505       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00506     }
<a name="l00511"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a21">00511</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> SIZEL&amp; sizel )<font class="keyword"></font>
00512 <font class="keyword">    </font>{
00513       *<font class="keyword">this</font> &lt;&lt; sizel.cx &lt;&lt; sizel.cy;
00514       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00515     }
<a name="l00520"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a22">00520</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( SIZEL&amp; sizel )<font class="keyword"></font>
00521 <font class="keyword">    </font>{
00522       *<font class="keyword">this</font> &gt;&gt; sizel.cx &gt;&gt; sizel.cy;
00523       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00524     }
<a name="l00529"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a23">00529</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> WCHARSTR&amp; wcharstr )<font class="keyword"></font>
00530 <font class="keyword">    </font>{
00531       <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i = 0; i &lt; wcharstr.length_; i++ )
00532         *<font class="keyword">this</font> &lt;&lt; wcharstr.string_[i];
00533       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00534     }
<a name="l00539"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a24">00539</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( WCHARSTR&amp; wcharstr )<font class="keyword"></font>
00540 <font class="keyword">    </font>{
00541       <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i = 0; i &lt; wcharstr.length_; i++ )
00542         *<font class="keyword">this</font> &gt;&gt; wcharstr.string_[i];
00543       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00544     }
<a name="l00549"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a25">00549</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> CHARSTR&amp; charstr )<font class="keyword"></font>
00550 <font class="keyword">    </font>{
00551       fwrite( charstr.string_, <font class="keyword">sizeof</font>(CHAR), charstr.length_, fp_ );
00552       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00553     }
<a name="l00558"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a26">00558</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( CHARSTR&amp; charstr )<font class="keyword"></font>
00559 <font class="keyword">    </font>{
00560       fread( charstr.string_, <font class="keyword">sizeof</font>(CHAR), charstr.length_, fp_ );
00561       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00562     }
<a name="l00567"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a27">00567</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> ::EMR&amp; emr )<font class="keyword"></font>
00568 <font class="keyword">    </font>{
00569       *<font class="keyword">this</font> &lt;&lt; emr.iType &lt;&lt; emr.nSize;
00570       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00571     }
<a name="l00576"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a28">00576</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( ::EMR&amp; emr )<font class="keyword"></font>
00577 <font class="keyword">    </font>{
00578       *<font class="keyword">this</font> &gt;&gt; emr.iType &gt;&gt; emr.nSize;
00579       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00580     }
<a name="l00585"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a29">00585</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINT&amp; point )<font class="keyword"></font>
00586 <font class="keyword">    </font>{
00587       *<font class="keyword">this</font> &lt;&lt; point.x &lt;&lt; point.y;
00588       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00589     }
<a name="l00594"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a30">00594</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINT&amp; point )<font class="keyword"></font>
00595 <font class="keyword">    </font>{
00596       *<font class="keyword">this</font> &gt;&gt; point.x &gt;&gt; point.y;
00597       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00598     }
<a name="l00603"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a31">00603</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINTL&amp; pointl )<font class="keyword"></font>
00604 <font class="keyword">    </font>{
00605       *<font class="keyword">this</font> &lt;&lt; pointl.x &lt;&lt; pointl.y;
00606       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00607     }
<a name="l00612"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a32">00612</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINTL&amp; pointl )<font class="keyword"></font>
00613 <font class="keyword">    </font>{
00614       *<font class="keyword">this</font> &gt;&gt; pointl.x &gt;&gt; pointl.y;
00615       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00616     }
<a name="l00621"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a33">00621</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINT16&amp; point )<font class="keyword"></font>
00622 <font class="keyword">    </font>{
00623       *<font class="keyword">this</font> &lt;&lt; point.x &lt;&lt; point.y;
00624       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00625     }
<a name="l00630"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a34">00630</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINT16&amp; point )<font class="keyword"></font>
00631 <font class="keyword">    </font>{
00632       *<font class="keyword">this</font> &gt;&gt; point.x &gt;&gt; point.y;
00633       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00634     }
<a name="l00639"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a35">00639</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> XFORM&amp; xform )<font class="keyword"></font>
00640 <font class="keyword">    </font>{
00641       *<font class="keyword">this</font> &lt;&lt; xform.eM11 &lt;&lt; xform.eM12 &lt;&lt; xform.eM21 &lt;&lt; xform.eM22
00642             &lt;&lt; xform.eDx &lt;&lt; xform.eDy;
00643       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00644     }
<a name="l00649"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a36">00649</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( XFORM&amp; xform )<font class="keyword"></font>
00650 <font class="keyword">    </font>{
00651       *<font class="keyword">this</font> &gt;&gt; xform.eM11 &gt;&gt; xform.eM12 &gt;&gt; xform.eM21 &gt;&gt; xform.eM22
00652             &gt;&gt; xform.eDx &gt;&gt; xform.eDy;
00653       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00654     }
<a name="l00659"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a37">00659</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> BYTEARRAY&amp; array )<font class="keyword"></font>
00660 <font class="keyword">    </font>{
00661       fwrite( array.array_, <font class="keyword">sizeof</font>(BYTE), array.n_, fp_ );
00662       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00663     }
<a name="l00668"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a38">00668</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( BYTEARRAY&amp; array )<font class="keyword"></font>
00669 <font class="keyword">    </font>{
00670       fread( array.array_, <font class="keyword">sizeof</font>(BYTE), array.n_, fp_ );
00671       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00672     }
<a name="l00677"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a39">00677</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINTLARRAY&amp; array )<font class="keyword"></font>
00678 <font class="keyword">    </font>{
00679       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00680         *<font class="keyword">this</font> &lt;&lt; array.points_[i];
00681       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00682     }
<a name="l00687"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a40">00687</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINTLARRAY&amp; array )<font class="keyword"></font>
00688 <font class="keyword">    </font>{
00689       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00690         *<font class="keyword">this</font> &gt;&gt; array.points_[i];
00691       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00692     }
<a name="l00697"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a41">00697</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> POINT16ARRAY&amp; array )<font class="keyword"></font>
00698 <font class="keyword">    </font>{
00699       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00700         *<font class="keyword">this</font> &lt;&lt; array.points_[i];
00701       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00702     }
<a name="l00707"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a42">00707</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( POINT16ARRAY&amp; array )<font class="keyword"></font>
00708 <font class="keyword">    </font>{
00709       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00710         *<font class="keyword">this</font> &gt;&gt; array.points_[i];
00711       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00712     }
<a name="l00717"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a43">00717</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> INTARRAY&amp; array )<font class="keyword"></font>
00718 <font class="keyword">    </font>{
00719       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00720         *<font class="keyword">this</font> &lt;&lt; array.ints_[i];
00721       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00722     }
<a name="l00727"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a44">00727</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( INTARRAY&amp; array )<font class="keyword"></font>
00728 <font class="keyword">    </font>{
00729       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00730         *<font class="keyword">this</font> &gt;&gt; array.ints_[i];
00731       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00732     }
<a name="l00737"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a45">00737</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> DWORDARRAY&amp; array )<font class="keyword"></font>
00738 <font class="keyword">    </font>{
00739       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00740         *<font class="keyword">this</font> &lt;&lt; array.dwords_[i];
00741       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00742     }
<a name="l00747"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a46">00747</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( DWORDARRAY&amp; array )<font class="keyword"></font>
00748 <font class="keyword">    </font>{
00749       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; array.n_; i++ )
00750         *<font class="keyword">this</font> &gt;&gt; array.dwords_[i];
00751       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00752     }
<a name="l00757"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a47">00757</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> ::EMRTEXT&amp; text )<font class="keyword"></font>
00758 <font class="keyword">    </font>{
00759       *<font class="keyword">this</font> &lt;&lt; text.ptlReference &lt;&lt; text.nChars &lt;&lt; text.offString &lt;&lt; text.fOptions
00760          &lt;&lt; text.rcl &lt;&lt; text.offDx;
00761       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00762     }
<a name="l00767"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a48">00767</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( ::EMRTEXT&amp; text )<font class="keyword"></font>
00768 <font class="keyword">    </font>{
00769       *<font class="keyword">this</font> &gt;&gt; text.ptlReference &gt;&gt; text.nChars &gt;&gt; text.offString &gt;&gt; text.fOptions
00770             &gt;&gt; text.rcl &gt;&gt; text.offDx;
00771       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00772     }
<a name="l00777"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a49">00777</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGPEN&amp; pen )<font class="keyword"></font>
00778 <font class="keyword">    </font>{
00779       *<font class="keyword">this</font> &lt;&lt; pen.lopnStyle &lt;&lt; pen.lopnWidth &lt;&lt; pen.lopnColor;
00780       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00781     }
<a name="l00786"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a50">00786</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGPEN&amp; pen )<font class="keyword"></font>
00787 <font class="keyword">    </font>{
00788       *<font class="keyword">this</font> &gt;&gt; pen.lopnStyle &gt;&gt; pen.lopnWidth &gt;&gt; pen.lopnColor;
00789       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00790     }
<a name="l00795"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a51">00795</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> EXTLOGPEN&amp; pen )<font class="keyword"></font>
00796 <font class="keyword">    </font>{
00797       <font class="comment">// *** How big is this structure if there are no style entries? ***</font>
00798       *<font class="keyword">this</font> &lt;&lt; pen.elpPenStyle &lt;&lt; pen.elpWidth &lt;&lt; pen.elpBrushStyle &lt;&lt; pen.elpColor
00799             &lt;&lt; pen.elpHatch &lt;&lt; pen.elpNumEntries;
00800       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00801     }
<a name="l00806"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a52">00806</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( EXTLOGPEN&amp; pen )<font class="keyword"></font>
00807 <font class="keyword">    </font>{
00808       <font class="comment">// *** How big is this structure if there are no style entries? ***</font>
00809       *<font class="keyword">this</font> &gt;&gt; pen.elpPenStyle &gt;&gt; pen.elpWidth &gt;&gt; pen.elpBrushStyle &gt;&gt; pen.elpColor
00810             &gt;&gt; pen.elpHatch &gt;&gt; pen.elpNumEntries;
00811       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00812     }
<a name="l00817"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a53">00817</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGBRUSH&amp; brush )<font class="keyword"></font>
00818 <font class="keyword">    </font>{
00819       *<font class="keyword">this</font> &lt;&lt; brush.lbStyle &lt;&lt; brush.lbColor &lt;&lt; brush.lbHatch;
00820       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00821     }
<a name="l00826"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a54">00826</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGBRUSH&amp; brush )<font class="keyword"></font>
00827 <font class="keyword">    </font>{
00828       *<font class="keyword">this</font> &gt;&gt; brush.lbStyle &gt;&gt; brush.lbColor &gt;&gt; brush.lbHatch;
00829       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00830     }
<a name="l00835"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a55">00835</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGFONTW&amp; font )<font class="keyword"></font>
00836 <font class="keyword">    </font>{
00837       *<font class="keyword">this</font> &lt;&lt; font.lfHeight &lt;&lt; font.lfWidth &lt;&lt; font.lfEscapement
00838             &lt;&lt; font.lfOrientation &lt;&lt; font.lfWeight &lt;&lt; font.lfItalic
00839             &lt;&lt; font.lfUnderline &lt;&lt; font.lfStrikeOut &lt;&lt; font.lfCharSet
00840             &lt;&lt; font.lfOutPrecision &lt;&lt; font.lfClipPrecision &lt;&lt; font.lfQuality
00841             &lt;&lt; font.lfPitchAndFamily
00842             &lt;&lt; WCHARSTR( const_cast&lt;WCHAR*const&gt;(font.lfFaceName), LF_FACESIZE );
00843       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00844     }
<a name="l00849"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a56">00849</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGFONTW&amp; font )<font class="keyword"></font>
00850 <font class="keyword">    </font>{
00851       WCHARSTR wFaceName( font.lfFaceName, LF_FACESIZE );
00852 
00853       *<font class="keyword">this</font> &gt;&gt; font.lfHeight &gt;&gt; font.lfWidth &gt;&gt; font.lfEscapement
00854             &gt;&gt; font.lfOrientation &gt;&gt; font.lfWeight &gt;&gt; font.lfItalic
00855             &gt;&gt; font.lfUnderline &gt;&gt; font.lfStrikeOut &gt;&gt; font.lfCharSet
00856             &gt;&gt; font.lfOutPrecision &gt;&gt; font.lfClipPrecision &gt;&gt; font.lfQuality
00857             &gt;&gt; font.lfPitchAndFamily
00858             &gt;&gt; wFaceName;
00859       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00860     }
<a name="l00865"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a57">00865</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> PANOSE&amp; panose )<font class="keyword"></font>
00866 <font class="keyword">    </font>{
00867       fwrite( &amp;panose, <font class="keyword">sizeof</font>(PANOSE), 1, fp_ );
00868       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00869     }
<a name="l00874"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a58">00874</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( PANOSE&amp; panose )<font class="keyword"></font>
00875 <font class="keyword">    </font>{
00876       fread( &amp;panose, <font class="keyword">sizeof</font>(PANOSE), 1, fp_ );
00877       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00878     }
<a name="l00883"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a59">00883</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> EXTLOGFONTW&amp; font )<font class="keyword"></font>
00884 <font class="keyword">    </font>{
00885       *<font class="keyword">this</font> &lt;&lt; font.elfLogFont
00886             &lt;&lt; WCHARSTR( const_cast&lt;WCHAR*const&gt;(font.elfFullName),
00887                          LF_FULLFACESIZE )
00888             &lt;&lt; WCHARSTR( const_cast&lt;WCHAR*const&gt;(font.elfStyle), LF_FACESIZE )
00889             &lt;&lt; font.elfVersion &lt;&lt; font.elfStyleSize &lt;&lt; font.elfMatch
00890             &lt;&lt; font.elfReserved
00891             &lt;&lt; BYTEARRAY( const_cast&lt;BYTE*const&gt;(font.elfVendorId),
00892                           ELF_VENDOR_SIZE )
00893             &lt;&lt; font.elfCulture &lt;&lt; font.elfPanose;
00894       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00895     }
<a name="l00900"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a60">00900</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( EXTLOGFONTW&amp; font )<font class="keyword"></font>
00901 <font class="keyword">    </font>{
00902       WCHARSTR wFullName( font.elfFullName, LF_FULLFACESIZE );
00903       WCHARSTR wStyle( font.elfStyle, LF_FACESIZE );
00904       BYTEARRAY bVendorId( font.elfVendorId, ELF_VENDOR_SIZE );
00905       *<font class="keyword">this</font> &gt;&gt; font.elfLogFont
00906             &gt;&gt; wFullName &gt;&gt; wStyle
00907             &gt;&gt; font.elfVersion &gt;&gt; font.elfStyleSize &gt;&gt; font.elfMatch
00908             &gt;&gt; font.elfReserved &gt;&gt; bVendorId
00909             &gt;&gt; font.elfCulture &gt;&gt; font.elfPanose;
00910       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00911     }
<a name="l00916"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a61">00916</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a2">operator&lt;&lt; </a>( <font class="keyword">const</font> LOGPALETTE&amp; palette )<font class="keyword"></font>
00917 <font class="keyword">    </font>{
00918       <font class="comment">// *** How big is this structure if the palette is empty? ***</font>
00919       *<font class="keyword">this</font> &lt;&lt; palette.palVersion &lt;&lt; palette.palNumEntries;
00920       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00921     }
<a name="l00926"></a><a class="code" href="classEMF_1_1DATASTREAM.html#a62">00926</a>     DATASTREAM&amp; <a class="code" href="classEMF_1_1DATASTREAM.html#a3">operator&gt;&gt; </a>( LOGPALETTE&amp; palette )<font class="keyword"></font>
00927 <font class="keyword">    </font>{
00928       <font class="comment">// *** How big is this structure if the palette is empty? ***</font>
00929       *<font class="keyword">this</font> &gt;&gt; palette.palVersion &gt;&gt; palette.palNumEntries;
00930       <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00931     }
00932   };
00933 
00934   <font class="keyword">class </font>METAFILEDEVICECONTEXT;
00935 
00937 
<a name="l00943"></a><a class="code" href="classEMF_1_1METARECORD.html">00943</a>   <font class="keyword">class </font>METARECORD {
00944   <font class="keyword">public</font>:
00951     <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METARECORD.html#a0">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font> = 0;
00958     <font class="keyword">virtual</font> <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1METARECORD.html#a1">serialize</a> ( DATASTREAM ds ) = 0;
00964     <font class="keyword">virtual</font> <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1METARECORD.html#a2">size</a> ( <font class="keywordtype">void</font> ) <font class="keyword">const</font> = 0;
<a name="l00970"></a><a class="code" href="classEMF_1_1METARECORD.html#a3">00970</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1METARECORD.html#a3">~METARECORD</a>( )<font class="keyword"> </font>{ }
00971 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
00972 <font class="preprocessor"></font>
00976     <font class="keyword">virtual</font> <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{}
00977 <font class="preprocessor">#endif</font>
00978 <font class="preprocessor"></font>  };
00979 
00980 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
00981 <font class="preprocessor"></font>  <font class="comment">/* Miscellaneous editing routines */</font>
00982   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_rectl ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> RECTL&amp; rectl )<font class="keyword"></font>
00983 <font class="keyword">  </font>{
00984     printf( <font class="stringliteral">"\t%s\t: (%ld, %ld) - (%ld, %ld)\n"</font>, tag, rectl.left, rectl.top,
00985             rectl.right, rectl.bottom );
00986   }
00987 
00988   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_xform ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> XFORM&amp; xform )<font class="keyword"></font>
00989 <font class="keyword">  </font>{
00990     printf( <font class="stringliteral">"\t%s.eM11\t: %f\n"</font>, tag, xform.eM11 );
00991     printf( <font class="stringliteral">"\t%s.eM12\t: %f\n"</font>, tag, xform.eM12 );
00992     printf( <font class="stringliteral">"\t%s.eM21\t: %f\n"</font>, tag, xform.eM21 );
00993     printf( <font class="stringliteral">"\t%s.eM22\t: %f\n"</font>, tag, xform.eM22 );
00994     printf( <font class="stringliteral">"\t%s.eDx\t: %f\n"</font>, tag, xform.eDx );
00995     printf( <font class="stringliteral">"\t%s.eDy\t: %f\n"</font>, tag, xform.eDy );
00996   }
00997 
00998   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_color ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> COLORREF&amp; color )<font class="keyword"></font>
00999 <font class="keyword">  </font>{
01000     printf( <font class="stringliteral">"\t%s\t: R(0x%02lx) G(0x%02lx) B(0x%02lx)\n"</font>, tag,
01001             GetRValue( color ), GetGValue( color ), GetBValue( color ) );
01002   }
01003 
01004   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_sizel ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> SIZEL&amp; size )<font class="keyword"></font>
01005 <font class="keyword">  </font>{
01006     printf( <font class="stringliteral">"\t%s\t: (%ld, %ld)\n"</font>, tag, size.cx, size.cy );
01007   }
01008 
01009   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_pointl ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> POINTL&amp; point )<font class="keyword"></font>
01010 <font class="keyword">  </font>{
01011     printf( <font class="stringliteral">"\t%s\t: (%ld, %ld)\n"</font>, tag, point.x, point.y );
01012   }
01013 
01014   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_pointlarray ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> DWORD cptl,
01015                                   <font class="keyword">const</font> POINTL* points )<font class="keyword"></font>
01016 <font class="keyword">  </font>{
01017     printf( <font class="stringliteral">"\tcptl%s\t: %ld\n"</font>, tag, cptl );
01018     printf( <font class="stringliteral">"\taptl%s\t: "</font>, tag );
01019     <font class="keywordflow">if</font> ( cptl &gt; 0 )
01020       printf( <font class="stringliteral">"%ld, %ld\n"</font>, points[0].x, points[0].y );
01021     <font class="keywordflow">else</font>
01022       puts( <font class="stringliteral">""</font> );
01023     <font class="keywordflow">for</font> ( DWORD i = 1; i &lt; cptl; i++ )
01024       printf( <font class="stringliteral">"\t\t%s  %ld, %ld\n"</font>, tag, points[i].x, points[i].y );
01025   }
01026 
01027   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_point16array ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, <font class="keyword">const</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> cpts,
01028                                   <font class="keyword">const</font> POINT16* points )<font class="keyword"></font>
01029 <font class="keyword">  </font>{
01030     printf( <font class="stringliteral">"\tcpts%s\t: %d\n"</font>, tag, cpts );
01031     printf( <font class="stringliteral">"\tapts%s\t: "</font>, tag );
01032     <font class="keywordflow">if</font> ( cpts &gt; 0 )
01033       printf( <font class="stringliteral">"%d, %d\n"</font>, points[0].x, points[0].y );
01034     <font class="keywordflow">else</font>
01035       puts( <font class="stringliteral">""</font> );
01036     <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; cpts; i++ )
01037       printf( <font class="stringliteral">"\t\t%s  %d, %d\n"</font>, tag, points[i].x, points[i].y );
01038   }
01039 
01040   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_pen_style ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, DWORD style )<font class="keyword"></font>
01041 <font class="keyword">  </font>{
01042     printf( <font class="stringliteral">"\t%s\t: "</font>, tag );
01043     <font class="keywordflow">switch</font> ( style &amp; PS_STYLE_MASK ) {
01044     <font class="keywordflow">case</font> PS_SOLID: printf( <font class="stringliteral">"PS_SOLID"</font> ); <font class="keywordflow">break</font>;
01045     <font class="keywordflow">case</font> PS_DASH: printf( <font class="stringliteral">"PS_DASH"</font> ); <font class="keywordflow">break</font>;
01046     <font class="keywordflow">case</font> PS_DOT: printf( <font class="stringliteral">"PS_DOT"</font> ); <font class="keywordflow">break</font>;
01047     <font class="keywordflow">case</font> PS_DASHDOT: printf( <font class="stringliteral">"PS_DASHDOT"</font> ); <font class="keywordflow">break</font>;
01048     <font class="keywordflow">case</font> PS_DASHDOTDOT: printf( <font class="stringliteral">"PS_DASHDOTDOT"</font> ); <font class="keywordflow">break</font>;
01049     <font class="keywordflow">case</font> PS_NULL: printf( <font class="stringliteral">"PS_NULL"</font> ); <font class="keywordflow">break</font>;
01050     <font class="keywordflow">case</font> PS_INSIDEFRAME: printf( <font class="stringliteral">"PS_INSIDEFRAME"</font> ); <font class="keywordflow">break</font>;
01051     <font class="keywordflow">case</font> PS_USERSTYLE: printf( <font class="stringliteral">"PS_USERSTYLE"</font> ); <font class="keywordflow">break</font>;
01052     <font class="keywordflow">case</font> PS_ALTERNATE: printf( <font class="stringliteral">"PS_ALTERNATE"</font> ); <font class="keywordflow">break</font>;
01053     }
01054     <font class="keywordflow">switch</font> ( style &amp; PS_ENDCAP_MASK ) {
01055     <font class="keywordflow">case</font> PS_ENDCAP_ROUND: printf( <font class="stringliteral">" | PS_ENDCAP_ROUND"</font> ); <font class="keywordflow">break</font>;
01056     <font class="keywordflow">case</font> PS_ENDCAP_SQUARE: printf( <font class="stringliteral">" | PS_ENDCAP_SQUARE"</font> ); <font class="keywordflow">break</font>;
01057     <font class="keywordflow">case</font> PS_ENDCAP_FLAT: printf( <font class="stringliteral">" | PS_ENDCAP_FLAT"</font> ); <font class="keywordflow">break</font>;
01058     }
01059     <font class="keywordflow">switch</font> ( style &amp; PS_JOIN_MASK ) {
01060     <font class="keywordflow">case</font> PS_JOIN_ROUND: printf( <font class="stringliteral">" | PS_JOIN_ROUND"</font> ); <font class="keywordflow">break</font>;
01061     <font class="keywordflow">case</font> PS_JOIN_BEVEL: printf( <font class="stringliteral">" | PS_JOIN_BEVEL"</font> ); <font class="keywordflow">break</font>;
01062     <font class="keywordflow">case</font> PS_JOIN_MITER: printf( <font class="stringliteral">" | PS_JOIN_MITER"</font> ); <font class="keywordflow">break</font>;
01063     }
01064     <font class="keywordflow">switch</font> ( style &amp; PS_TYPE_MASK ) {
01065     <font class="keywordflow">case</font> PS_COSMETIC: printf( <font class="stringliteral">" | PS_COSMETIC"</font> ); <font class="keywordflow">break</font>;
01066     <font class="keywordflow">case</font> PS_GEOMETRIC: printf( <font class="stringliteral">" | PS_GEOMETRIC"</font> ); <font class="keywordflow">break</font>;
01067     }
01068     printf( <font class="stringliteral">"\n"</font> );
01069   }
01070 
01071   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_brush_style ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, DWORD style )<font class="keyword"></font>
01072 <font class="keyword">  </font>{
01073     printf( <font class="stringliteral">"\t%s\t: "</font>, tag );
01074     <font class="keywordflow">switch</font> ( style ) {
01075     <font class="keywordflow">case</font> BS_SOLID: printf( <font class="stringliteral">"BS_SOLID"</font> ); <font class="keywordflow">break</font>;
01076     <font class="keywordflow">case</font> BS_NULL: printf( <font class="stringliteral">"BS_NULL"</font> ); <font class="keywordflow">break</font>;
01077     <font class="keywordflow">case</font> BS_HATCHED: printf( <font class="stringliteral">"BS_HATCHED"</font> ); <font class="keywordflow">break</font>;
01078     <font class="keywordflow">case</font> BS_PATTERN: printf( <font class="stringliteral">"BS_PATTERN"</font> ); <font class="keywordflow">break</font>;
01079     <font class="keywordflow">case</font> BS_INDEXED: printf( <font class="stringliteral">"BS_INDEXED"</font> ); <font class="keywordflow">break</font>;
01080     <font class="keywordflow">case</font> BS_DIBPATTERN: printf( <font class="stringliteral">"BS_DIBPATTERN"</font> ); <font class="keywordflow">break</font>;
01081     <font class="keywordflow">case</font> BS_DIBPATTERNPT: printf( <font class="stringliteral">"BS_DIBPATTERNPT"</font> ); <font class="keywordflow">break</font>;
01082     <font class="keywordflow">case</font> BS_PATTERN8X8: printf( <font class="stringliteral">"BS_PATTERN8X8"</font> ); <font class="keywordflow">break</font>;
01083     <font class="keywordflow">case</font> BS_DIBPATTERN8X8: printf( <font class="stringliteral">"BS_DIBPATTERN8X8"</font> ); <font class="keywordflow">break</font>;
01084     <font class="keywordflow">case</font> BS_MONOPATTERN: printf( <font class="stringliteral">"BS_DIBPATTERN8X8"</font> ); <font class="keywordflow">break</font>;
01085     <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)"</font>, style );
01086     }
01087     printf( <font class="stringliteral">"\n"</font> );
01088   }
01089 
01090   <font class="keyword">inline</font> <font class="keywordtype">void</font> edit_brush_hatch ( <font class="keyword">const</font> <font class="keywordtype">char</font>* tag, DWORD hatch )<font class="keyword"></font>
01091 <font class="keyword">  </font>{
01092     printf( <font class="stringliteral">"\t%s\t: "</font>, tag );
01093     <font class="keywordflow">switch</font> ( hatch ) {
01094     <font class="keywordflow">case</font> HS_HORIZONTAL: printf( <font class="stringliteral">"HS_HORIZONTAL"</font> ); <font class="keywordflow">break</font>;
01095     <font class="keywordflow">case</font> HS_VERTICAL: printf( <font class="stringliteral">"HS_VERTICAL"</font> ); <font class="keywordflow">break</font>;
01096     <font class="keywordflow">case</font> HS_FDIAGONAL: printf( <font class="stringliteral">"HS_FDIAGONAL"</font> ); <font class="keywordflow">break</font>;
01097     <font class="keywordflow">case</font> HS_BDIAGONAL: printf( <font class="stringliteral">"HS_BDIAGONAL"</font> ); <font class="keywordflow">break</font>;
01098     <font class="keywordflow">case</font> HS_CROSS: printf( <font class="stringliteral">"HS_CROSS"</font> ); <font class="keywordflow">break</font>;
01099     <font class="keywordflow">case</font> HS_DIAGCROSS: printf( <font class="stringliteral">"HS_DIAGCROSS"</font> ); <font class="keywordflow">break</font>;
01100     <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)"</font>, hatch );
01101     }
01102     printf( <font class="stringliteral">"\n"</font> );
01103   }
01104 <font class="preprocessor">#endif</font>
01105 <font class="preprocessor"></font>
01112   <font class="keyword">enum</font> OBJECTTYPE { O_METAFILEDEVICECONTEXT     = OBJ_METADC,
01113                     O_FONT                      = OBJ_FONT,
01114                     O_PEN                       = OBJ_PEN,
01115                     O_EXTPEN                    = OBJ_EXTPEN,
01116                     O_BRUSH                     = OBJ_BRUSH,
01117                     O_PALETTE                   = OBJ_PAL };
01118 <font class="preprocessor">#if 0</font>
01119 <font class="preprocessor"></font>
01122   <font class="keyword">static</font> <font class="keywordtype">char</font>* typStr ( OBJECTTYPE type )<font class="keyword"></font>
01123 <font class="keyword">  </font>{
01124     <font class="keywordflow">switch</font> (type) {
01125     <font class="keywordflow">case</font> O_METAFILEDEVICECONTEXT:
01126       <font class="keywordflow">return</font> <font class="stringliteral">"metafile device context"</font>;
01127     <font class="keywordflow">case</font> O_FONT:
01128       <font class="keywordflow">return</font> <font class="stringliteral">"font"</font>;
01129     <font class="keywordflow">case</font> O_PEN:
01130       <font class="keywordflow">return</font> <font class="stringliteral">"pen"</font>;
01131     <font class="keywordflow">case</font> O_EXTPEN:
01132       <font class="keywordflow">return</font> <font class="stringliteral">"extended pen"</font>;
01133     <font class="keywordflow">case</font> O_BRUSH:
01134       <font class="keywordflow">return</font> <font class="stringliteral">"brush"</font>;
01135     <font class="keywordflow">case</font> O_PALETTE:
01136       <font class="keywordflow">return</font> <font class="stringliteral">"palette"</font>;
01137     }
01138     <font class="keywordflow">return</font> <font class="stringliteral">"unknown object"</font>;
01139   }
01140 <font class="preprocessor">#endif</font>
01141 <font class="preprocessor"></font>
01142 
<a name="l01147"></a><a class="code" href="classEMF_1_1OBJECT.html">01147</a>   <font class="keyword">class </font>OBJECT {
01148   <font class="keyword">public</font>:
<a name="l01149"></a><a class="code" href="classEMF_1_1OBJECT.html#m0">01149</a>     HGDIOBJ handle;             
01150 
<a name="l01151"></a><a class="code" href="classEMF_1_1OBJECT.html#a0">01151</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1OBJECT.html#a0">~OBJECT</a> ()<font class="keyword"> </font>{}
<a name="l01156"></a><a class="code" href="classEMF_1_1OBJECT.html#a1">01156</a>     <a class="code" href="classEMF_1_1OBJECT.html#a1">OBJECT</a> ( <font class="keywordtype">void</font> ) : handle( 0 ) {}
01160     <font class="keyword">virtual</font> OBJECTTYPE <a class="code" href="classEMF_1_1OBJECT.html#a2">getType</a> ( <font class="keywordtype">void</font> ) <font class="keyword">const</font> = 0;
01161   };
01162 
01164 
<a name="l01169"></a><a class="code" href="classEMF_1_1GRAPHICSOBJECT.html">01169</a>   <font class="keyword">class </font>GRAPHICSOBJECT : <font class="keyword">public</font> OBJECT {
01170   <font class="keyword">public</font>:
<a name="l01172"></a><a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#a0">01172</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#a0">~GRAPHICSOBJECT</a> ()<font class="keyword"> </font>{}
<a name="l01177"></a><a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#m0">01177</a>     std::map&lt; HDC, HGDIOBJ &gt; contexts;
01183     <font class="keyword">virtual</font> METARECORD* <a class="code" href="classEMF_1_1GRAPHICSOBJECT.html#a1">newEMR</a> ( HDC dc, HGDIOBJ handle ) = 0;
01184   };
01185 
01186   <font class="keyword">typedef</font> METARECORD*(*METARECORDCTOR)(DATASTREAM&amp;);
01187 
01188   <font class="keyword">class </font>GLOBALOBJECTS {
01192     std::vector&lt;OBJECT*&gt; objects;
01193 
01200     std::map&lt; DWORD, METARECORDCTOR &gt; new_records;
01201 
01202   <font class="keyword">public</font>:
01203     GLOBALOBJECTS ( <font class="keywordtype">void</font> );
01204     ~GLOBALOBJECTS ( <font class="keywordtype">void</font> );
01205     HGDIOBJ add ( OBJECT* object );
01206     OBJECT* find ( <font class="keyword">const</font> HGDIOBJ handle );
01207     <font class="keywordtype">void</font> remove ( <font class="keyword">const</font> OBJECT* object );
01208 
01209     std::vector&lt;EMF::OBJECT*&gt;::const_iterator begin ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01210 <font class="keyword">    </font>{ <font class="keywordflow">return</font> objects.begin(); }
01211     std::vector&lt;EMF::OBJECT*&gt;::const_iterator end ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01212 <font class="keyword">    </font>{ <font class="keywordflow">return</font> objects.end(); }
01213 
01214     METARECORDCTOR newRecord ( DWORD iType ) <font class="keyword">const</font>;
01215 
01216     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_eof ( DATASTREAM&amp; ds );
01217     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setviewportorgex ( DATASTREAM&amp; ds );
01218     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setwindoworgex ( DATASTREAM&amp; ds );
01219     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setviewportextex ( DATASTREAM&amp; ds );
01220     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setwindowextex ( DATASTREAM&amp; ds );
01221     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_scaleviewportextex ( DATASTREAM&amp; ds );
01222     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_scalewindowextex ( DATASTREAM&amp; ds );
01223     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_modifyworldtransform ( DATASTREAM&amp; ds );
01224     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setworldtransform ( DATASTREAM&amp; ds );
01225     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_settextalign ( DATASTREAM&amp; ds );
01226     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_settextcolor ( DATASTREAM&amp; ds );
01227     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setbkcolor ( DATASTREAM&amp; ds );
01228     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setbkmode ( DATASTREAM&amp; ds );
01229     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setpolyfillmode ( DATASTREAM&amp; ds );
01230     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setmapmode ( DATASTREAM&amp; ds );
01231     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_selectobject ( DATASTREAM&amp; ds );
01232     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_deleteobject ( DATASTREAM&amp; ds );
01233     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_movetoex ( DATASTREAM&amp; ds );
01234     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_lineto ( DATASTREAM&amp; ds );
01235     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_arc ( DATASTREAM&amp; ds );
01236     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_arcto ( DATASTREAM&amp; ds );
01237     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_rectangle ( DATASTREAM&amp; ds );
01238     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_ellipse ( DATASTREAM&amp; ds );
01239     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polyline ( DATASTREAM&amp; ds );
01240     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polyline16 ( DATASTREAM&amp; ds );
01241     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polygon ( DATASTREAM&amp; ds );
01242     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polygon16 ( DATASTREAM&amp; ds );
01243     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polypolygon ( DATASTREAM&amp; ds );
01244     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polypolygon16 ( DATASTREAM&amp; ds );
01245     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezier ( DATASTREAM&amp; ds );
01246     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezier16 ( DATASTREAM&amp; ds );
01247     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezierto ( DATASTREAM&amp; ds );
01248     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polybezierto16 ( DATASTREAM&amp; ds );
01249     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polylineto ( DATASTREAM&amp; ds );
01250     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_polylineto16 ( DATASTREAM&amp; ds );
01251     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_exttextouta ( DATASTREAM&amp; ds );
01252     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setpixelv ( DATASTREAM&amp; ds );
01253     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_createpen ( DATASTREAM&amp; ds );
01254     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_extcreatepen ( DATASTREAM&amp; ds );
01255     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_createbrushindirect ( DATASTREAM&amp; ds );
01256     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_extcreatefontindirectw ( DATASTREAM&amp; ds );
01257     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_fillpath ( DATASTREAM&amp; ds );
01258     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_strokepath ( DATASTREAM&amp; ds );
01259     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_strokeandfillpath ( DATASTREAM&amp; ds );
01260     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_beginpath ( DATASTREAM&amp; ds );
01261     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_endpath ( DATASTREAM&amp; ds );
01262     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_closefigure ( DATASTREAM&amp; ds );
01263     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_savedc ( DATASTREAM&amp; ds );
01264     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_restoredc ( DATASTREAM&amp; ds );
01265     <font class="keyword">static</font> <a class="code" href="classEMF_1_1METARECORD.html">EMF::METARECORD</a>* new_setmetargn ( DATASTREAM&amp; ds );
01266   };
01267 
01268   <font class="keyword">extern</font> GLOBALOBJECTS globalObjects;
01269 
01271 
<a name="l01277"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html">01277</a>   <font class="keyword">class </font>ENHMETAHEADER : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::ENHMETAHEADER {
01278 
01279     LPWSTR description_w;
01280     <font class="keywordtype">int</font> description_size;
01281 
01282   <font class="keyword">public</font>:
<a name="l01289"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a0">01289</a>     <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a0">ENHMETAHEADER</a> ( LPCWSTR description = 0 )
01290       : description_w( 0 ), description_size( 0 )
01291     {
01292       iType = EMR_HEADER;
01293       nSize = <font class="keyword">sizeof</font>( ::ENHMETAHEADER );
01294 
01295       <font class="comment">// Compute the bounds</font>
01296       RECTL default_bounds = { 0, 0, 0, 0 };
01297       rclBounds = default_bounds;
01298       RECTL default_frame = { 0, 0, 0, 0 };
01299       rclFrame = default_frame;
01300       dSignature = ENHMETA_SIGNATURE;
01301       nVersion = 0x10000;
01302       nBytes = nSize;
01303       nRecords = 1;
01304       nHandles = 0;
01305       sReserved = 0;
01306       nDescription = 0;
01307       offDescription = 0;
01308       nPalEntries = 0;
01309       szlDevice.cx = XMAX_PIXELS;
01310       szlDevice.cy = YMAX_PIXELS;
01311       szlMillimeters.cx = XMAX_MM;
01312       szlMillimeters.cy = YMAX_MM;
01313       <font class="comment">//</font>
01314       cbPixelFormat = 0;
01315       offPixelFormat = 0;
01316       bOpenGL = FALSE;
01317       <font class="comment">//</font>
01318 <font class="preprocessor">#if 1</font>
01319 <font class="preprocessor"></font>      szlMicrometers.cx = 1000 * szlMillimeters.cx;
01320       szlMicrometers.cy = 1000 * szlMillimeters.cy;
01321 <font class="preprocessor">#endif</font>
01322 <font class="preprocessor"></font>      <font class="keywordflow">if</font> ( description ) {
01323         <font class="comment">// Count the number of characters in the description</font>
01324         <font class="keywordtype">int</font> description_count = 0, nulls = 0;
01325         LPCWSTR description_p = description;
01326         <font class="keywordflow">while</font> ( nulls &lt; 3 ) {
01327           description_count++;
01328           <font class="keywordflow">if</font> ( (*description_p++) == 0 ) nulls++;
01329         }
01330 
01331         <font class="comment">// Make sure that the TOTAL record length will be a multiple of 4</font>
01332 
01333         <font class="keywordtype">int</font> record_size = ROUND_TO_LONG( <font class="keyword">sizeof</font>( ::ENHMETAHEADER ) +
01334                                          <font class="keyword">sizeof</font>( WCHAR ) * description_count );
01335         description_size =
01336           (record_size - <font class="keyword">sizeof</font>( ::ENHMETAHEADER )) / <font class="keyword">sizeof</font>( WCHAR );
01337 
01338         description_w = <font class="keyword">new</font> WCHAR[ description_size ];
01339 
01340         memset( description_w, 0, <font class="keyword">sizeof</font>(WCHAR) * description_size );
01341 
01342         <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i=0; i&lt;description_count; i++ )
01343           description_w[i] = *description++;
01344 
01345         nSize = nBytes = record_size;
01346         nDescription = description_count;
01347         offDescription = <font class="keyword">sizeof</font>( ::ENHMETAHEADER );
01348       }
01349     }
01350     
<a name="l01354"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a1">01354</a>     <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a1">~ENHMETAHEADER</a> ( )<font class="keyword"></font>
01355 <font class="keyword">    </font>{
01356       <font class="keywordflow">if</font> ( description_w ) <font class="keyword">delete</font>[] description_w;
01357     }
<a name="l01362"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a2">01362</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01363 <font class="keyword">    </font>{
01364       ds &lt;&lt; iType &lt;&lt; nSize
01365          &lt;&lt; rclBounds &lt;&lt; rclFrame
01366          &lt;&lt; dSignature &lt;&lt; nVersion &lt;&lt; nBytes &lt;&lt; nRecords &lt;&lt; nHandles &lt;&lt; sReserved
01367          &lt;&lt; nDescription &lt;&lt; offDescription &lt;&lt; nPalEntries
01368          &lt;&lt; szlDevice &lt;&lt; szlMillimeters
01369          &lt;&lt; cbPixelFormat &lt;&lt; offPixelFormat &lt;&lt; bOpenGL
01370 <font class="preprocessor">#if 1</font>
01371 <font class="preprocessor"></font>         &lt;&lt; szlMicrometers
01372 <font class="preprocessor">#endif</font>
01373 <font class="preprocessor"></font>         &lt;&lt; WCHARSTR( description_w, description_size );
01374       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01375     }
<a name="l01379"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a3">01379</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a3">unserialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01380 <font class="keyword">    </font>{
01381       ds &gt;&gt; iType &gt;&gt; nSize
01382          &gt;&gt; rclBounds &gt;&gt; rclFrame
01383          &gt;&gt; dSignature &gt;&gt; nVersion &gt;&gt; nBytes &gt;&gt; nRecords &gt;&gt; nHandles &gt;&gt; sReserved
01384          &gt;&gt; nDescription &gt;&gt; offDescription &gt;&gt; nPalEntries
01385          &gt;&gt; szlDevice &gt;&gt; szlMillimeters;
01386 
01387       <font class="comment">// Some elements of the metafile header were added at later dates</font>
01388 
01389 <font class="preprocessor">#define OffsetOf( a, b ) ((unsigned int)(((char*)&amp;(((::ENHMETAHEADER*)a)-&gt;b)) - \</font>
01390 <font class="preprocessor">(char*)((::ENHMETAHEADER*)a)))</font>
01391 <font class="preprocessor"></font><font class="preprocessor">#if 1</font>
01392 <font class="preprocessor"></font>      <font class="keywordflow">if</font> ( OffsetOf( <font class="keyword">this</font>, szlMicrometers ) &lt;= offDescription )
01393         ds &gt;&gt; cbPixelFormat &gt;&gt; offPixelFormat &gt;&gt; bOpenGL;
01394 <font class="preprocessor">#else</font>
01395 <font class="preprocessor"></font>      <font class="keywordflow">if</font> ( <font class="keyword">sizeof</font>(::ENHMETAHEADER) &lt;= offDescription )
01396         ds &gt;&gt; cbPixelFormat &gt;&gt; offPixelFormat &gt;&gt; bOpenGL;
01397 <font class="preprocessor">#endif</font>
01398 <font class="preprocessor"></font><font class="preprocessor">#undef OffsetOf</font>
01399 <font class="preprocessor"></font><font class="preprocessor">#if 1</font>
01400 <font class="preprocessor"></font>      <font class="keywordflow">if</font> ( <font class="keyword">sizeof</font>(::ENHMETAHEADER) &lt;= offDescription )
01401         ds &gt;&gt; szlMicrometers;
01402 <font class="preprocessor">#endif</font>
01403 <font class="preprocessor"></font>      <font class="comment">// Should now probably check that the offset is correct...</font>
01404 
01405       description_size = ( nSize - offDescription ) / <font class="keyword">sizeof</font>(WCHAR);
01406       description_w = <font class="keyword">new</font> WCHAR[ description_size ];
01407 
01408       WCHARSTR description( description_w, description_size );
01409 
01410       ds &gt;&gt; description;
01411 
01412       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01413     }
<a name="l01417"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a4">01417</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> nSize; }
<a name="l01423"></a><a class="code" href="classEMF_1_1ENHMETAHEADER.html#a5">01423</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1ENHMETAHEADER.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC <font class="comment">/*dc*/</font> )<font class="keyword"> const</font>
01424 <font class="keyword">    </font>{
01425       <font class="comment">// Actually handled by the destination device context.</font>
01426     }
01427 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01428 <font class="preprocessor"></font>
01431     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01432 <font class="keyword">    </font>{
01433       printf( <font class="stringliteral">"*HEADER*\n"</font> );
01434       printf( <font class="stringliteral">"\tiType\t\t\t: %ld\n"</font>, iType );
01435       printf( <font class="stringliteral">"\tnSize\t\t\t: %ld\n"</font>, nSize );
01436       edit_rectl( <font class="stringliteral">"rclBounds\t"</font>, rclBounds );
01437       edit_rectl( <font class="stringliteral">"rclFrame\t"</font>, rclFrame );
01438       printf( <font class="stringliteral">"\tdSignature\t\t: %.4s\n"</font>, (<font class="keyword">const</font> <font class="keywordtype">char</font>*)&amp;dSignature );
01439       printf( <font class="stringliteral">"\tnVersion\t\t: 0x%x\n"</font>, (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>)nVersion );
01440       printf( <font class="stringliteral">"\tnBytes\t\t\t: %ld\n"</font>, nBytes );
01441       printf( <font class="stringliteral">"\tnRecords\t\t: %ld\n"</font>, nRecords );
01442       printf( <font class="stringliteral">"\tnHandles\t\t: %d\n"</font>, nHandles );
01443       printf( <font class="stringliteral">"\tnDescription\t\t: %ld\n"</font>, nDescription );
01444       printf( <font class="stringliteral">"\toffDescription\t\t: %ld\n"</font>, offDescription );
01445       printf( <font class="stringliteral">"\tnPalEntries\t\t: %ld\n"</font>, nPalEntries );
01446       edit_sizel( <font class="stringliteral">"szlDevice\t"</font>, szlDevice );
01447       edit_sizel( <font class="stringliteral">"szlMillimeters\t"</font>, szlMillimeters );
01448 
01449       <font class="comment">/* Make a crude guess as to the age of this file */</font>
01450 <font class="preprocessor">#define OffsetOf( a, b ) ((unsigned int)(((const char*)&amp;(((const ::ENHMETAHEADER*)a)-&gt;b)) - \</font>
01451 <font class="preprocessor">(const char*)((const ::ENHMETAHEADER*)a)))</font>
01452 <font class="preprocessor"></font>
01453       <font class="keywordflow">if</font> ( OffsetOf( <font class="keyword">this</font>, cbPixelFormat ) &lt;= offDescription ) {
01454         printf( <font class="stringliteral">"\tcbPixelFormat\t\t: %ld\n"</font>, cbPixelFormat );
01455         printf( <font class="stringliteral">"\toffPixelFormat\t\t: %ld\n"</font>, offPixelFormat );
01456         printf( <font class="stringliteral">"\tbOpenGL\t\t\t: %ld\n"</font>, bOpenGL );
01457 <font class="preprocessor">#if 1</font>
01458 <font class="preprocessor"></font>        <font class="keywordflow">if</font> ( <font class="keyword">sizeof</font>(::ENHMETAHEADER) &lt;= offDescription ) {
01459           edit_sizel( <font class="stringliteral">"szlMicrometers\t"</font>, szlMicrometers );
01460         }
01461 <font class="preprocessor">#endif</font>
01462 <font class="preprocessor"></font>      }
01463 
01464 <font class="preprocessor">#undef OffsetOf</font>
01465 <font class="preprocessor"></font>
01466       <font class="keywordflow">if</font> ( nDescription != 0 ) {
01467 
01468         <font class="keywordtype">wchar_t</font> last_w = 0;
01469         WCHAR* description = description_w;
01470 
01471         printf( <font class="stringliteral">"\tDescription:"</font> );
01472 
01473         <font class="keywordflow">for</font> ( DWORD i = 0; i &lt; nDescription; i++ ) {
01474 
01475           <font class="keywordtype">wchar_t</font> w = *description++; <font class="comment">/* This is not true, really. UNICODE is not</font>
01476 <font class="comment">                                       * glibc's wide character representation */</font>
01477 
01478           <font class="keywordflow">if</font> ( w != 0 ) {
01479             <font class="keywordflow">if</font> ( last_w == 0 ) printf( <font class="stringliteral">"\n\t\t"</font> );
01480             putchar( w );
01481           }
01482           
01483           last_w = w;
01484         }
01485         printf( <font class="stringliteral">"\n"</font> );
01486       }
01487     }
01488 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01489   };
01490 
01492 
<a name="l01497"></a><a class="code" href="classEMF_1_1EMREOF.html">01497</a>   <font class="keyword">class </font>EMREOF : <font class="keyword">public</font> METARECORD, ::EMREOF {
01498   <font class="keyword">public</font>:
<a name="l01502"></a><a class="code" href="classEMF_1_1EMREOF.html#a0">01502</a>     <a class="code" href="classEMF_1_1EMREOF.html#a0">EMREOF</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
01503 <font class="keyword">    </font>{
01504       emr.iType = EMR_EOF;
01505       emr.nSize = <font class="keyword">sizeof</font>( ::EMREOF );
01506       nPalEntries = 0;
01507       offPalEntries = 0;
01508       nSizeLast = 0;
01509     }
01510 
<a name="l01515"></a><a class="code" href="classEMF_1_1EMREOF.html#a1">01515</a>     <a class="code" href="classEMF_1_1EMREOF.html#a0">EMREOF</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01516 <font class="keyword">    </font>{
01517       ds &gt;&gt; emr &gt;&gt; nPalEntries &gt;&gt; offPalEntries &gt;&gt; nSizeLast;
01518     }
01519 
<a name="l01523"></a><a class="code" href="classEMF_1_1EMREOF.html#a2">01523</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREOF.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01524 <font class="keyword">    </font>{
01525       ds &lt;&lt; emr &lt;&lt; nPalEntries &lt;&lt; offPalEntries &lt;&lt; nSizeLast;
01526       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01527     }
<a name="l01531"></a><a class="code" href="classEMF_1_1EMREOF.html#a3">01531</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREOF.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01537"></a><a class="code" href="classEMF_1_1EMREOF.html#a4">01537</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREOF.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC <font class="comment">/*dc*/</font> )<font class="keyword"> const</font>
01538 <font class="keyword">    </font>{
01539       <font class="comment">// Actually handled by the destination device context.</font>
01540     }
01541 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01542 <font class="preprocessor"></font>
01545     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01546 <font class="keyword">    </font>{
01547       printf( <font class="stringliteral">"*EOF*\n"</font> );
01548     }
01549 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01550   };
01551 
01553 
<a name="l01558"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html">01558</a>   <font class="keyword">class </font>EMRSETVIEWPORTORGEX : <font class="keyword">public</font> METARECORD, ::EMRSETVIEWPORTORGEX {
01559   <font class="keyword">public</font>:
<a name="l01564"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a0">01564</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a0">EMRSETVIEWPORTORGEX</a> ( INT x, INT y )<font class="keyword"></font>
01565 <font class="keyword">    </font>{
01566       emr.iType = EMR_SETVIEWPORTORGEX;
01567       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETVIEWPORTORGEX );
01568       ptlOrigin.x = x;
01569       ptlOrigin.y = y;
01570     }
<a name="l01575"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a1">01575</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a0">EMRSETVIEWPORTORGEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01576 <font class="keyword">    </font>{
01577       ds &gt;&gt; emr &gt;&gt; ptlOrigin;
01578     }
<a name="l01582"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a2">01582</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01583 <font class="keyword">    </font>{
01584       ds &lt;&lt; emr &lt;&lt; ptlOrigin;
01585       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01586     }
<a name="l01590"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a3">01590</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01596"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a4">01596</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTORGEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01597 <font class="keyword">    </font>{
01598       SetViewportOrgEx( dc, ptlOrigin.x, ptlOrigin.y, 0 );
01599     }
01600 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01601 <font class="preprocessor"></font>
01604     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01605 <font class="keyword">    </font>{
01606       printf( <font class="stringliteral">"*SETVIEWPORTORGEX*\n"</font> );
01607       edit_pointl( <font class="stringliteral">"ptlOrigin"</font>, ptlOrigin );
01608     }
01609 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01610   };
01611 
01613 
<a name="l01620"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html">01620</a>   <font class="keyword">class </font>EMRSETWINDOWORGEX : <font class="keyword">public</font> METARECORD, ::EMRSETWINDOWORGEX {
01621   <font class="keyword">public</font>:
<a name="l01626"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a0">01626</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a0">EMRSETWINDOWORGEX</a> ( INT x, INT y )<font class="keyword"></font>
01627 <font class="keyword">    </font>{
01628       emr.iType = EMR_SETWINDOWORGEX;
01629       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETWINDOWORGEX );
01630       ptlOrigin.x = x;
01631       ptlOrigin.y = y;
01632     }
<a name="l01637"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a1">01637</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a0">EMRSETWINDOWORGEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01638 <font class="keyword">    </font>{
01639       ds &gt;&gt; emr &gt;&gt; ptlOrigin;
01640     }
<a name="l01644"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a2">01644</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01645 <font class="keyword">    </font>{
01646       ds &lt;&lt; emr &lt;&lt; ptlOrigin;
01647       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01648     }
<a name="l01652"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a3">01652</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01658"></a><a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a4">01658</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETWINDOWORGEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01659 <font class="keyword">    </font>{
01660       SetWindowOrgEx( dc, ptlOrigin.x, ptlOrigin.y, 0 );
01661     }
01662 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01663 <font class="preprocessor"></font>
01666     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01667 <font class="keyword">    </font>{
01668       printf( <font class="stringliteral">"*SETWINDOWORGEX*\n"</font> );
01669       edit_pointl( <font class="stringliteral">"ptlOrigin"</font>, ptlOrigin );
01670     }
01671 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01672   };
01673 
01675 
<a name="l01680"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html">01680</a>   <font class="keyword">class </font>EMRSETVIEWPORTEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSETVIEWPORTEXTEX {
01681   <font class="keyword">public</font>:
<a name="l01686"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a0">01686</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a0">EMRSETVIEWPORTEXTEX</a> ( INT cx, INT cy )<font class="keyword"></font>
01687 <font class="keyword">    </font>{
01688       emr.iType = EMR_SETVIEWPORTEXTEX;
01689       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETVIEWPORTEXTEX );
01690       szlExtent.cx = cx;
01691       szlExtent.cy = cy;
01692     }
<a name="l01697"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a1">01697</a>     <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a0">EMRSETVIEWPORTEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01698 <font class="keyword">    </font>{
01699       ds &gt;&gt; emr &gt;&gt; szlExtent;
01700     }
<a name="l01704"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a2">01704</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01705 <font class="keyword">    </font>{
01706       ds &lt;&lt; emr &lt;&lt; szlExtent;
01707       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01708     }
<a name="l01712"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a3">01712</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01718"></a><a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a4">01718</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETVIEWPORTEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01719 <font class="keyword">    </font>{
01720       SetViewportExtEx( dc, szlExtent.cx, szlExtent.cy, 0 );
01721     }
01722 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01723 <font class="preprocessor"></font>
01726     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01727 <font class="keyword">    </font>{
01728       printf( <font class="stringliteral">"*SETVIEWPORTEXTEX*\n"</font> );
01729       edit_sizel( <font class="stringliteral">"szlExtent"</font>, szlExtent );
01730     }
01731 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01732   };
01733 
01735 
<a name="l01740"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html">01740</a>   <font class="keyword">class </font>EMRSCALEVIEWPORTEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSCALEVIEWPORTEXTEX {
01741   <font class="keyword">public</font>:
<a name="l01748"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a0">01748</a>     <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a0">EMRSCALEVIEWPORTEXTEX</a> ( LONG x_num, LONG x_den, LONG y_num, LONG y_den )<font class="keyword"></font>
01749 <font class="keyword">    </font>{
01750       emr.iType = EMR_SCALEVIEWPORTEXTEX;
01751       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSCALEVIEWPORTEXTEX );
01752       xNum = x_num;
01753       xDenom = x_den;
01754       yNum = y_num;
01755       yDenom = y_den;
01756     }
<a name="l01761"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a1">01761</a>     <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a0">EMRSCALEVIEWPORTEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01762 <font class="keyword">    </font>{
01763       ds &gt;&gt; emr &gt;&gt; xNum &gt;&gt; xDenom &gt;&gt; yNum &gt;&gt; yDenom;
01764     }
<a name="l01768"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a2">01768</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01769 <font class="keyword">    </font>{
01770       ds &lt;&lt; emr &lt;&lt; xNum &lt;&lt; xDenom &lt;&lt; yNum &lt;&lt; yDenom;
01771       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01772     }
<a name="l01776"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a3">01776</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01782"></a><a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a4">01782</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSCALEVIEWPORTEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01783 <font class="keyword">    </font>{
01784       ScaleViewportExtEx( dc, xNum, xDenom, yNum, yDenom, 0 );
01785     }
01786 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01787 <font class="preprocessor"></font>
01790     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01791 <font class="keyword">    </font>{
01792       printf( <font class="stringliteral">"*SCALEVIEWPORTEXTEX*\n"</font> );
01793       printf( <font class="stringliteral">"\txNum\t: %ld\n"</font>, xNum );
01794       printf( <font class="stringliteral">"\txDenom\t: %ld\n"</font>, xDenom );
01795       printf( <font class="stringliteral">"\tyNum\t: %ld\n"</font>, yNum );
01796       printf( <font class="stringliteral">"\tyDenom\t: %ld\n"</font>, yDenom );
01797     }
01798 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01799   };
01800 
01802 
<a name="l01807"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html">01807</a>   <font class="keyword">class </font>EMRSETWINDOWEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSETWINDOWEXTEX {
01808   <font class="keyword">public</font>:
<a name="l01813"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a0">01813</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a0">EMRSETWINDOWEXTEX</a> ( INT cx, INT cy )<font class="keyword"></font>
01814 <font class="keyword">    </font>{
01815       emr.iType = EMR_SETWINDOWEXTEX;
01816       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETWINDOWEXTEX );
01817       szlExtent.cx = cx;
01818       szlExtent.cy = cy;
01819     }
<a name="l01824"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a1">01824</a>     <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a0">EMRSETWINDOWEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01825 <font class="keyword">    </font>{
01826       ds &gt;&gt; emr &gt;&gt; szlExtent;
01827     }
<a name="l01831"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a2">01831</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01832 <font class="keyword">    </font>{
01833       ds &lt;&lt; emr &lt;&lt; szlExtent;
01834       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01835     }
<a name="l01839"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a3">01839</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01845"></a><a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a4">01845</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETWINDOWEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01846 <font class="keyword">    </font>{
01847       SetWindowExtEx( dc, szlExtent.cx, szlExtent.cy, 0 );
01848     }
01849 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01850 <font class="preprocessor"></font>
01853     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01854 <font class="keyword">    </font>{
01855       printf( <font class="stringliteral">"*SETWINDOWEXTEX*\n"</font> );
01856       edit_sizel( <font class="stringliteral">"szlExtent"</font>, szlExtent );
01857     }
01858 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01859   };
01860 
01862 
<a name="l01867"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html">01867</a>   <font class="keyword">class </font>EMRSCALEWINDOWEXTEX : <font class="keyword">public</font> METARECORD, ::EMRSCALEWINDOWEXTEX {
01868   <font class="keyword">public</font>:
<a name="l01875"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a0">01875</a>     <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a0">EMRSCALEWINDOWEXTEX</a> ( LONG x_num, LONG x_den, LONG y_num, LONG y_den )<font class="keyword"></font>
01876 <font class="keyword">    </font>{
01877       emr.iType = EMR_SCALEWINDOWEXTEX;
01878       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSCALEWINDOWEXTEX );
01879       xNum = x_num;
01880       xDenom = x_den;
01881       yNum = y_num;
01882       yDenom = y_den;
01883     }
<a name="l01888"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a1">01888</a>     <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a0">EMRSCALEWINDOWEXTEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01889 <font class="keyword">    </font>{
01890       ds &gt;&gt; emr &gt;&gt; xNum &gt;&gt; xDenom &gt;&gt; yNum &gt;&gt; yDenom;
01891     }
<a name="l01895"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a2">01895</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01896 <font class="keyword">    </font>{
01897       ds &lt;&lt; emr &lt;&lt; xNum &lt;&lt; xDenom &lt;&lt; yNum &lt;&lt; yDenom;
01898       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01899     }
<a name="l01903"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a3">01903</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01909"></a><a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a4">01909</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSCALEWINDOWEXTEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01910 <font class="keyword">    </font>{
01911       ScaleWindowExtEx( dc, xNum, xDenom, yNum, yDenom, 0 );
01912     }
01913 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01914 <font class="preprocessor"></font>
01917     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01918 <font class="keyword">    </font>{
01919       printf( <font class="stringliteral">"*SCALEWINDOWEXTEX*\n"</font> );
01920       printf( <font class="stringliteral">"\txNum\t: %ld\n"</font>, xNum );
01921       printf( <font class="stringliteral">"\txDenom\t: %ld\n"</font>, xDenom );
01922       printf( <font class="stringliteral">"\tyNum\t: %ld\n"</font>, yNum );
01923       printf( <font class="stringliteral">"\tyDenom\t: %ld\n"</font>, yDenom );
01924     }
01925 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01926   };
01927 
01929 
<a name="l01935"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html">01935</a>   <font class="keyword">class </font>EMRMODIFYWORLDTRANSFORM : <font class="keyword">public</font> METARECORD, ::EMRMODIFYWORLDTRANSFORM {
01936   <font class="keyword">public</font>:
<a name="l01942"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a0">01942</a>     <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a0">EMRMODIFYWORLDTRANSFORM</a> ( <font class="keyword">const</font> XFORM* transform, DWORD mode )<font class="keyword"></font>
01943 <font class="keyword">    </font>{
01944       emr.iType = EMR_MODIFYWORLDTRANSFORM;
01945       emr.nSize = <font class="keyword">sizeof</font>( ::EMRMODIFYWORLDTRANSFORM );
01946       xform = *transform;
01947       iMode = mode;
01948     }
<a name="l01953"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a1">01953</a>     <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a0">EMRMODIFYWORLDTRANSFORM</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
01954 <font class="keyword">    </font>{
01955       ds &gt;&gt; emr &gt;&gt; xform &gt;&gt; iMode;
01956     }
<a name="l01960"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a2">01960</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
01961 <font class="keyword">    </font>{
01962       ds &lt;&lt; emr &lt;&lt; xform &lt;&lt; iMode;
01963       <font class="keywordflow">return</font> <font class="keyword">true</font>;
01964     }
<a name="l01968"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a3">01968</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l01974"></a><a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a4">01974</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRMODIFYWORLDTRANSFORM.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
01975 <font class="keyword">    </font>{
01976       ModifyWorldTransform( dc, &amp;xform, iMode );
01977     }
01978 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
01979 <font class="preprocessor"></font>
01982     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
01983 <font class="keyword">    </font>{
01984       printf( <font class="stringliteral">"*MODIFYWORLDTRANSFORM*\n"</font> );
01985       edit_xform( <font class="stringliteral">"xform"</font>, xform );
01986       printf( <font class="stringliteral">"\tiMode\t\t: "</font> );
01987       <font class="keywordflow">switch</font> ( iMode ) {
01988       <font class="keywordflow">case</font> MWT_IDENTITY: printf( <font class="stringliteral">"MWT_IDENTITY\n"</font> ); <font class="keywordflow">break</font>;
01989       <font class="keywordflow">case</font> MWT_LEFTMULTIPLY: printf( <font class="stringliteral">"MWT_LEFTMULTIPLY\n"</font> ); <font class="keywordflow">break</font>;
01990       <font class="keywordflow">case</font> MWT_RIGHTMULTIPLY: printf( <font class="stringliteral">"MWT_RIGHTMULTIPLY\n"</font> ); <font class="keywordflow">break</font>;
01991       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
01992       }
01993     }
01994 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
01995   };
01996 
01998 
<a name="l02004"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html">02004</a>   <font class="keyword">class </font>EMRSETWORLDTRANSFORM : <font class="keyword">public</font> METARECORD, ::EMRSETWORLDTRANSFORM {
02005   <font class="keyword">public</font>:
<a name="l02009"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a0">02009</a>     <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a0">EMRSETWORLDTRANSFORM</a> ( <font class="keyword">const</font> XFORM* transform )<font class="keyword"></font>
02010 <font class="keyword">    </font>{
02011       emr.iType = EMR_SETWORLDTRANSFORM;
02012       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETWORLDTRANSFORM );
02013       xform = *transform;
02014     }
<a name="l02019"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a1">02019</a>     <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a0">EMRSETWORLDTRANSFORM</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02020 <font class="keyword">    </font>{
02021       ds &gt;&gt; emr &gt;&gt; xform;
02022     }
<a name="l02026"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a2">02026</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02027 <font class="keyword">    </font>{
02028       ds &lt;&lt; emr &lt;&lt; xform;
02029       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02030     }
<a name="l02034"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a3">02034</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02040"></a><a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a4">02040</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETWORLDTRANSFORM.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02041 <font class="keyword">    </font>{
02042       SetWorldTransform( dc, &amp;xform );
02043     }
02044 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02045 <font class="preprocessor"></font>
02048     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02049 <font class="keyword">    </font>{
02050       printf( <font class="stringliteral">"*SETWORLDTRANSFORM*\n"</font> );
02051       edit_xform( <font class="stringliteral">"xform"</font>, xform );
02052     }
02053 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02054   };
02055 
02057 
<a name="l02060"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html">02060</a>   <font class="keyword">class </font>EMRSETTEXTALIGN : <font class="keyword">public</font> METARECORD, ::EMRSETTEXTALIGN {
02061   <font class="keyword">public</font>:
<a name="l02065"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a0">02065</a>     <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a0">EMRSETTEXTALIGN</a> ( UINT mode )<font class="keyword"></font>
02066 <font class="keyword">    </font>{
02067       emr.iType = EMR_SETTEXTALIGN;
02068       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETTEXTALIGN );
02069       iMode = mode;
02070     }
<a name="l02075"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a1">02075</a>     <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a0">EMRSETTEXTALIGN</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02076 <font class="keyword">    </font>{
02077       ds &gt;&gt; emr &gt;&gt; iMode;
02078     }
<a name="l02082"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a2">02082</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02083 <font class="keyword">    </font>{
02084       ds &lt;&lt; emr &lt;&lt; iMode;
02085       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02086     }
<a name="l02090"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a3">02090</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02096"></a><a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a4">02096</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETTEXTALIGN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02097 <font class="keyword">    </font>{
02098       SetTextAlign( dc, iMode );
02099     }
02100 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02101 <font class="preprocessor"></font>
02104     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02105 <font class="keyword">    </font>{
02106       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> known_bits = TA_BASELINE+TA_CENTER+TA_UPDATECP+TA_RTLREADING;
02107       <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> unknown_bits = ~known_bits;
02108 
02109       printf( <font class="stringliteral">"*SETTEXTALIGN*\n"</font> );
02110       printf( <font class="stringliteral">"\tiMode\t: "</font> );
02111       <font class="keywordflow">if</font> ( iMode &amp; TA_UPDATECP )
02112         printf( <font class="stringliteral">"TA_UPDATECP"</font> );
02113       <font class="keywordflow">else</font>
02114         printf( <font class="stringliteral">"TA_NOUPDATECP"</font> );
02115       <font class="keywordflow">if</font> ( iMode &amp; TA_CENTER )
02116         printf( <font class="stringliteral">" | TA_CENTER"</font> );
02117       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( iMode &amp; TA_RIGHT )
02118         printf( <font class="stringliteral">" | TA_RIGHT"</font> );
02119       <font class="keywordflow">else</font>
02120         printf( <font class="stringliteral">" | TA_LEFT"</font> );
02121       <font class="keywordflow">if</font> ( iMode &amp; TA_BASELINE )
02122         printf( <font class="stringliteral">" | TA_BASELINE"</font> );
02123       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( iMode &amp; TA_BOTTOM )
02124         printf( <font class="stringliteral">" | TA_BOTTOM"</font> );
02125       <font class="keywordflow">else</font>
02126         printf( <font class="stringliteral">" | TA_TOP"</font> );
02127       <font class="keywordflow">if</font> ( iMode &amp; TA_RTLREADING )
02128         printf( <font class="stringliteral">" | TA_RTLREADING"</font> );
02129       <font class="keywordflow">if</font> ( iMode &amp; unknown_bits )
02130         printf( <font class="stringliteral">" | unknown bits(0x%lx)"</font>, iMode &amp; unknown_bits );
02131       printf( <font class="stringliteral">"\n"</font> );
02132     }
02133 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02134   };
02135 
02137 
<a name="l02140"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html">02140</a>   <font class="keyword">class </font>EMRSETTEXTCOLOR : <font class="keyword">public</font> METARECORD, ::EMRSETTEXTCOLOR {
02141   <font class="keyword">public</font>:
<a name="l02145"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a0">02145</a>     <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a0">EMRSETTEXTCOLOR</a> ( COLORREF color )<font class="keyword"></font>
02146 <font class="keyword">    </font>{
02147       emr.iType = EMR_SETTEXTCOLOR;
02148       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETTEXTCOLOR );
02149       crColor = color;
02150     }
<a name="l02155"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a1">02155</a>     <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a0">EMRSETTEXTCOLOR</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02156 <font class="keyword">    </font>{
02157       ds &gt;&gt; emr &gt;&gt; crColor;
02158     }
<a name="l02162"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a2">02162</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02163 <font class="keyword">    </font>{
02164       ds &lt;&lt; emr &lt;&lt; crColor;
02165       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02166     }
<a name="l02170"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a3">02170</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02176"></a><a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a4">02176</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETTEXTCOLOR.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02177 <font class="keyword">    </font>{
02178       SetTextColor( dc, crColor );
02179     }
02180 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02181 <font class="preprocessor"></font>
02184     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02185 <font class="keyword">    </font>{
02186       printf( <font class="stringliteral">"*SETTEXTCOLOR*\n"</font> );
02187       edit_color( <font class="stringliteral">"crColor"</font>, crColor );
02188     }
02189 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02190   };
02191 
02193 
<a name="l02196"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html">02196</a>   <font class="keyword">class </font>EMRSETBKCOLOR : <font class="keyword">public</font> METARECORD, ::EMRSETBKCOLOR {
02197   <font class="keyword">public</font>:
<a name="l02201"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a0">02201</a>     <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a0">EMRSETBKCOLOR</a> ( COLORREF color )<font class="keyword"></font>
02202 <font class="keyword">    </font>{
02203       emr.iType = EMR_SETBKCOLOR;
02204       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETBKCOLOR );
02205       crColor = color;
02206     }
<a name="l02211"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a1">02211</a>     <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a0">EMRSETBKCOLOR</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02212 <font class="keyword">    </font>{
02213       ds &gt;&gt; emr &gt;&gt; crColor;
02214     }
<a name="l02218"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a2">02218</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02219 <font class="keyword">    </font>{
02220       ds &lt;&lt; emr &lt;&lt; crColor;
02221       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02222     }
<a name="l02226"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a3">02226</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02232"></a><a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a4">02232</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETBKCOLOR.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02233 <font class="keyword">    </font>{
02234       SetBkColor( dc, crColor );
02235     }
02236 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02237 <font class="preprocessor"></font>
02240     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02241 <font class="keyword">    </font>{
02242       printf( <font class="stringliteral">"*SETBKCOLOR*\n"</font> );
02243       edit_color( <font class="stringliteral">"crColor"</font>, crColor );
02244     }
02245 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02246   };
02247 
02249 
<a name="l02253"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html">02253</a>   <font class="keyword">class </font>EMRSETBKMODE : <font class="keyword">public</font> METARECORD, ::EMRSETBKMODE {
02254   <font class="keyword">public</font>:
<a name="l02258"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a0">02258</a>     <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a0">EMRSETBKMODE</a> ( DWORD mode )<font class="keyword"></font>
02259 <font class="keyword">    </font>{
02260       emr.iType = EMR_SETBKMODE;
02261       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETBKMODE );
02262       iMode = mode;
02263     }
<a name="l02268"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a1">02268</a>     <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a0">EMRSETBKMODE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02269 <font class="keyword">    </font>{
02270       ds &gt;&gt; emr &gt;&gt; iMode;
02271     }
<a name="l02275"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a2">02275</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02276 <font class="keyword">    </font>{
02277       ds &lt;&lt; emr &lt;&lt; iMode;
02278       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02279     }
<a name="l02283"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a3">02283</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02289"></a><a class="code" href="classEMF_1_1EMRSETBKMODE.html#a4">02289</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETBKMODE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02290 <font class="keyword">    </font>{
02291       SetBkMode( dc, iMode );
02292     }
02293 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02294 <font class="preprocessor"></font>
02297     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02298 <font class="keyword">    </font>{
02299       printf( <font class="stringliteral">"*SETBKMODE*\n"</font> );
02300       printf( <font class="stringliteral">"\tiMode\t: "</font> );
02301       <font class="keywordflow">switch</font> ( iMode ) {
02302       <font class="keywordflow">case</font> TRANSPARENT: printf( <font class="stringliteral">"TRANSPARENT\n"</font> ); <font class="keywordflow">break</font>;
02303       <font class="keywordflow">case</font> OPAQUE: printf( <font class="stringliteral">"OPAQUE\n"</font> ); <font class="keywordflow">break</font>;
02304       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
02305       }
02306     }
02307 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02308   };
02309 
02311 
<a name="l02314"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html">02314</a>   <font class="keyword">class </font>EMRSETPOLYFILLMODE : <font class="keyword">public</font> METARECORD, ::EMRSETPOLYFILLMODE {
02315   <font class="keyword">public</font>:
<a name="l02319"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a0">02319</a>     <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a0">EMRSETPOLYFILLMODE</a> ( DWORD mode )<font class="keyword"></font>
02320 <font class="keyword">    </font>{
02321       emr.iType = EMR_SETPOLYFILLMODE;
02322       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETPOLYFILLMODE );
02323       iMode = mode;
02324     }
<a name="l02329"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a1">02329</a>     <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a0">EMRSETPOLYFILLMODE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02330 <font class="keyword">    </font>{
02331       ds &gt;&gt; emr &gt;&gt; iMode;
02332     }
<a name="l02336"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a2">02336</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02337 <font class="keyword">    </font>{
02338       ds &lt;&lt; emr &lt;&lt; iMode;
02339       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02340     }
<a name="l02344"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a3">02344</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02350"></a><a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a4">02350</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETPOLYFILLMODE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02351 <font class="keyword">    </font>{
02352       SetPolyFillMode( dc, iMode );
02353     }
02354 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02355 <font class="preprocessor"></font>
02358     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02359 <font class="keyword">    </font>{
02360       printf( <font class="stringliteral">"*SETPOLYFILLMODE*\n"</font> );
02361       printf( <font class="stringliteral">"\tiMode: "</font> );
02362       <font class="keywordflow">switch</font> ( iMode ) {
02363       <font class="keywordflow">case</font> ALTERNATE: printf( <font class="stringliteral">"ALTERNATE\n"</font> ); <font class="keywordflow">break</font>;
02364       <font class="keywordflow">case</font> WINDING: printf( <font class="stringliteral">"WINDING\n"</font> ); <font class="keywordflow">break</font>;
02365       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
02366       }
02367     }
02368 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02369   };
02370 
02372 
<a name="l02376"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html">02376</a>   <font class="keyword">class </font>EMRSETMAPMODE : <font class="keyword">public</font> METARECORD, ::EMRSETMAPMODE {
02377   <font class="keyword">public</font>:
<a name="l02381"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a0">02381</a>     <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a0">EMRSETMAPMODE</a> ( DWORD mode )<font class="keyword"></font>
02382 <font class="keyword">    </font>{
02383       emr.iType = EMR_SETMAPMODE;
02384       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETMAPMODE );
02385       iMode = mode;
02386     }
<a name="l02391"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a1">02391</a>     <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a0">EMRSETMAPMODE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02392 <font class="keyword">    </font>{
02393       ds &gt;&gt; emr &gt;&gt; iMode;
02394     }
<a name="l02398"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a2">02398</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02399 <font class="keyword">    </font>{
02400       ds &lt;&lt; emr &lt;&lt; iMode;
02401       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02402     }
<a name="l02406"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a3">02406</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02412"></a><a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a4">02412</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETMAPMODE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02413 <font class="keyword">    </font>{
02414       SetMapMode( dc, iMode );
02415     }
02416 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02417 <font class="preprocessor"></font>
02420     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02421 <font class="keyword">    </font>{
02422       printf( <font class="stringliteral">"*SETMAPMODE*\n"</font> );
02423       printf( <font class="stringliteral">"\tiMode\t: "</font> );
02424       <font class="keywordflow">switch</font> ( iMode ) {
02425       <font class="keywordflow">case</font> MM_TEXT: printf( <font class="stringliteral">"MM_TEXT\n"</font> ); <font class="keywordflow">break</font>;
02426       <font class="keywordflow">case</font> MM_LOMETRIC: printf( <font class="stringliteral">"MM_LOMETRIC\n"</font> ); <font class="keywordflow">break</font>;
02427       <font class="keywordflow">case</font> MM_HIMETRIC: printf( <font class="stringliteral">"MM_HIMETRIC\n"</font> ); <font class="keywordflow">break</font>;
02428       <font class="keywordflow">case</font> MM_LOENGLISH: printf( <font class="stringliteral">"MM_LOENGLISH\n"</font> ); <font class="keywordflow">break</font>;
02429       <font class="keywordflow">case</font> MM_HIENGLISH: printf( <font class="stringliteral">"MM_HIENGLISH\n"</font> ); <font class="keywordflow">break</font>;
02430       <font class="keywordflow">case</font> MM_TWIPS: printf( <font class="stringliteral">"MM_TWIPS\n"</font> ); <font class="keywordflow">break</font>;
02431       <font class="keywordflow">case</font> MM_ISOTROPIC: printf( <font class="stringliteral">"MM_ISOTROPIC\n"</font> ); <font class="keywordflow">break</font>;
02432       <font class="keywordflow">case</font> MM_ANISOTROPIC: printf( <font class="stringliteral">"MM_ANISOTROPIC\n"</font> ); <font class="keywordflow">break</font>;
02433       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iMode );
02434       }
02435     }
02436 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02437   };
02438 
02440 
<a name="l02443"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html">02443</a>   <font class="keyword">class </font>EMRSELECTOBJECT : <font class="keyword">public</font> METARECORD, ::EMRSELECTOBJECT {
02444   <font class="keyword">public</font>:
<a name="l02448"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a0">02448</a>     <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a0">EMRSELECTOBJECT</a> ( HGDIOBJ object )<font class="keyword"></font>
02449 <font class="keyword">    </font>{
02450       emr.iType = EMR_SELECTOBJECT;
02451       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSELECTOBJECT );
02452       ihObject = object;
02453     }
<a name="l02458"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a1">02458</a>     <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a0">EMRSELECTOBJECT</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02459 <font class="keyword">    </font>{
02460       ds &gt;&gt; emr &gt;&gt; ihObject;
02461     }
<a name="l02465"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a2">02465</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02466 <font class="keyword">    </font>{
02467       ds &lt;&lt; emr &lt;&lt; ihObject;
02468       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02469     }
<a name="l02473"></a><a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a3">02473</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
02479     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSELECTOBJECT.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
02480 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02481 <font class="preprocessor"></font>
02484     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02485 <font class="keyword">    </font>{
02486       printf( <font class="stringliteral">"*SELECTOBJECT*\n"</font> );
02487       printf( <font class="stringliteral">"\tihObject\t: 0x%lx\n"</font>, ihObject );
02488     }
02489 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02490   };
02491 
02493 
<a name="l02496"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html">02496</a>   <font class="keyword">class </font>EMRDELETEOBJECT : <font class="keyword">public</font> METARECORD, ::EMRDELETEOBJECT {
02497   <font class="keyword">public</font>:
<a name="l02501"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a0">02501</a>     <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a0">EMRDELETEOBJECT</a> ( HGDIOBJ object )<font class="keyword"></font>
02502 <font class="keyword">    </font>{
02503       emr.iType = EMR_DELETEOBJECT;
02504       emr.nSize = <font class="keyword">sizeof</font>( ::EMRDELETEOBJECT );
02505       ihObject = object;
02506     }
<a name="l02511"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a1">02511</a>     <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a0">EMRDELETEOBJECT</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02512 <font class="keyword">    </font>{
02513       ds &gt;&gt; emr &gt;&gt; ihObject;
02514     }
<a name="l02518"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a2">02518</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02519 <font class="keyword">    </font>{
02520       ds &lt;&lt; emr &lt;&lt; ihObject;
02521       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02522     }
<a name="l02526"></a><a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a3">02526</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
02532     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRDELETEOBJECT.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
02533 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02534 <font class="preprocessor"></font>
02537     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02538 <font class="keyword">    </font>{
02539       printf( <font class="stringliteral">"*DELETEOBJECT*\n"</font> );
02540       printf( <font class="stringliteral">"\tihObject\t: 0x%lx\n"</font>, ihObject );
02541     }
02542 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02543   };
02544 
02546 
<a name="l02549"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html">02549</a>   <font class="keyword">class </font>EMRMOVETOEX : <font class="keyword">public</font> METARECORD, ::EMRMOVETOEX {
02550   <font class="keyword">public</font>:
<a name="l02555"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a0">02555</a>     <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a0">EMRMOVETOEX</a> ( INT x, INT y )<font class="keyword"></font>
02556 <font class="keyword">    </font>{
02557       emr.iType = EMR_MOVETOEX;
02558       emr.nSize = <font class="keyword">sizeof</font>( ::EMRMOVETOEX );
02559       ptl.x = x;
02560       ptl.y = y;
02561     }
<a name="l02566"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a1">02566</a>     <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a0">EMRMOVETOEX</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02567 <font class="keyword">    </font>{
02568       ds &gt;&gt; emr &gt;&gt; ptl;
02569     }
<a name="l02573"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a2">02573</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02574 <font class="keyword">    </font>{
02575       ds &lt;&lt; emr &lt;&lt; ptl;
02576       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02577     }
<a name="l02581"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a3">02581</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02587"></a><a class="code" href="classEMF_1_1EMRMOVETOEX.html#a4">02587</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRMOVETOEX.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02588 <font class="keyword">    </font>{
02589       MoveToEx( dc,  ptl.x, ptl.y, 0 );
02590     }
02591 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02592 <font class="preprocessor"></font>
02595     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02596 <font class="keyword">    </font>{
02597       printf( <font class="stringliteral">"*MOVETOEX*\n"</font> );
02598       edit_pointl( <font class="stringliteral">"ptl"</font>, ptl );
02599     }
02600 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02601   };
02602 
02604 
<a name="l02607"></a><a class="code" href="classEMF_1_1EMRLINETO.html">02607</a>   <font class="keyword">class </font>EMRLINETO : <font class="keyword">public</font> METARECORD, ::EMRLINETO {
02608   <font class="keyword">public</font>:
<a name="l02613"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a0">02613</a>     <a class="code" href="classEMF_1_1EMRLINETO.html#a0">EMRLINETO</a> ( INT x, INT y )<font class="keyword"></font>
02614 <font class="keyword">    </font>{
02615       emr.iType = EMR_LINETO;
02616       emr.nSize = <font class="keyword">sizeof</font>( ::EMRLINETO );
02617       ptl.x = x;
02618       ptl.y = y;
02619     }
<a name="l02624"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a1">02624</a>     <a class="code" href="classEMF_1_1EMRLINETO.html#a0">EMRLINETO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02625 <font class="keyword">    </font>{
02626       ds &gt;&gt; emr &gt;&gt; ptl;
02627     }
<a name="l02631"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a2">02631</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRLINETO.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02632 <font class="keyword">    </font>{
02633       ds &lt;&lt; emr &lt;&lt; ptl;
02634       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02635     }
<a name="l02639"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a3">02639</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRLINETO.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02645"></a><a class="code" href="classEMF_1_1EMRLINETO.html#a4">02645</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRLINETO.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02646 <font class="keyword">    </font>{
02647       LineTo( dc,  ptl.x, ptl.y );
02648     }
02649 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02650 <font class="preprocessor"></font>
02653     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02654 <font class="keyword">    </font>{
02655       printf( <font class="stringliteral">"*LINETO*\n"</font> );
02656       edit_pointl( <font class="stringliteral">"ptl"</font>, ptl );
02657     }
02658 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02659   };
02660 
02662 
<a name="l02665"></a><a class="code" href="classEMF_1_1EMRARC.html">02665</a>   <font class="keyword">class </font>EMRARC : <font class="keyword">public</font> METARECORD, ::EMRARC {
02666   <font class="keyword">public</font>:
<a name="l02678"></a><a class="code" href="classEMF_1_1EMRARC.html#a0">02678</a>     <a class="code" href="classEMF_1_1EMRARC.html#a0">EMRARC</a> ( INT left, INT top, INT right, INT bottom, INT xstart,
02679              INT ystart, INT xend, INT yend )<font class="keyword"></font>
02680 <font class="keyword">    </font>{
02681       emr.iType = EMR_ARC;
02682       emr.nSize = <font class="keyword">sizeof</font>( ::EMRARC );
02683       rclBox.left = left;
02684       rclBox.right = right;
02685       rclBox.bottom = bottom;
02686       rclBox.top = top;
02687       ptlStart.x = xstart;
02688       ptlStart.y = ystart;
02689       ptlEnd.x = xend;
02690       ptlEnd.y = yend;
02691     }
<a name="l02696"></a><a class="code" href="classEMF_1_1EMRARC.html#a1">02696</a>     <a class="code" href="classEMF_1_1EMRARC.html#a0">EMRARC</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02697 <font class="keyword">    </font>{
02698       ds &gt;&gt; emr &gt;&gt; rclBox &gt;&gt; ptlStart &gt;&gt; ptlEnd;
02699     }
<a name="l02703"></a><a class="code" href="classEMF_1_1EMRARC.html#a2">02703</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRARC.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02704 <font class="keyword">    </font>{
02705       ds &lt;&lt; emr &lt;&lt; rclBox &lt;&lt; ptlStart &lt;&lt; ptlEnd;
02706       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02707     }
<a name="l02711"></a><a class="code" href="classEMF_1_1EMRARC.html#a3">02711</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRARC.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02717"></a><a class="code" href="classEMF_1_1EMRARC.html#a4">02717</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRARC.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02718 <font class="keyword">    </font>{
02719       Arc( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom,
02720            ptlStart.x, ptlStart.y, ptlEnd.x, ptlEnd.y );
02721     }
02722 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02723 <font class="preprocessor"></font>
02726     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02727 <font class="keyword">    </font>{
02728       printf( <font class="stringliteral">"*ARC*\n"</font> );
02729       edit_rectl( <font class="stringliteral">"rclBox\t"</font>, rclBox );
02730       edit_pointl( <font class="stringliteral">"ptlStart"</font>, ptlStart );
02731       edit_pointl( <font class="stringliteral">"ptlEnd\t"</font>, ptlEnd );
02732     }
02733 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02734   };
02735 
02737 
<a name="l02740"></a><a class="code" href="classEMF_1_1EMRARCTO.html">02740</a>   <font class="keyword">class </font>EMRARCTO : <font class="keyword">public</font> METARECORD, ::EMRARCTO {
02741   <font class="keyword">public</font>:
<a name="l02753"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a0">02753</a>     <a class="code" href="classEMF_1_1EMRARCTO.html#a0">EMRARCTO</a> ( INT left, INT top, INT right, INT bottom, INT xstart,
02754              INT ystart, INT xend, INT yend )<font class="keyword"></font>
02755 <font class="keyword">    </font>{
02756       emr.iType = EMR_ARCTO;
02757       emr.nSize = <font class="keyword">sizeof</font>( ::EMRARCTO );
02758       rclBox.left = left;
02759       rclBox.right = right;
02760       rclBox.bottom = bottom;
02761       rclBox.top = top;
02762       ptlStart.x = xstart;
02763       ptlStart.y = ystart;
02764       ptlEnd.x = xend;
02765       ptlEnd.y = yend;
02766     }
<a name="l02771"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a1">02771</a>     <a class="code" href="classEMF_1_1EMRARCTO.html#a0">EMRARCTO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02772 <font class="keyword">    </font>{
02773       ds &gt;&gt; emr &gt;&gt; rclBox &gt;&gt; ptlStart &gt;&gt; ptlEnd;
02774     }
<a name="l02778"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a2">02778</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRARCTO.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02779 <font class="keyword">    </font>{
02780       ds &lt;&lt; emr &lt;&lt; rclBox &lt;&lt; ptlStart &lt;&lt; ptlEnd;
02781       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02782     }
<a name="l02786"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a3">02786</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRARCTO.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02792"></a><a class="code" href="classEMF_1_1EMRARCTO.html#a4">02792</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRARCTO.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02793 <font class="keyword">    </font>{
02794       ArcTo( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom,
02795              ptlStart.x, ptlStart.y, ptlEnd.x, ptlEnd.y );
02796     }
02797 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02798 <font class="preprocessor"></font>
02801     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02802 <font class="keyword">    </font>{
02803       printf( <font class="stringliteral">"*ARCTO*\n"</font> );
02804       edit_rectl( <font class="stringliteral">"rclBox\t"</font>, rclBox );
02805       edit_pointl( <font class="stringliteral">"ptlStart"</font>, ptlStart );
02806       edit_pointl( <font class="stringliteral">"ptlEnd\t"</font>, ptlEnd );
02807     }
02808 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02809   };
02810 
02812 
<a name="l02815"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html">02815</a>   <font class="keyword">class </font>EMRRECTANGLE : <font class="keyword">public</font> METARECORD, ::EMRRECTANGLE {
02816   <font class="keyword">public</font>:
<a name="l02823"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a0">02823</a>     <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a0">EMRRECTANGLE</a> ( INT left, INT top, INT right, INT bottom )<font class="keyword"></font>
02824 <font class="keyword">    </font>{
02825       emr.iType = EMR_RECTANGLE;
02826       emr.nSize = <font class="keyword">sizeof</font>( ::EMRRECTANGLE );
02827       rclBox.left = left;
02828       rclBox.right = right;
02829       rclBox.bottom = bottom;
02830       rclBox.top = top;
02831     }
<a name="l02836"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a1">02836</a>     <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a0">EMRRECTANGLE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02837 <font class="keyword">    </font>{
02838       ds &gt;&gt; emr &gt;&gt; rclBox;
02839     }
<a name="l02843"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a2">02843</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02844 <font class="keyword">    </font>{
02845       ds &lt;&lt; emr &lt;&lt; rclBox;
02846       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02847     }
<a name="l02851"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a3">02851</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02857"></a><a class="code" href="classEMF_1_1EMRRECTANGLE.html#a4">02857</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRRECTANGLE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02858 <font class="keyword">    </font>{
02859       Rectangle( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom );
02860     }
02861 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02862 <font class="preprocessor"></font>
02865     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02866 <font class="keyword">    </font>{
02867       printf( <font class="stringliteral">"*RECTANGLE*\n"</font> );
02868       edit_rectl( <font class="stringliteral">"rclBox"</font>, rclBox );
02869     }
02870 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02871   };
02872 
02874 
<a name="l02877"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html">02877</a>   <font class="keyword">class </font>EMRELLIPSE : <font class="keyword">public</font> METARECORD, ::EMRELLIPSE {
02878   <font class="keyword">public</font>:
<a name="l02886"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a0">02886</a>     <a class="code" href="classEMF_1_1EMRELLIPSE.html#a0">EMRELLIPSE</a> ( INT left, INT top, INT right, INT bottom )<font class="keyword"></font>
02887 <font class="keyword">    </font>{
02888       emr.iType = EMR_ELLIPSE;
02889       emr.nSize = <font class="keyword">sizeof</font>( ::EMRELLIPSE );
02890       rclBox.left = left;
02891       rclBox.right = right;
02892       rclBox.bottom = bottom;
02893       rclBox.top = top;
02894     }
<a name="l02899"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a1">02899</a>     <a class="code" href="classEMF_1_1EMRELLIPSE.html#a0">EMRELLIPSE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02900 <font class="keyword">    </font>{
02901       ds &gt;&gt; emr &gt;&gt; rclBox;
02902     }
<a name="l02906"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a2">02906</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRELLIPSE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02907 <font class="keyword">    </font>{
02908       ds &lt;&lt; emr &lt;&lt; rclBox;
02909       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02910     }
<a name="l02914"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a3">02914</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRELLIPSE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l02920"></a><a class="code" href="classEMF_1_1EMRELLIPSE.html#a4">02920</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRELLIPSE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
02921 <font class="keyword">    </font>{
02922       Ellipse( dc, rclBox.left, rclBox.top, rclBox.right, rclBox.bottom );
02923     }
02924 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
02925 <font class="preprocessor"></font>
02928     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
02929 <font class="keyword">    </font>{
02930       printf( <font class="stringliteral">"*ELLIPSE*\n"</font> );
02931       edit_rectl( <font class="stringliteral">"rclBox"</font>, rclBox );
02932     }
02933 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
02934   };
02935 
02937 
<a name="l02940"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html">02940</a>   <font class="keyword">class </font>EMRPOLYLINE : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINE {
02941     POINTL* lpoints;
02942   <font class="keyword">public</font>:
<a name="l02948"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a0">02948</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a0">EMRPOLYLINE</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
02949 <font class="keyword">    </font>{
02950       cptl = n;
02951       aptl[0].x = 0;            <font class="comment">// Really unused</font>
02952       aptl[0].y = 0;
02953 
02954       emr.iType = EMR_POLYLINE;
02955       <font class="comment">// The (cptl - 1) below is to account for aptl, which isn't written out</font>
02956       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINE ) + <font class="keyword">sizeof</font>( POINTL ) * ( cptl - 1);
02957 
02958       lpoints = <font class="keyword">new</font> POINTL[cptl];
02959 
02960       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
02961         lpoints[i].x = points[i].x;
02962         lpoints[i].y = points[i].y;
02963       }
02964 
02965       rclBounds = *bounds;
02966     }
<a name="l02970"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a1">02970</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a1">~EMRPOLYLINE</a> ( )<font class="keyword"></font>
02971 <font class="keyword">    </font>{
02972       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
02973     }
<a name="l02978"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a2">02978</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a0">EMRPOLYLINE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
02979 <font class="keyword">    </font>{
02980       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
02981 
02982       lpoints = <font class="keyword">new</font> POINTL[cptl];
02983 
02984       POINTLARRAY points( lpoints, cptl );
02985 
02986       ds &gt;&gt; points;
02987     }
<a name="l02991"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a3">02991</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
02992 <font class="keyword">    </font>{
02993       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
02994       <font class="keywordflow">return</font> <font class="keyword">true</font>;
02995     }
<a name="l02999"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a4">02999</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03005"></a><a class="code" href="classEMF_1_1EMRPOLYLINE.html#a5">03005</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINE.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03006 <font class="keyword">    </font>{
03007       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03008       Polyline( dc, (POINT*)lpoints, cptl );
03009     }
03010 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03011 <font class="preprocessor"></font>
03014     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03015 <font class="keyword">    </font>{
03016       printf( <font class="stringliteral">"*POLYLINE*\n"</font> );
03017       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03018 <font class="preprocessor">#if 0</font>
03019 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03020       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03021       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03022         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03023 <font class="preprocessor">#else</font>
03024 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03025 <font class="preprocessor">#endif</font>
03026 <font class="preprocessor"></font>    }
03027 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03028   };
03029 
03031 
<a name="l03034"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html">03034</a>   <font class="keyword">class </font>EMRPOLYLINE16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINE16 {
03035     POINT16* lpoints;
03036   <font class="keyword">public</font>:
<a name="l03042"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">03042</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">EMRPOLYLINE16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
03043 <font class="keyword">    </font>{
03044       cpts = n;
03045       apts[0].x = 0;            <font class="comment">// Really unused</font>
03046       apts[0].y = 0;
03047 
03048       emr.iType = EMR_POLYLINE16;
03049       <font class="comment">// The (cptl - 1) below is to account for aptl, which isn't written out</font>
03050       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINE16 ) + <font class="keyword">sizeof</font>( POINT16 ) * ( cpts - 1);
03051 
03052       lpoints = <font class="keyword">new</font> POINT16[cpts];
03053 
03054       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03055         lpoints[i].x = points[i].x;
03056         lpoints[i].y = points[i].y;
03057       }
03058 
03059       rclBounds = *bounds;
03060     }
<a name="l03067"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a1">03067</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">EMRPOLYLINE16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03068 <font class="keyword">    </font>{
03069       cpts = n;
03070       apts[0].x = 0;            <font class="comment">// Really unused</font>
03071       apts[0].y = 0;
03072 
03073       emr.iType = EMR_POLYLINE16;
03074       <font class="comment">// The (cptl - 1) below is to account for aptl, which isn't written out</font>
03075       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINE16 ) + <font class="keyword">sizeof</font>( POINT16 ) * ( cpts - 1);
03076 
03077       lpoints = <font class="keyword">new</font> POINT16[cpts];
03078 
03079       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03080         lpoints[i].x = points[i].x;
03081         lpoints[i].y = points[i].y;
03082       }
03083 
03084       rclBounds = *bounds;
03085     }
<a name="l03089"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a2">03089</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a2">~EMRPOLYLINE16</a> ( )<font class="keyword"></font>
03090 <font class="keyword">    </font>{
03091       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03092     }
<a name="l03097"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a3">03097</a>     <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a0">EMRPOLYLINE16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03098 <font class="keyword">    </font>{
03099       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
03100 
03101       lpoints = <font class="keyword">new</font> POINT16[cpts];
03102 
03103       POINT16ARRAY points( lpoints, cpts );
03104 
03105       ds &gt;&gt; points;
03106     }
<a name="l03110"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a4">03110</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03111 <font class="keyword">    </font>{
03112       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
03113       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03114     }
<a name="l03118"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a5">03118</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03124"></a><a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a6">03124</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINE16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03125 <font class="keyword">    </font>{
03126       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03127       Polyline16( dc, lpoints, cpts );
03128     }
03129 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03130 <font class="preprocessor"></font>
03133     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03134 <font class="keyword">    </font>{
03135       printf( <font class="stringliteral">"*POLYLINE16*\n"</font> );
03136       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03137       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
03138     }
03139 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03140   };
03141 
03143 
<a name="l03146"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html">03146</a>   <font class="keyword">class </font>EMRPOLYGON : <font class="keyword">public</font> METARECORD, ::EMRPOLYGON {
03147     POINTL* lpoints;
03148   <font class="keyword">public</font>:
<a name="l03154"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a0">03154</a>     <a class="code" href="classEMF_1_1EMRPOLYGON.html#a0">EMRPOLYGON</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03155 <font class="keyword">    </font>{
03156       cptl = n;
03157       aptl[0].x = 0;            <font class="comment">// Really unused</font>
03158       aptl[0].y = 0;
03159 
03160       emr.iType = EMR_POLYGON;
03161       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03162       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYGON ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
03163 
03164       lpoints = <font class="keyword">new</font> POINTL[cptl];
03165 
03166       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03167         lpoints[i].x = points[i].x;
03168         lpoints[i].y = points[i].y;
03169       }
03170 
03171       rclBounds = *bounds;
03172     }
<a name="l03177"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a1">03177</a>     <a class="code" href="classEMF_1_1EMRPOLYGON.html#a0">EMRPOLYGON</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03178 <font class="keyword">    </font>{
03179       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
03180 
03181       lpoints = <font class="keyword">new</font> POINTL[cptl];
03182 
03183       POINTLARRAY points( lpoints, cptl );
03184 
03185       ds &gt;&gt; points;
03186     }
<a name="l03190"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a2">03190</a>     <a class="code" href="classEMF_1_1EMRPOLYGON.html#a2">~EMRPOLYGON</a> ( )<font class="keyword"></font>
03191 <font class="keyword">    </font>{
03192       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03193     }
<a name="l03197"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a3">03197</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYGON.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03198 <font class="keyword">    </font>{
03199       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
03200       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03201     }
<a name="l03205"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a4">03205</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYGON.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03211"></a><a class="code" href="classEMF_1_1EMRPOLYGON.html#a5">03211</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYGON.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03212 <font class="keyword">    </font>{
03213       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03214       Polygon( dc, (POINT*)lpoints, cptl );
03215     }
03216 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03217 <font class="preprocessor"></font>
03220     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03221 <font class="keyword">    </font>{
03222       printf( <font class="stringliteral">"*POLYGON*\n"</font> );
03223       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03224 <font class="preprocessor">#if 0</font>
03225 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03226       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03227       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03228         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03229 <font class="preprocessor">#else</font>
03230 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03231 <font class="preprocessor">#endif</font>
03232 <font class="preprocessor"></font>    }
03233 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03234   };
03235 
03237 
<a name="l03240"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html">03240</a>   <font class="keyword">class </font>EMRPOLYGON16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYGON16 {
03241     POINT16* lpoints;
03242   <font class="keyword">public</font>:
<a name="l03248"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">03248</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">EMRPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT16 n )<font class="keyword"></font>
03249 <font class="keyword">    </font>{
03250       cpts = n;
03251       apts[0].x = 0;            <font class="comment">// Really unused</font>
03252       apts[0].y = 0;
03253 
03254       emr.iType = EMR_POLYGON16;
03255       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03256       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03257 
03258       lpoints = <font class="keyword">new</font> POINT16[cpts];
03259 
03260       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03261         lpoints[i].x = points[i].x;
03262         lpoints[i].y = points[i].y;
03263       }
03264 
03265       rclBounds = *bounds;
03266     }
<a name="l03273"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a1">03273</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">EMRPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT16 n )<font class="keyword"></font>
03274 <font class="keyword">    </font>{
03275       cpts = n;
03276       apts[0].x = 0;            <font class="comment">// Really unused</font>
03277       apts[0].y = 0;
03278 
03279       emr.iType = EMR_POLYGON16;
03280       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03281       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03282 
03283       lpoints = <font class="keyword">new</font> POINT16[cpts];
03284 
03285       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03286         lpoints[i].x = points[i].x;
03287         lpoints[i].y = points[i].y;
03288       }
03289 
03290       rclBounds = *bounds;
03291     }
<a name="l03296"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a2">03296</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a0">EMRPOLYGON16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03297 <font class="keyword">    </font>{
03298       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
03299 
03300       lpoints = <font class="keyword">new</font> POINT16[cpts];
03301 
03302       POINT16ARRAY points( lpoints, cpts );
03303 
03304       ds &gt;&gt; points;
03305     }
<a name="l03309"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a3">03309</a>     <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a3">~EMRPOLYGON16</a> ( )<font class="keyword"></font>
03310 <font class="keyword">    </font>{
03311       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03312     }
<a name="l03316"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a4">03316</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03317 <font class="keyword">    </font>{
03318       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
03319       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03320     }
<a name="l03324"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a5">03324</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03330"></a><a class="code" href="classEMF_1_1EMRPOLYGON16.html#a6">03330</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYGON16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03331 <font class="keyword">    </font>{
03332       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03333       Polygon16( dc, lpoints, cpts );
03334     }
03335 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03336 <font class="preprocessor"></font>
03339     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03340 <font class="keyword">    </font>{
03341       printf( <font class="stringliteral">"*POLYGON16*\n"</font> );
03342       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03343       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
03344     }
03345 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03346   };
03347 
03349 
<a name="l03352"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html">03352</a>   <font class="keyword">class </font>EMRPOLYPOLYGON : <font class="keyword">public</font> METARECORD, ::EMRPOLYPOLYGON {
03353     DWORD* lcounts;
03354     POINTL* lpoints;
03355   <font class="keyword">public</font>:
<a name="l03362"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a0">03362</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a0">EMRPOLYPOLYGON</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, <font class="keyword">const</font> INT* counts,
03363                      UINT polygons )<font class="keyword"></font>
03364 <font class="keyword">    </font>{
03365       nPolys = polygons;
03366       <font class="comment">// Count the number of points in points</font>
03367       <font class="keywordtype">int</font> n = 0;
03368       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03369         n += counts[i];
03370 
03371       cptl = n;
03372       aPolyCounts[0] = 0;       <font class="comment">// Really unused</font>
03373       aptl[0].x = 0;
03374       aptl[0].y = 0;
03375 
03376       emr.iType = EMR_POLYPOLYGON;
03377       <font class="comment">// The (#-1)'s below are to account for aPolyCounts[0] and aptl[0], which</font>
03378       <font class="comment">// aren't directly written out</font>
03379       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYPOLYGON ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1)
03380         + <font class="keyword">sizeof</font>( DWORD ) * (nPolys-1);
03381 
03382       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03383 
03384       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03385         lcounts[i] = counts[i];
03386 
03387       lpoints = <font class="keyword">new</font> POINTL[cptl];
03388 
03389       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03390         lpoints[i].x = points[i].x;
03391         lpoints[i].y = points[i].y;
03392       }
03393 
03394       rclBounds = *bounds;
03395     }
<a name="l03399"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a1">03399</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a1">~EMRPOLYPOLYGON</a> ( )<font class="keyword"></font>
03400 <font class="keyword">    </font>{
03401       <font class="keywordflow">if</font> ( lcounts ) <font class="keyword">delete</font>[] lcounts;
03402       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03403     }
<a name="l03408"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a2">03408</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a0">EMRPOLYPOLYGON</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03409 <font class="keyword">    </font>{
03410       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; nPolys &gt;&gt; cptl;
03411 
03412       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03413 
03414       DWORDARRAY counts( lcounts, nPolys );
03415 
03416       ds &gt;&gt; counts;
03417 
03418       lpoints = <font class="keyword">new</font> POINTL[cptl];
03419 
03420       POINTLARRAY points( lpoints, cptl );
03421 
03422       ds &gt;&gt; points;
03423     }
<a name="l03427"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a3">03427</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03428 <font class="keyword">    </font>{
03429       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; nPolys &lt;&lt; cptl &lt;&lt; DWORDARRAY( lcounts, nPolys )
03430          &lt;&lt; POINTLARRAY( lpoints, cptl );
03431       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03432     }
<a name="l03436"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a4">03436</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03442"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a5">03442</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03443 <font class="keyword">    </font>{
03444       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03445       <font class="comment">// (but DWORD and INT are not)</font>
03446       INT* counts = <font class="keyword">new</font> INT[nPolys];
03447       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03448         counts[i] = lcounts[i];
03449 
03450       PolyPolygon( dc, (POINT*)lpoints, counts, nPolys );
03451 
03452       <font class="keyword">delete</font>[] counts;
03453     }
03454 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03455 <font class="preprocessor"></font>
03458     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03459 <font class="keyword">    </font>{
03460       printf( <font class="stringliteral">"*POLYPOLYGON*\n"</font> );
03461       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03462       printf( <font class="stringliteral">"\tnPolys\t\t: %ld\n"</font>, nPolys );
03463       printf( <font class="stringliteral">"\tcptl\t\t: %ld\n"</font>, cptl );
03464       printf( <font class="stringliteral">"\taPolyCounts\t: "</font> );
03465       <font class="keywordflow">if</font> ( nPolys &gt; 0 )
03466         printf( <font class="stringliteral">"%ld\n"</font>, lcounts[0] );
03467       <font class="keywordflow">else</font>
03468         puts( <font class="stringliteral">""</font> );
03469       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; nPolys; i++ )
03470         printf( <font class="stringliteral">"\t\t\t  %ld\n"</font>, lcounts[i] );
03471       printf( <font class="stringliteral">"\tapts\t\t: "</font> );
03472       <font class="keywordflow">if</font> ( cptl &gt; 0 )
03473         printf( <font class="stringliteral">"%ld, %ld\n"</font>, lpoints[0].x, lpoints[0].y );
03474       <font class="keywordflow">else</font>
03475         puts( <font class="stringliteral">""</font> );
03476       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; cptl; i++ )
03477         printf( <font class="stringliteral">"\t\t\t  %ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03478     }
03479 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03480   };
03481 
03483 
<a name="l03486"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html">03486</a>   <font class="keyword">class </font>EMRPOLYPOLYGON16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYPOLYGON16 {
03487     DWORD* lcounts;
03488     POINT16* lpoints;
03489   <font class="keyword">public</font>:
<a name="l03496"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">03496</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">EMRPOLYPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points,
03497                        <font class="keyword">const</font> INT* counts, UINT polygons )<font class="keyword"></font>
03498 <font class="keyword">    </font>{
03499       nPolys = polygons;
03500       <font class="comment">// Count the number of points in points</font>
03501       <font class="keywordtype">int</font> n = 0;
03502       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03503         n += counts[i];
03504 
03505       cpts = n;
03506       aPolyCounts[0] = 0;       <font class="comment">// Really unused</font>
03507       apts[0].x = 0;
03508       apts[0].y = 0;
03509 
03510       emr.iType = EMR_POLYPOLYGON16;
03511       <font class="comment">// The (#-1)'s below are to account for aPolyCounts[0] and aptl[0], which</font>
03512       <font class="comment">// aren't directly written out</font>
03513       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1)
03514         + <font class="keyword">sizeof</font>( DWORD ) * (nPolys-1);
03515 
03516       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03517 
03518       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03519         lcounts[i] = counts[i];
03520 
03521       lpoints = <font class="keyword">new</font> POINT16[cpts];
03522 
03523       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03524         lpoints[i].x = points[i].x;
03525         lpoints[i].y = points[i].y;
03526       }
03527 
03528       rclBounds = *bounds;
03529     }
<a name="l03537"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a1">03537</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">EMRPOLYPOLYGON16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points,
03538                        <font class="keyword">const</font> INT* counts, UINT16 polygons )<font class="keyword"></font>
03539 <font class="keyword">    </font>{
03540       nPolys = polygons;
03541       <font class="comment">// Count the number of points in points</font>
03542       <font class="keywordtype">int</font> n = 0;
03543       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03544         n += counts[i];
03545 
03546       cpts = n;
03547       aPolyCounts[0] = 0;       <font class="comment">// Really unused</font>
03548       apts[0].x = 0;
03549       apts[0].y = 0;
03550 
03551       emr.iType = EMR_POLYPOLYGON16;
03552       <font class="comment">// The (#-1)'s below are to account for aPolyCounts[0] and aptl[0], which</font>
03553       <font class="comment">// aren't directly written out</font>
03554       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYPOLYGON16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1)
03555         + <font class="keyword">sizeof</font>( DWORD ) * (nPolys-1);
03556 
03557       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03558 
03559       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03560         lcounts[i] = counts[i];
03561 
03562       lpoints = <font class="keyword">new</font> POINT16[cpts];
03563 
03564       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03565         lpoints[i].x = points[i].x;
03566         lpoints[i].y = points[i].y;
03567       }
03568 
03569       rclBounds = *bounds;
03570     }
<a name="l03574"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a2">03574</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a2">~EMRPOLYPOLYGON16</a> ( )<font class="keyword"></font>
03575 <font class="keyword">    </font>{
03576       <font class="keywordflow">if</font> ( lcounts ) <font class="keyword">delete</font>[] lcounts;
03577       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03578     }
<a name="l03583"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a3">03583</a>     <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a0">EMRPOLYPOLYGON16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03584 <font class="keyword">    </font>{
03585       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; nPolys &gt;&gt; cpts;
03586 
03587       lcounts = <font class="keyword">new</font> DWORD[nPolys];
03588 
03589       DWORDARRAY counts( lcounts, nPolys );
03590 
03591       ds &gt;&gt; counts;
03592 
03593       lpoints = <font class="keyword">new</font> POINT16[cpts];
03594 
03595       POINT16ARRAY points( lpoints, cpts );
03596 
03597       ds &gt;&gt; points;
03598     }
<a name="l03602"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a4">03602</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03603 <font class="keyword">    </font>{
03604       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; nPolys &lt;&lt; cpts &lt;&lt; DWORDARRAY( lcounts, nPolys )
03605          &lt;&lt; POINT16ARRAY( lpoints, cpts );
03606       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03607     }
<a name="l03611"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a5">03611</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03617"></a><a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a6">03617</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYPOLYGON16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03618 <font class="keyword">    </font>{
03619       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03620       <font class="comment">// (but DWORD and INT are not)</font>
03621       INT* counts = <font class="keyword">new</font> INT[nPolys];
03622       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; nPolys; i++ )
03623         counts[i] = lcounts[i];
03624 
03625       PolyPolygon16( dc, lpoints, counts, nPolys );
03626 
03627       <font class="keyword">delete</font>[] counts;
03628     }
03629 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03630 <font class="preprocessor"></font>
03633     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03634 <font class="keyword">    </font>{
03635       printf( <font class="stringliteral">"*POLYPOLYGON16*\n"</font> );
03636       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03637       printf( <font class="stringliteral">"\tnPolys\t\t: %ld\n"</font>, nPolys );
03638       printf( <font class="stringliteral">"\tcpts\t\t: %ld\n"</font>, cpts );
03639       printf( <font class="stringliteral">"\taPolyCounts\t: "</font> );
03640       <font class="keywordflow">if</font> ( nPolys &gt; 0 )
03641         printf( <font class="stringliteral">"%ld\n"</font>, lcounts[0] );
03642       <font class="keywordflow">else</font>
03643         puts( <font class="stringliteral">""</font> );
03644       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; nPolys; i++ )
03645         printf( <font class="stringliteral">"\t\t\t  %ld\n"</font>, lcounts[i] );
03646       printf( <font class="stringliteral">"\tapts\t\t: "</font> );
03647       <font class="keywordflow">if</font> ( cpts &gt; 0 )
03648         printf( <font class="stringliteral">"%d, %d\n"</font>, lpoints[0].x, lpoints[0].y );
03649       <font class="keywordflow">else</font>
03650         puts( <font class="stringliteral">""</font> );
03651       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; cpts; i++ )
03652         printf( <font class="stringliteral">"\t\t\t  %d, %d\n"</font>, lpoints[i].x, lpoints[i].y );
03653     }
03654 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03655   };
03656 
03658 
<a name="l03661"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html">03661</a>   <font class="keyword">class </font>EMRPOLYBEZIER : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER {
03662     POINTL* lpoints;
03663   <font class="keyword">public</font>:
<a name="l03669"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a0">03669</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a0">EMRPOLYBEZIER</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03670 <font class="keyword">    </font>{
03671       cptl = n;
03672       aptl[0].x = 0;            <font class="comment">// Really unused</font>
03673       aptl[0].y = 0;
03674 
03675       emr.iType = EMR_POLYBEZIER;
03676       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03677       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIER ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
03678 
03679       lpoints = <font class="keyword">new</font> POINTL[cptl];
03680 
03681       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03682         lpoints[i].x = points[i].x;
03683         lpoints[i].y = points[i].y;
03684       }
03685 
03686       rclBounds = *bounds;
03687     }
<a name="l03692"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a1">03692</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a0">EMRPOLYBEZIER</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03693 <font class="keyword">    </font>{
03694       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
03695 
03696       lpoints = <font class="keyword">new</font> POINTL[cptl];
03697 
03698       POINTLARRAY points( lpoints, cptl );
03699 
03700       ds &gt;&gt; points;
03701     }
<a name="l03705"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a2">03705</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a2">~EMRPOLYBEZIER</a> ( )<font class="keyword"></font>
03706 <font class="keyword">    </font>{
03707       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03708     }
<a name="l03712"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a3">03712</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03713 <font class="keyword">    </font>{
03714       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
03715       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03716     }
<a name="l03720"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a4">03720</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03726"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a5">03726</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03727 <font class="keyword">    </font>{
03728       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03729       PolyBezier( dc, (POINT*)lpoints, cptl );
03730     }
03731 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03732 <font class="preprocessor"></font>
03735     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03736 <font class="keyword">    </font>{
03737       printf( <font class="stringliteral">"*POLYBEZIER*\n"</font> );
03738       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03739 <font class="preprocessor">#if 0</font>
03740 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03741       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03742       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03743         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03744 <font class="preprocessor">#else</font>
03745 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03746 <font class="preprocessor">#endif</font>
03747 <font class="preprocessor"></font>    }
03748 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03749   };
03750 
03752 
<a name="l03755"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html">03755</a>   <font class="keyword">class </font>EMRPOLYBEZIER16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER16 {
03756     POINT16* lpoints;
03757   <font class="keyword">public</font>:
<a name="l03763"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">03763</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">EMRPOLYBEZIER16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
03764 <font class="keyword">    </font>{
03765       cpts = n;
03766       apts[0].x = 0;            <font class="comment">// Really unused</font>
03767       apts[0].y = 0;
03768 
03769       emr.iType = EMR_POLYBEZIER16;
03770       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03771       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIER16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03772 
03773       lpoints = <font class="keyword">new</font> POINT16[cpts];
03774 
03775       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03776         lpoints[i].x = points[i].x;
03777         lpoints[i].y = points[i].y;
03778       }
03779 
03780       rclBounds = *bounds;
03781     }
<a name="l03788"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a1">03788</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">EMRPOLYBEZIER16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03789 <font class="keyword">    </font>{
03790       cpts = n;
03791       apts[0].x = 0;            <font class="comment">// Really unused</font>
03792       apts[0].y = 0;
03793 
03794       emr.iType = EMR_POLYBEZIER16;
03795       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03796       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIER16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03797 
03798       lpoints = <font class="keyword">new</font> POINT16[cpts];
03799 
03800       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03801         lpoints[i].x = points[i].x;
03802         lpoints[i].y = points[i].y;
03803       }
03804 
03805       rclBounds = *bounds;
03806     }
<a name="l03811"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a2">03811</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a0">EMRPOLYBEZIER16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03812 <font class="keyword">    </font>{
03813       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
03814 
03815       lpoints = <font class="keyword">new</font> POINT16[cpts];
03816 
03817       POINT16ARRAY points( lpoints, cpts );
03818 
03819       ds &gt;&gt; points;
03820     }
<a name="l03824"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a3">03824</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a3">~EMRPOLYBEZIER16</a> ( )<font class="keyword"></font>
03825 <font class="keyword">    </font>{
03826       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03827     }
<a name="l03831"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a4">03831</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03832 <font class="keyword">    </font>{
03833       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
03834       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03835     }
<a name="l03839"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a5">03839</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03845"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a6">03845</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIER16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03846 <font class="keyword">    </font>{
03847       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03848       PolyBezier16( dc, lpoints, cpts );
03849     }
03850 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03851 <font class="preprocessor"></font>
03854     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03855 <font class="keyword">    </font>{
03856       printf( <font class="stringliteral">"*POLYBEZIER16*\n"</font> );
03857       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03858       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
03859     }
03860 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03861   };
03862 
03864 
<a name="l03867"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html">03867</a>   <font class="keyword">class </font>EMRPOLYBEZIERTO : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER {
03868     POINTL* lpoints;
03869   <font class="keyword">public</font>:
<a name="l03875"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a0">03875</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a0">EMRPOLYBEZIERTO</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03876 <font class="keyword">    </font>{
03877       cptl = n;
03878       aptl[0].x = 0;            <font class="comment">// Really unused</font>
03879       aptl[0].y = 0;
03880 
03881       emr.iType = EMR_POLYBEZIERTO;
03882       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03883       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIERTO ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
03884 
03885       lpoints = <font class="keyword">new</font> POINTL[cptl];
03886 
03887       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03888         lpoints[i].x = points[i].x;
03889         lpoints[i].y = points[i].y;
03890       }
03891 
03892       rclBounds = *bounds;
03893     }
<a name="l03898"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a1">03898</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a0">EMRPOLYBEZIERTO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
03899 <font class="keyword">    </font>{
03900       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
03901 
03902       lpoints = <font class="keyword">new</font> POINTL[cptl];
03903 
03904       POINTLARRAY points( lpoints, cptl );
03905 
03906       ds &gt;&gt; points;
03907     }
<a name="l03911"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a2">03911</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a2">~EMRPOLYBEZIERTO</a> ( )<font class="keyword"></font>
03912 <font class="keyword">    </font>{
03913       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
03914     }
<a name="l03918"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a3">03918</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
03919 <font class="keyword">    </font>{
03920       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
03921       <font class="keywordflow">return</font> <font class="keyword">true</font>;
03922     }
<a name="l03926"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a4">03926</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l03932"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a5">03932</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
03933 <font class="keyword">    </font>{
03934       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
03935       PolyBezierTo( dc, (POINT*)lpoints, cptl );
03936     }
03937 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
03938 <font class="preprocessor"></font>
03941     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
03942 <font class="keyword">    </font>{
03943       printf( <font class="stringliteral">"*POLYBEZIERTO*\n"</font> );
03944       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
03945 <font class="preprocessor">#if 0</font>
03946 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
03947       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
03948       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
03949         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
03950 <font class="preprocessor">#else</font>
03951 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
03952 <font class="preprocessor">#endif</font>
03953 <font class="preprocessor"></font>    }
03954 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
03955   };
03956 
03958 
<a name="l03961"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html">03961</a>   <font class="keyword">class </font>EMRPOLYBEZIERTO16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYBEZIER16 {
03962     POINT16* lpoints;
03963   <font class="keyword">public</font>:
<a name="l03969"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">03969</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">EMRPOLYBEZIERTO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
03970 <font class="keyword">    </font>{
03971       cpts = n;
03972       apts[0].x = 0;            <font class="comment">// Really unused</font>
03973       apts[0].y = 0;
03974 
03975       emr.iType = EMR_POLYBEZIERTO16;
03976       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
03977       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIERTO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
03978 
03979       lpoints = <font class="keyword">new</font> POINT16[cpts];
03980 
03981       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
03982         lpoints[i].x = points[i].x;
03983         lpoints[i].y = points[i].y;
03984       }
03985 
03986       rclBounds = *bounds;
03987     }
<a name="l03994"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a1">03994</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">EMRPOLYBEZIERTO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
03995 <font class="keyword">    </font>{
03996       cpts = n;
03997       apts[0].x = 0;            <font class="comment">// Really unused</font>
03998       apts[0].y = 0;
03999 
04000       emr.iType = EMR_POLYBEZIERTO16;
04001       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04002       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYBEZIERTO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
04003 
04004       lpoints = <font class="keyword">new</font> POINT16[cpts];
04005 
04006       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04007         lpoints[i].x = points[i].x;
04008         lpoints[i].y = points[i].y;
04009       }
04010 
04011       rclBounds = *bounds;
04012     }
<a name="l04017"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a2">04017</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a0">EMRPOLYBEZIERTO16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04018 <font class="keyword">    </font>{
04019       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
04020 
04021       lpoints = <font class="keyword">new</font> POINT16[cpts];
04022 
04023       POINT16ARRAY points( lpoints, cpts );
04024 
04025       ds &gt;&gt; points;
04026     }
<a name="l04030"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a3">04030</a>     <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a3">~EMRPOLYBEZIERTO16</a> ( )<font class="keyword"></font>
04031 <font class="keyword">    </font>{
04032       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
04033     }
<a name="l04037"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a4">04037</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04038 <font class="keyword">    </font>{
04039       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
04040       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04041     }
<a name="l04045"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a5">04045</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04051"></a><a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a6">04051</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYBEZIERTO16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04052 <font class="keyword">    </font>{
04053       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
04054       PolyBezierTo16( dc, lpoints, cpts );
04055     }
04056 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04057 <font class="preprocessor"></font>
04060     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04061 <font class="keyword">    </font>{
04062       printf( <font class="stringliteral">"*POLYBEZIERTO16*\n"</font> );
04063       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04064       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
04065     }
04066 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04067   };
04068 
04070 
<a name="l04073"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html">04073</a>   <font class="keyword">class </font>EMRPOLYLINETO : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINETO {
04074     POINTL* lpoints;
04075   <font class="keyword">public</font>:
<a name="l04081"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a0">04081</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a0">EMRPOLYLINETO</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
04082 <font class="keyword">    </font>{
04083       cptl = n;
04084       aptl[0].x = 0;
04085       aptl[0].y = 0;
04086 
04087       emr.iType = EMR_POLYLINETO;
04088       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04089       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINETO ) + <font class="keyword">sizeof</font>( POINTL ) * (cptl-1);
04090 
04091       lpoints = <font class="keyword">new</font> POINTL[cptl];
04092 
04093       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04094         lpoints[i].x = points[i].x;
04095         lpoints[i].y = points[i].y;
04096       }
04097 
04098       rclBounds = *bounds;
04099     }
<a name="l04104"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a1">04104</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a0">EMRPOLYLINETO</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04105 <font class="keyword">    </font>{
04106       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cptl;
04107 
04108       lpoints = <font class="keyword">new</font> POINTL[cptl];
04109 
04110       POINTLARRAY points( lpoints, cptl );
04111 
04112       ds &gt;&gt; points;
04113     }
<a name="l04117"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a2">04117</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a2">~EMRPOLYLINETO</a> ( )<font class="keyword"></font>
04118 <font class="keyword">    </font>{
04119       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
04120     }
<a name="l04124"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a3">04124</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04125 <font class="keyword">    </font>{
04126       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cptl &lt;&lt; POINTLARRAY( lpoints, cptl );
04127       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04128     }
<a name="l04132"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a4">04132</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04138"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a5">04138</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04139 <font class="keyword">    </font>{
04140       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
04141       PolylineTo( dc, (POINT*)lpoints, cptl );
04142     }
04143 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04144 <font class="preprocessor"></font>
04147     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04148 <font class="keyword">    </font>{
04149       printf( <font class="stringliteral">"*POLYLINETO*\n"</font> );
04150       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04151 <font class="preprocessor">#if 0</font>
04152 <font class="preprocessor"></font>      printf( <font class="stringliteral">"\tcptl              : %ld\n"</font>, cptl );
04153       printf( <font class="stringliteral">"\taptl-&gt;\n"</font> );
04154       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; cptl; i++ )
04155         printf( <font class="stringliteral">"\t\t%ld, %ld\n"</font>, lpoints[i].x, lpoints[i].y );
04156 <font class="preprocessor">#else</font>
04157 <font class="preprocessor"></font>      edit_pointlarray( <font class="stringliteral">"\t"</font>, cptl, lpoints );
04158 <font class="preprocessor">#endif</font>
04159 <font class="preprocessor"></font>    }
04160 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04161   };
04162 
04164 
<a name="l04167"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html">04167</a>   <font class="keyword">class </font>EMRPOLYLINETO16 : <font class="keyword">public</font> METARECORD, ::EMRPOLYLINETO16 {
04168     POINT16* lpoints;
04169   <font class="keyword">public</font>:
<a name="l04175"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">04175</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">EMRPOLYLINETO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT16* points, INT n )<font class="keyword"></font>
04176 <font class="keyword">    </font>{
04177       cpts = n;
04178       apts[0].x = 0;
04179       apts[0].y = 0;
04180 
04181       emr.iType = EMR_POLYLINETO16;
04182       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04183       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINETO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
04184 
04185       lpoints = <font class="keyword">new</font> POINT16[cpts];
04186 
04187       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04188         lpoints[i].x = points[i].x;
04189         lpoints[i].y = points[i].y;
04190       }
04191 
04192       rclBounds = *bounds;
04193     }
<a name="l04200"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a1">04200</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">EMRPOLYLINETO16</a> ( <font class="keyword">const</font> RECTL* bounds, <font class="keyword">const</font> POINT* points, INT n )<font class="keyword"></font>
04201 <font class="keyword">    </font>{
04202       cpts = n;
04203       apts[0].x = 0;
04204       apts[0].y = 0;
04205 
04206       emr.iType = EMR_POLYLINETO16;
04207       <font class="comment">// The (cptl-1) below is to account for aptl, which isn't written out</font>
04208       emr.nSize = <font class="keyword">sizeof</font>( ::EMRPOLYLINETO16 ) + <font class="keyword">sizeof</font>( POINT16 ) * (cpts-1);
04209 
04210       lpoints = <font class="keyword">new</font> POINT16[cpts];
04211 
04212       <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;n; i++) {
04213         lpoints[i].x = points[i].x;
04214         lpoints[i].y = points[i].y;
04215       }
04216 
04217       rclBounds = *bounds;
04218     }
<a name="l04223"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a2">04223</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a0">EMRPOLYLINETO16</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04224 <font class="keyword">    </font>{
04225       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; cpts;
04226 
04227       lpoints = <font class="keyword">new</font> POINT16[cpts];
04228 
04229       POINT16ARRAY points( lpoints, cpts );
04230 
04231       ds &gt;&gt; points;
04232     }
<a name="l04236"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a3">04236</a>     <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a3">~EMRPOLYLINETO16</a> ( )<font class="keyword"></font>
04237 <font class="keyword">    </font>{
04238       <font class="keywordflow">if</font> ( lpoints ) <font class="keyword">delete</font>[] lpoints;
04239     }
<a name="l04243"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a4">04243</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a4">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04244 <font class="keyword">    </font>{
04245       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; cpts &lt;&lt; POINT16ARRAY( lpoints, cpts );
04246       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04247     }
<a name="l04251"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a5">04251</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a5">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04257"></a><a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a6">04257</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRPOLYLINETO16.html#a6">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04258 <font class="keyword">    </font>{
04259       <font class="comment">// According to the wine windef.h header, POINT and POINTL are equivalent</font>
04260       PolylineTo16( dc, lpoints, cpts );
04261     }
04262 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04263 <font class="preprocessor"></font>
04266     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04267 <font class="keyword">    </font>{
04268       printf( <font class="stringliteral">"*POLYLINETO16*\n"</font> );
04269       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04270       edit_point16array( <font class="stringliteral">"\t"</font>, cpts, lpoints );
04271     }
04272 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04273   };
04274 
04276 
<a name="l04281"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html">04281</a>   <font class="keyword">class </font>EMREXTTEXTOUTA : <font class="keyword">public</font> METARECORD, ::EMREXTTEXTOUTA {
04282     PSTR string_a;
04283     <font class="keywordtype">int</font> string_size;
04284 
04285     INT* dx_i;
04286   <font class="keyword">public</font>:
<a name="l04296"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a0">04296</a>     <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a0">EMREXTTEXTOUTA</a> ( <font class="keyword">const</font> RECTL* bounds, DWORD graphicsMode, FLOAT xScale,
04297                      FLOAT yScale, <font class="keyword">const</font> PEMRTEXT text, LPCSTR string,
04298                      <font class="keyword">const</font> INT* dx )<font class="keyword"></font>
04299 <font class="keyword">    </font>{
04300       emr.iType = EMR_EXTTEXTOUTA;
04301       emr.nSize = <font class="keyword">sizeof</font>( ::EMREXTTEXTOUTA );
04302 
04303       rclBounds = *bounds;
04304 
04305       iGraphicsMode = graphicsMode;
04306       exScale = xScale;
04307       eyScale = yScale;
04308 
04309       emrtext = *text;
04310 
04311       string_size = ROUND_TO_LONG( emrtext.nChars );
04312 
04313       string_a = <font class="keyword">new</font> CHAR[ string_size ];
04314 
04315       memset( string_a, 0, <font class="keyword">sizeof</font>(CHAR) * string_size );
04316 
04317       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i=0; i&lt;emrtext.nChars; i++ )
04318         string_a[i] = *string++;
04319 
04320       emrtext.offString = emr.nSize;
04321       emr.nSize += string_size * <font class="keyword">sizeof</font>(CHAR);
04322 
04323       <font class="keywordflow">if</font> ( dx ) {
04324 
04325         dx_i = <font class="keyword">new</font> INT[ emrtext.nChars ];
04326 
04327         <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i=0; i&lt;emrtext.nChars; i++ )
04328           dx_i[i] = *dx++;
04329 
04330         emrtext.offDx = emr.nSize;
04331         emr.nSize += emrtext.nChars * <font class="keyword">sizeof</font>(INT);
04332       }
04333       <font class="keywordflow">else</font> {
04334         emrtext.offDx = 0;
04335         dx_i = 0;
04336       }
04337     }
<a name="l04342"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a1">04342</a>     <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a0">EMREXTTEXTOUTA</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04343 <font class="keyword">    </font>{
04344       ds &gt;&gt; emr &gt;&gt; rclBounds &gt;&gt; iGraphicsMode &gt;&gt; exScale &gt;&gt; eyScale &gt;&gt; emrtext;
04345 
04346       <font class="keywordflow">if</font> ( emrtext.offString != 0 ) {
04347         string_size = ROUND_TO_LONG( emrtext.nChars );
04348 
04349         string_a = <font class="keyword">new</font> CHAR[ string_size ];
04350 
04351         memset( string_a, 0, <font class="keyword">sizeof</font>(CHAR) * string_size );
04352 
04353         CHARSTR string( string_a, string_size );
04354 
04355         ds &gt;&gt; string;
04356       }
04357       <font class="keywordflow">else</font>
04358         string_a = 0;
04359 
04360       <font class="keywordflow">if</font> ( emrtext.offDx ) {
04361         dx_i = <font class="keyword">new</font> INT[ emrtext.nChars ];
04362 
04363         INTARRAY dx_is( dx_i, emrtext.nChars );
04364 
04365         ds &gt;&gt; dx_is;
04366       }
04367       <font class="keywordflow">else</font>
04368         dx_i = 0;
04369     }
<a name="l04374"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a2">04374</a>     <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a2">~EMREXTTEXTOUTA</a> ( )<font class="keyword"></font>
04375 <font class="keyword">    </font>{
04376       <font class="keywordflow">if</font> ( string_a ) <font class="keyword">delete</font>[] string_a;
04377       <font class="keywordflow">if</font> ( dx_i ) <font class="keyword">delete</font>[] dx_i;
04378     }
<a name="l04382"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a3">04382</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a3">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04383 <font class="keyword">    </font>{
04384       ds &lt;&lt; emr &lt;&lt; rclBounds &lt;&lt; iGraphicsMode &lt;&lt; exScale &lt;&lt; eyScale
04385          &lt;&lt; emrtext &lt;&lt; CHARSTR( string_a, string_size );
04386       <font class="keywordflow">if</font> ( dx_i )
04387         ds &lt;&lt; INTARRAY( dx_i, emrtext.nChars );
04388       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04389     }
<a name="l04393"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a4">04393</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a4">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04399"></a><a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a5">04399</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREXTTEXTOUTA.html#a5">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04400 <font class="keyword">    </font>{
04401       RECT rect;
04402       rect.left = emrtext.rcl.left;
04403       rect.top = emrtext.rcl.top;
04404       rect.right = emrtext.rcl.right;
04405       rect.bottom = emrtext.rcl.bottom;
04406 
04407       ExtTextOutA( dc, emrtext.ptlReference.x, emrtext.ptlReference.y,
04408                    emrtext.fOptions, &amp;rect, string_a, emrtext.nChars,
04409                    dx_i );
04410     }
04411 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04412 <font class="preprocessor"></font>
04415     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04416 <font class="keyword">    </font>{
04417       printf( <font class="stringliteral">"*EXTTEXTOUTA*\n"</font> );
04418       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04419       printf( <font class="stringliteral">"\tiGraphicsMode\t: "</font> );
04420       <font class="keywordflow">switch</font> ( iGraphicsMode ) {
04421       <font class="keywordflow">case</font> GM_COMPATIBLE: printf( <font class="stringliteral">"GM_COMPATIBLE\n"</font> ); <font class="keywordflow">break</font>;
04422       <font class="keywordflow">case</font> GM_ADVANCED: printf( <font class="stringliteral">"GM_ADVANCED\n"</font> ); <font class="keywordflow">break</font>;
04423       <font class="keywordflow">default</font>: printf( <font class="stringliteral">"unknown(%ld)\n"</font>, iGraphicsMode );
04424       }
04425       printf( <font class="stringliteral">"\texScale\t\t: %f\n"</font>, exScale );
04426       printf( <font class="stringliteral">"\teyScale\t\t: %f\n"</font>, eyScale );
04427       printf( <font class="stringliteral">"\tptlReference\t: (%ld,%ld)\n"</font>, emrtext.ptlReference.x,
04428               emrtext.ptlReference.y );
04429       printf( <font class="stringliteral">"\tnChars\t\t: %ld\n"</font>, emrtext.nChars );
04430       printf( <font class="stringliteral">"\toffString\t: %ld\n"</font>, emrtext.offString );
04431       printf( <font class="stringliteral">"\tfOptions\t: "</font> );
04432       <font class="keywordflow">if</font> ( emrtext.fOptions == 0 )
04433         printf( <font class="stringliteral">"None"</font> );
04434       <font class="keywordflow">else</font> {
04435         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_GRAYED ) {
04436           printf( <font class="stringliteral">"ETO_GRAYED"</font> );
04437           <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ~ETO_GRAYED )
04438             printf( <font class="stringliteral">" | "</font> );
04439         }
04440         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_OPAQUE ) {
04441           printf( <font class="stringliteral">"ETO_OPAQUE"</font> );
04442           <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ~(ETO_GRAYED | ETO_OPAQUE) )
04443             printf( <font class="stringliteral">" | "</font> );
04444         }
04445         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_CLIPPED ) {
04446           printf( <font class="stringliteral">"ETO_CLIPPED"</font> );
04447           <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ~(ETO_GRAYED | ETO_OPAQUE | ETO_CLIPPED ) )
04448             printf( <font class="stringliteral">" | "</font> );
04449         }
04450         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_GLYPH_INDEX ) {
04451           printf( <font class="stringliteral">"ETO_GLYPH_INDEX"</font> );
04452           <font class="keywordflow">if</font> ( emrtext.fOptions &amp;
04453                ~(ETO_GRAYED | ETO_OPAQUE | ETO_CLIPPED | ETO_GLYPH_INDEX) )
04454             printf( <font class="stringliteral">" | "</font> );
04455         }
04456         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_RTLREADING ) {
04457           printf( <font class="stringliteral">"ETO_RTLREADING"</font> );
04458           <font class="keywordflow">if</font> ( emrtext.fOptions &amp;
04459                ~(ETO_GRAYED | ETO_OPAQUE | ETO_CLIPPED | ETO_GLYPH_INDEX |
04460                  ETO_RTLREADING) )
04461             printf( <font class="stringliteral">" | "</font> );
04462         }
04463         <font class="keywordflow">if</font> ( emrtext.fOptions &amp; ETO_IGNORELANGUAGE )
04464           printf( <font class="stringliteral">"ETO_IGNORELANGUAGE"</font> );
04465       }
04466       printf( <font class="stringliteral">"\n"</font> );
04467       edit_rectl( <font class="stringliteral">"rcl\t"</font>, emrtext.rcl );
04468       printf( <font class="stringliteral">"\toffDx\t\t: %ld\n"</font>, emrtext.offDx );
04469       printf( <font class="stringliteral">"\tString:\n\t\t%s\n"</font>,  string_a );
04470 
04471       <font class="keywordflow">if</font> ( emrtext.offDx != 0 ) {
04472         printf( <font class="stringliteral">"\tOffsets:\n\t\t"</font> );
04473         <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0; i &lt; emrtext.nChars; i++ )
04474           printf( <font class="stringliteral">"%d "</font>, dx_i[i] );
04475         printf( <font class="stringliteral">"\n"</font> );
04476       }
04477     }
04478 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04479   };
04480 
04482 
<a name="l04485"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html">04485</a>   <font class="keyword">class </font>EMRSETPIXELV : <font class="keyword">public</font> METARECORD, ::EMRSETPIXELV {
04486   <font class="keyword">public</font>:
<a name="l04492"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a0">04492</a>     <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a0">EMRSETPIXELV</a> ( INT x, INT y, COLORREF color )<font class="keyword"></font>
04493 <font class="keyword">    </font>{
04494       emr.iType = EMR_SETPIXELV;
04495       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETPIXELV );
04496       ptlPixel.x = x;
04497       ptlPixel.y = y;
04498       crColor = color;
04499     }
<a name="l04504"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a1">04504</a>     <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a0">EMRSETPIXELV</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04505 <font class="keyword">    </font>{
04506       ds &gt;&gt; emr &gt;&gt; ptlPixel &gt;&gt; crColor;
04507     }
<a name="l04511"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a2">04511</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04512 <font class="keyword">    </font>{
04513       ds &lt;&lt; emr &lt;&lt; ptlPixel &lt;&lt; crColor;
04514       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04515     }
<a name="l04519"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a3">04519</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04525"></a><a class="code" href="classEMF_1_1EMRSETPIXELV.html#a4">04525</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETPIXELV.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04526 <font class="keyword">    </font>{
04527       SetPixel( dc, ptlPixel.x, ptlPixel.y, crColor );
04528     }
04529 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04530 <font class="preprocessor"></font>
04533     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04534 <font class="keyword">    </font>{
04535       printf( <font class="stringliteral">"*SETPIXELV*\n"</font> );
04536       edit_pointl( <font class="stringliteral">"ptlPixel"</font>, ptlPixel );
04537       edit_color( <font class="stringliteral">"crColor\t"</font>, crColor );
04538     }
04539 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04540   };
04541 
04542   <font class="keyword">class </font>PEN;
04543   <font class="keyword">class </font>EXTPEN;
04544   <font class="keyword">class </font>BRUSH;
04545   <font class="keyword">class </font>FONT;
04546   <font class="keyword">class </font>PALETTE;
04547 
04549 
<a name="l04552"></a><a class="code" href="classEMF_1_1EMRCREATEPEN.html">04552</a>   <font class="keyword">class </font>EMRCREATEPEN : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMRCREATEPEN
04553   {
04554   <font class="keyword">public</font>:
04559     <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a0">EMRCREATEPEN</a> ( PEN* pen, HGDIOBJ handle );
04564     <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a0">EMRCREATEPEN</a> ( DATASTREAM&amp; ds );
<a name="l04568"></a><a class="code" href="classEMF_1_1EMRCREATEPEN.html#a2">04568</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04569 <font class="keyword">    </font>{
04570       ds &lt;&lt; emr &lt;&lt; ihPen &lt;&lt; lopn;
04571       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04572     }
<a name="l04576"></a><a class="code" href="classEMF_1_1EMRCREATEPEN.html#a3">04576</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04582     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCREATEPEN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04583 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04584 <font class="preprocessor"></font>
04587     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04588 <font class="keyword">    </font>{
04589       printf( <font class="stringliteral">"*CREATEPEN*\n"</font> );
04590       printf( <font class="stringliteral">"\tihPen\t\t: 0x%lx\n"</font>, ihPen );
04591       edit_pen_style( <font class="stringliteral">"lopn.lopnStyle"</font>, lopn.lopnStyle );
04592       printf( <font class="stringliteral">"\tlopn.lopnWidth\t: %ld, %ld\n"</font>, lopn.lopnWidth.x, lopn.lopnWidth.y );
04593       edit_color( <font class="stringliteral">"lopn.lopnColor"</font>, lopn.lopnColor );
04594     }
04595 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04596   };
04597 
04599 
<a name="l04603"></a><a class="code" href="classEMF_1_1EMREXTCREATEPEN.html">04603</a>   <font class="keyword">class </font>EMREXTCREATEPEN : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMREXTCREATEPEN
04604   {
04605   <font class="keyword">public</font>:
04610     <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a0">EMREXTCREATEPEN</a> ( EXTPEN* pen, HGDIOBJ handle );
04615     <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a0">EMREXTCREATEPEN</a> ( DATASTREAM&amp; ds );
<a name="l04619"></a><a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a2">04619</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04620 <font class="keyword">    </font>{
04621       ds &lt;&lt; emr &lt;&lt; ihPen &lt;&lt; offBmi &lt;&lt; cbBmi &lt;&lt; offBits &lt;&lt; cbBits &lt;&lt; elp;
04622       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04623     }
<a name="l04627"></a><a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a3">04627</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04633     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREXTCREATEPEN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04634 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04635 <font class="preprocessor"></font>
04638     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04639 <font class="keyword">    </font>{
04640       printf( <font class="stringliteral">"*EXTCREATEPEN*\n"</font> );
04641       printf( <font class="stringliteral">"\tihPen\t\t\t: 0x%lx\n"</font>, ihPen );
04642       printf( <font class="stringliteral">"\toffBmi\t\t\t: %ld\n"</font>,  offBmi );
04643       printf( <font class="stringliteral">"\tcbBmi\t\t\t: %ld\n"</font>, cbBmi );
04644       printf( <font class="stringliteral">"\toffBits\t\t\t: %ld\n"</font>, offBits );
04645       printf( <font class="stringliteral">"\tcbBits\t\t\t: %ld\n"</font>, cbBits );
04646       edit_pen_style( <font class="stringliteral">"elp.elpPenStyle\t"</font>, elp.elpPenStyle );
04647       printf( <font class="stringliteral">"\telp.elpWidth\t\t: %ld\n"</font>, elp.elpWidth );
04648       edit_brush_style( <font class="stringliteral">"elp.elpBrushStyle"</font>, elp.elpBrushStyle );
04649       edit_color( <font class="stringliteral">"elp.elpColor\t"</font>, elp.elpColor );
04650       edit_brush_hatch( <font class="stringliteral">"elp.elpHatch\t"</font>, elp.elpHatch );
04651       printf( <font class="stringliteral">"\telp.elpNumEntries\t: %ld\n"</font>, elp.elpNumEntries );
04652     }
04653 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04654   };
04655 
04657 
<a name="l04660"></a><a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html">04660</a>   <font class="keyword">class </font>EMRCREATEBRUSHINDIRECT : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMRCREATEBRUSHINDIRECT
04661   {
04662   <font class="keyword">public</font>:
04667     <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a0">EMRCREATEBRUSHINDIRECT</a> ( BRUSH* brush, HGDIOBJ handle );
04672     <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a0">EMRCREATEBRUSHINDIRECT</a> ( DATASTREAM&amp; ds );
<a name="l04676"></a><a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a2">04676</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04677 <font class="keyword">    </font>{
04678       ds &lt;&lt; emr &lt;&lt; ihBrush &lt;&lt; lb;
04679       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04680     }
<a name="l04684"></a><a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a3">04684</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04690     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCREATEBRUSHINDIRECT.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04691 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04692 <font class="preprocessor"></font>
04695     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04696 <font class="keyword">    </font>{
04697       printf( <font class="stringliteral">"*CREATEBRUSHINDIRECT*\n"</font> );
04698       printf( <font class="stringliteral">"\tihBrush\t\t: 0x%lx\n"</font>, ihBrush );
04699       edit_brush_style( <font class="stringliteral">"lb.lbStyle"</font>, lb.lbStyle );
04700       edit_color( <font class="stringliteral">"lb.lbColor"</font>, lb.lbColor );
04701       edit_brush_hatch( <font class="stringliteral">"lb.lbHatch"</font>, lb.lbHatch );
04702     }
04703 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04704   };
04705 
04707 
<a name="l04710"></a><a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html">04710</a>   <font class="keyword">class </font>EMREXTCREATEFONTINDIRECTW : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMREXTCREATEFONTINDIRECTW
04711   {
04712   <font class="keyword">public</font>:
04717     <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a0">EMREXTCREATEFONTINDIRECTW</a> ( FONT* font, HGDIOBJ handle );
04722     <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a0">EMREXTCREATEFONTINDIRECTW</a> ( DATASTREAM&amp; ds );
<a name="l04726"></a><a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a2">04726</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04727 <font class="keyword">    </font>{
04728       <font class="comment">// Since EMF records have to be multiples of 4 bytes, this</font>
04729       <font class="comment">// should perhaps be a general thing, but we know it's currently</font>
04730       <font class="comment">// only a problem for this structure.</font>
04731 
04732       ds &lt;&lt; emr &lt;&lt; ihFont &lt;&lt; elfw &lt;&lt; PADDING( 2 );
04733 
04734       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04735     }
<a name="l04739"></a><a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a3">04739</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04745     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMREXTCREATEFONTINDIRECTW.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04746 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04747 <font class="preprocessor"></font>
04750     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04751 <font class="keyword">    </font>{
04752       printf( <font class="stringliteral">"*EXTCREATEFONTINDIRECTW*\n"</font> );
04753       printf( <font class="stringliteral">"\tihFont\t\t\t: %ld\n"</font>, ihFont );
04754       printf( <font class="stringliteral">"\tlfHeight\t\t: %ld\n"</font>, elfw.elfLogFont.lfHeight );
04755       printf( <font class="stringliteral">"\tlfWidth\t\t\t: %ld\n"</font>, elfw.elfLogFont.lfWidth );
04756       printf( <font class="stringliteral">"\tlfEscapement\t\t: %ld\n"</font>, elfw.elfLogFont.lfEscapement );
04757       printf( <font class="stringliteral">"\tlfOrientation\t\t: %ld\n"</font>, elfw.elfLogFont.lfOrientation );
04758       printf( <font class="stringliteral">"\tlfWeight\t\t: "</font> );
04759       <font class="keywordflow">switch</font> ( elfw.elfLogFont.lfWeight ) {
04760       <font class="keywordflow">case</font> FW_DONTCARE: printf( <font class="stringliteral">"FW_DONTCARE\n"</font> ); <font class="keywordflow">break</font>;
04761       <font class="keywordflow">case</font> FW_THIN: printf( <font class="stringliteral">"FW_THIN\n"</font> ); <font class="keywordflow">break</font>;
04762       <font class="keywordflow">case</font> FW_EXTRALIGHT: printf( <font class="stringliteral">"FW_EXTRALIGHT\n"</font> ); <font class="keywordflow">break</font>;
04763       <font class="keywordflow">case</font> FW_LIGHT: printf( <font class="stringliteral">"FW_LIGHT\n"</font> ); <font class="keywordflow">break</font>;
04764       <font class="keywordflow">case</font> FW_NORMAL: printf( <font class="stringliteral">"FW_NORMAL\n"</font> ); <font class="keywordflow">break</font>;
04765       <font class="keywordflow">case</font> FW_MEDIUM: printf( <font class="stringliteral">"FW_MEDIUM\n"</font> ); <font class="keywordflow">break</font>;
04766       <font class="keywordflow">case</font> FW_SEMIBOLD: printf( <font class="stringliteral">"FW_SEMIBOLD\n"</font> ); <font class="keywordflow">break</font>;
04767       <font class="keywordflow">case</font> FW_BOLD: printf( <font class="stringliteral">"FW_BOLD\n"</font> ); <font class="keywordflow">break</font>;
04768       <font class="keywordflow">case</font> FW_EXTRABOLD: printf( <font class="stringliteral">"FW_EXTRABOLD\n"</font> ); <font class="keywordflow">break</font>;
04769       <font class="keywordflow">case</font> FW_BLACK: printf( <font class="stringliteral">"FW_BLACK\n"</font> ); <font class="keywordflow">break</font>;
04770       }
04771       printf( <font class="stringliteral">"\tlfItalic\t\t: %d\n"</font>, elfw.elfLogFont.lfItalic );
04772       printf( <font class="stringliteral">"\tlfUnderline\t\t: %d\n"</font>, elfw.elfLogFont.lfUnderline );
04773       printf( <font class="stringliteral">"\tlfStrikeOut\t\t: %d\n"</font>, elfw.elfLogFont.lfStrikeOut );
04774       printf( <font class="stringliteral">"\tlfCharSet\t\t: %d\n"</font>, elfw.elfLogFont.lfCharSet );
04775       printf( <font class="stringliteral">"\tlfOutPrecision\t\t: %d\n"</font>, elfw.elfLogFont.lfOutPrecision );
04776       printf( <font class="stringliteral">"\tlfClipPrecision\t\t: %d\n"</font>, elfw.elfLogFont.lfClipPrecision );
04777       printf( <font class="stringliteral">"\tlfQuality\t\t: %d\n"</font>, elfw.elfLogFont.lfQuality );
04778       printf( <font class="stringliteral">"\tlfPitchAndFamily\t: %d\n"</font>, elfw.elfLogFont.lfPitchAndFamily );
04779       <font class="keywordtype">int</font> i = 0;
04780       printf( <font class="stringliteral">"\tlfFaceName\t\t: '"</font> );
04781       <font class="keywordflow">while</font> ( elfw.elfLogFont.lfFaceName[i] != 0 &amp;&amp; i &lt; LF_FACESIZE ) {
04782         putchar( elfw.elfLogFont.lfFaceName[i] );
04783         i++;
04784       }
04785       puts( <font class="stringliteral">"'"</font> );
04786 
04787       i = 0;
04788       printf( <font class="stringliteral">"\telfFullName\t\t: '"</font> );
04789       <font class="keywordflow">while</font> ( elfw.elfFullName[i] != 0 &amp;&amp; i &lt; LF_FULLFACESIZE ) {
04790         putchar( elfw.elfFullName[i] );
04791         i++;
04792       }
04793       puts( <font class="stringliteral">"'"</font> );
04794 
04795       i = 0;
04796       printf( <font class="stringliteral">"\telfStyle\t\t: '"</font> );
04797       <font class="keywordflow">while</font> ( elfw.elfStyle[i] != 0 &amp;&amp; i &lt; LF_FACESIZE ) {
04798         putchar( elfw.elfStyle[i] );
04799         i++;
04800       }
04801       puts( <font class="stringliteral">"'"</font> );
04802 
04803       printf( <font class="stringliteral">"\telfVersion\t\t: %ld\n"</font>, elfw.elfVersion );
04804       printf( <font class="stringliteral">"\telfStyleSize\t\t: %ld\n"</font>, elfw.elfStyleSize );
04805       printf( <font class="stringliteral">"\telfMatch\t\t: %ld\n"</font>, elfw.elfMatch );
04806       printf( <font class="stringliteral">"\telfVendorId\t\t: '%s'\n"</font>, elfw.elfVendorId );
04807       printf( <font class="stringliteral">"\telfCulture\t\t: %ld\n"</font>, elfw.elfCulture );
04808       printf( <font class="stringliteral">"\telfPanose\t\t:\n"</font> );
04809       printf( <font class="stringliteral">"\t\tbFamilyType\t\t: %d\n"</font>, elfw.elfPanose.bFamilyType );
04810       printf( <font class="stringliteral">"\t\tbSerifStyle\t\t: %d\n"</font>, elfw.elfPanose.bSerifStyle );
04811       printf( <font class="stringliteral">"\t\tbWeight\t\t\t: %d\n"</font>, elfw.elfPanose.bWeight );
04812       printf( <font class="stringliteral">"\t\tbProportion\t\t: %d\n"</font>, elfw.elfPanose.bProportion );
04813       printf( <font class="stringliteral">"\t\tbContrast\t\t: %d\n"</font>, elfw.elfPanose.bContrast );
04814       printf( <font class="stringliteral">"\t\tbStrokeVariation\t: %d\n"</font>, elfw.elfPanose.bStrokeVariation );
04815       printf( <font class="stringliteral">"\t\tbArmStyle\t\t: %d\n"</font>, elfw.elfPanose.bArmStyle );
04816       printf( <font class="stringliteral">"\t\tbLetterform\t\t: %d\n"</font>, elfw.elfPanose.bLetterform );
04817       printf( <font class="stringliteral">"\t\tbMidline\t\t: %d\n"</font>, elfw.elfPanose.bMidline );
04818       printf( <font class="stringliteral">"\t\tbXHeight\t\t: %d\n"</font>, elfw.elfPanose.bXHeight );
04819     }
04820 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04821   };
04822 
04824 
<a name="l04827"></a><a class="code" href="classEMF_1_1EMRCREATEPALETTE.html">04827</a>   <font class="keyword">class </font>EMRCREATEPALETTE : <font class="keyword">public</font> METARECORD, <font class="keyword">public</font> ::EMRCREATEPALETTE
04828   {
04829   <font class="keyword">public</font>:
04834     <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a0">EMRCREATEPALETTE</a> ( PALETTE* palette, HGDIOBJ handle );
04839     <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a0">EMRCREATEPALETTE</a> ( DATASTREAM&amp; ds );
<a name="l04843"></a><a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a2">04843</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04844 <font class="keyword">    </font>{
04845       ds &lt;&lt; emr &lt;&lt; ihPal &lt;&lt; lgpl;
04846       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04847     }
<a name="l04851"></a><a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a3">04851</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
04857     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCREATEPALETTE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* source, HDC dc ) <font class="keyword">const</font>;
04858 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04859 <font class="preprocessor"></font>
04862     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04863 <font class="keyword">    </font>{
04864       printf( <font class="stringliteral">"*CREATEPALETTE* (not really handled by libEMF)\n"</font> );
04865     }
04866 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04867   };
04868 
04870 
<a name="l04873"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html">04873</a>   <font class="keyword">class </font>EMRFILLPATH : <font class="keyword">public</font> METARECORD, ::EMRFILLPATH {
04874   <font class="keyword">public</font>:
<a name="l04879"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a0">04879</a>     <a class="code" href="classEMF_1_1EMRFILLPATH.html#a0">EMRFILLPATH</a> ( <font class="keyword">const</font> RECTL* bounds )<font class="keyword"></font>
04880 <font class="keyword">    </font>{
04881       emr.iType = EMR_FILLPATH;
04882       emr.nSize = <font class="keyword">sizeof</font>( ::EMRFILLPATH );
04883       rclBounds = *bounds;
04884     }
<a name="l04889"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a1">04889</a>     <a class="code" href="classEMF_1_1EMRFILLPATH.html#a0">EMRFILLPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04890 <font class="keyword">    </font>{
04891       ds &gt;&gt; emr &gt;&gt; rclBounds;
04892     }
<a name="l04896"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a2">04896</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRFILLPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04897 <font class="keyword">    </font>{
04898       ds &lt;&lt; emr &lt;&lt; rclBounds;
04899       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04900     }
<a name="l04904"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a3">04904</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRFILLPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04910"></a><a class="code" href="classEMF_1_1EMRFILLPATH.html#a4">04910</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRFILLPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04911 <font class="keyword">    </font>{
04912       FillPath( dc );
04913     }
04914 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04915 <font class="preprocessor"></font>
04918     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04919 <font class="keyword">    </font>{
04920       printf( <font class="stringliteral">"*FILLPATH*\n"</font> );
04921       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04922     }
04923 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04924   };
04926 
<a name="l04929"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html">04929</a>   <font class="keyword">class </font>EMRSTROKEPATH : <font class="keyword">public</font> METARECORD, ::EMRSTROKEPATH {
04930   <font class="keyword">public</font>:
<a name="l04935"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a0">04935</a>     <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a0">EMRSTROKEPATH</a> ( <font class="keyword">const</font> RECTL* bounds )<font class="keyword"></font>
04936 <font class="keyword">    </font>{
04937       emr.iType = EMR_STROKEPATH;
04938       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSTROKEPATH );
04939       rclBounds = *bounds;
04940     }
<a name="l04945"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a1">04945</a>     <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a0">EMRSTROKEPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
04946 <font class="keyword">    </font>{
04947       ds &gt;&gt; emr &gt;&gt; rclBounds;
04948     }
<a name="l04952"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a2">04952</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
04953 <font class="keyword">    </font>{
04954       ds &lt;&lt; emr &lt;&lt; rclBounds;
04955       <font class="keywordflow">return</font> <font class="keyword">true</font>;
04956     }
<a name="l04960"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a3">04960</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l04966"></a><a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a4">04966</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSTROKEPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
04967 <font class="keyword">    </font>{
04968       StrokePath( dc );
04969     }
04970 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
04971 <font class="preprocessor"></font>
04974     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
04975 <font class="keyword">    </font>{
04976       printf( <font class="stringliteral">"*STROKEPATH*\n"</font> );
04977       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
04978     }
04979 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
04980   };
04982 
<a name="l04985"></a><a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html">04985</a>   <font class="keyword">class </font>EMRSTROKEANDFILLPATH : <font class="keyword">public</font> METARECORD, ::EMRSTROKEANDFILLPATH {
04986   <font class="keyword">public</font>:
<a name="l04991"></a><a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a0">04991</a>     <a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a0">EMRSTROKEANDFILLPATH</a> ( <font class="keyword">const</font> RECTL* bounds )<font class="keyword"></font>
04992 <font class="keyword">    </font>{
04993       emr.iType = EMR_STROKEANDFILLPATH;
04994       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSTROKEANDFILLPATH );
04995       rclBounds = *bounds;
04996     }
<a name="l05001"></a><a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a1">05001</a>     <a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a0">EMRSTROKEANDFILLPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05002 <font class="keyword">    </font>{
05003       ds &gt;&gt; emr &gt;&gt; rclBounds;
05004     }
<a name="l05008"></a><a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a2">05008</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05009 <font class="keyword">    </font>{
05010       ds &lt;&lt; emr &lt;&lt; rclBounds;
05011       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05012     }
<a name="l05016"></a><a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a3">05016</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05022"></a><a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a4">05022</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSTROKEANDFILLPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05023 <font class="keyword">    </font>{
05024       StrokeAndFillPath( dc );
05025     }
05026 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05027 <font class="preprocessor"></font>
05030     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05031 <font class="keyword">    </font>{
05032       printf( <font class="stringliteral">"*STROKEANDFILLPATH*\n"</font> );
05033       edit_rectl( <font class="stringliteral">"rclBounds"</font>, rclBounds );
05034     }
05035 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05036   };
05038 
<a name="l05041"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html">05041</a>   <font class="keyword">class </font>EMRBEGINPATH : <font class="keyword">public</font> METARECORD, ::EMRBEGINPATH {
05042   <font class="keyword">public</font>:
<a name="l05046"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a0">05046</a>     <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a0">EMRBEGINPATH</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05047 <font class="keyword">    </font>{
05048       emr.iType = EMR_BEGINPATH;
05049       emr.nSize = <font class="keyword">sizeof</font>( ::EMRBEGINPATH );
05050     }
<a name="l05055"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a1">05055</a>     <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a0">EMRBEGINPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05056 <font class="keyword">    </font>{
05057       ds &gt;&gt; emr;
05058     }
<a name="l05062"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a2">05062</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05063 <font class="keyword">    </font>{
05064       ds &lt;&lt; emr;
05065       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05066     }
<a name="l05070"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a3">05070</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05076"></a><a class="code" href="classEMF_1_1EMRBEGINPATH.html#a4">05076</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRBEGINPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05077 <font class="keyword">    </font>{
05078       BeginPath( dc );
05079     }
05080 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05081 <font class="preprocessor"></font>
05084     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05085 <font class="keyword">    </font>{
05086       printf( <font class="stringliteral">"*BEGINPATH*\n"</font> );
05087     }
05088 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05089   };
05091 
<a name="l05094"></a><a class="code" href="classEMF_1_1EMRENDPATH.html">05094</a>   <font class="keyword">class </font>EMRENDPATH : <font class="keyword">public</font> METARECORD, ::EMRENDPATH {
05095   <font class="keyword">public</font>:
<a name="l05099"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a0">05099</a>     <a class="code" href="classEMF_1_1EMRENDPATH.html#a0">EMRENDPATH</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05100 <font class="keyword">    </font>{
05101       emr.iType = EMR_ENDPATH;
05102       emr.nSize = <font class="keyword">sizeof</font>( ::EMRENDPATH );
05103     }
<a name="l05108"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a1">05108</a>     <a class="code" href="classEMF_1_1EMRENDPATH.html#a0">EMRENDPATH</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05109 <font class="keyword">    </font>{
05110       ds &gt;&gt; emr;
05111     }
<a name="l05115"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a2">05115</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRENDPATH.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05116 <font class="keyword">    </font>{
05117       ds &lt;&lt; emr;
05118       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05119     }
<a name="l05123"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a3">05123</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRENDPATH.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05129"></a><a class="code" href="classEMF_1_1EMRENDPATH.html#a4">05129</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRENDPATH.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05130 <font class="keyword">    </font>{
05131       EndPath( dc );
05132     }
05133 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05134 <font class="preprocessor"></font>
05137     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05138 <font class="keyword">    </font>{
05139       printf( <font class="stringliteral">"*ENDPATH*\n"</font> );
05140     }
05141 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05142   };
05144 
<a name="l05147"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html">05147</a>   <font class="keyword">class </font>EMRCLOSEFIGURE : <font class="keyword">public</font> METARECORD, ::EMRCLOSEFIGURE {
05148   <font class="keyword">public</font>:
<a name="l05152"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a0">05152</a>     <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a0">EMRCLOSEFIGURE</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05153 <font class="keyword">    </font>{
05154       emr.iType = EMR_CLOSEFIGURE;
05155       emr.nSize = <font class="keyword">sizeof</font>( ::EMRCLOSEFIGURE );
05156     }
<a name="l05161"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a1">05161</a>     <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a0">EMRCLOSEFIGURE</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05162 <font class="keyword">    </font>{
05163       ds &gt;&gt; emr;
05164     }
<a name="l05168"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a2">05168</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05169 <font class="keyword">    </font>{
05170       ds &lt;&lt; emr;
05171       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05172     }
<a name="l05176"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a3">05176</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05182"></a><a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a4">05182</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRCLOSEFIGURE.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05183 <font class="keyword">    </font>{
05184       CloseFigure( dc );
05185     }
05186 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05187 <font class="preprocessor"></font>
05190     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05191 <font class="keyword">    </font>{
05192       printf( <font class="stringliteral">"*CLOSEFIGURE*\n"</font> );
05193     }
05194 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05195   };
05197 
<a name="l05201"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html">05201</a>   <font class="keyword">class </font>EMRSAVEDC : <font class="keyword">public</font> METARECORD, ::EMRSAVEDC {
05202   <font class="keyword">public</font>:
<a name="l05206"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a0">05206</a>     <a class="code" href="classEMF_1_1EMRSAVEDC.html#a0">EMRSAVEDC</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05207 <font class="keyword">    </font>{
05208       emr.iType = EMR_SAVEDC;
05209       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSAVEDC );
05210     }
<a name="l05215"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a1">05215</a>     <a class="code" href="classEMF_1_1EMRSAVEDC.html#a0">EMRSAVEDC</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05216 <font class="keyword">    </font>{
05217       ds &gt;&gt; emr;
05218     }
<a name="l05222"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a2">05222</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSAVEDC.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05223 <font class="keyword">    </font>{
05224       ds &lt;&lt; emr;
05225       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05226     }
<a name="l05230"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a3">05230</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSAVEDC.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05236"></a><a class="code" href="classEMF_1_1EMRSAVEDC.html#a4">05236</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSAVEDC.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05237 <font class="keyword">    </font>{
05238       SaveDC( dc );
05239     }
05240 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05241 <font class="preprocessor"></font>
05244     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05245 <font class="keyword">    </font>{
05246       printf( <font class="stringliteral">"*SAVEDC*\n"</font> );
05247     }
05248 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05249   };
05251 
<a name="l05254"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html">05254</a>   <font class="keyword">class </font>EMRRESTOREDC : <font class="keyword">public</font> METARECORD, ::EMRRESTOREDC {
05255   <font class="keyword">public</font>:
<a name="l05259"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a0">05259</a>     <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a0">EMRRESTOREDC</a> ( INT n )<font class="keyword"></font>
05260 <font class="keyword">    </font>{
05261       emr.iType = EMR_RESTOREDC;
05262       emr.nSize = <font class="keyword">sizeof</font>( ::EMRRESTOREDC );
05263       iRelative = n;
05264     }
<a name="l05269"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a1">05269</a>     <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a0">EMRRESTOREDC</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05270 <font class="keyword">    </font>{
05271       ds &gt;&gt; emr &gt;&gt; iRelative;
05272     }
<a name="l05276"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a2">05276</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05277 <font class="keyword">    </font>{
05278       ds &lt;&lt; emr &lt;&lt; iRelative;
05279       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05280     }
<a name="l05284"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a3">05284</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05290"></a><a class="code" href="classEMF_1_1EMRRESTOREDC.html#a4">05290</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRRESTOREDC.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05291 <font class="keyword">    </font>{
05292       RestoreDC( dc, iRelative );
05293     }
05294 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05295 <font class="preprocessor"></font>
05298     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05299 <font class="keyword">    </font>{
05300       printf( <font class="stringliteral">"*RESTOREDC*\n"</font> );
05301       printf( <font class="stringliteral">"\tiRelative: %ld\n"</font>, iRelative );
05302     }
05303 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05304   };
05306 
<a name="l05309"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html">05309</a>   <font class="keyword">class </font>EMRSETMETARGN : <font class="keyword">public</font> METARECORD, ::EMRSETMETARGN {
05310   <font class="keyword">public</font>:
<a name="l05314"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a0">05314</a>     <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a0">EMRSETMETARGN</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05315 <font class="keyword">    </font>{
05316       emr.iType = EMR_SETMETARGN;
05317       emr.nSize = <font class="keyword">sizeof</font>( ::EMRSETMETARGN );
05318     }
<a name="l05323"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a1">05323</a>     <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a0">EMRSETMETARGN</a> ( DATASTREAM&amp; ds )<font class="keyword"></font>
05324 <font class="keyword">    </font>{
05325       ds &gt;&gt; emr;
05326     }
<a name="l05330"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a2">05330</a>     <font class="keywordtype">bool</font> <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a2">serialize</a> ( DATASTREAM ds )<font class="keyword"></font>
05331 <font class="keyword">    </font>{
05332       ds &lt;&lt; emr;
05333       <font class="keywordflow">return</font> <font class="keyword">true</font>;
05334     }
<a name="l05338"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a3">05338</a>     <font class="keywordtype">int</font> <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a3">size</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> emr.nSize; }
<a name="l05344"></a><a class="code" href="classEMF_1_1EMRSETMETARGN.html#a4">05344</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1EMRSETMETARGN.html#a4">execute</a> ( METAFILEDEVICECONTEXT* <font class="comment">/*source*/</font>, HDC dc )<font class="keyword"> const</font>
05345 <font class="keyword">    </font>{
05346       SetMetaRgn( dc );
05347     }
05348 <font class="preprocessor">#ifdef ENABLE_EDITING</font>
05349 <font class="preprocessor"></font>
05352     <font class="keywordtype">void</font> edit ( <font class="keywordtype">void</font> )<font class="keyword"> const</font>
05353 <font class="keyword">    </font>{
05354       printf( <font class="stringliteral">"*SETMETARGN*\n"</font> );
05355     }
05356 <font class="preprocessor">#endif </font><font class="comment">/* ENABLE_EDITING */</font>
05357   };
05358 
05360 
<a name="l05363"></a><a class="code" href="classEMF_1_1PEN.html">05363</a>   <font class="keyword">class </font>PEN : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> LOGPEN {
05364   <font class="keyword">public</font>:
<a name="l05368"></a><a class="code" href="classEMF_1_1PEN.html#a0">05368</a>     <a class="code" href="classEMF_1_1PEN.html#a0">PEN</a> ( <font class="keyword">const</font> LOGPEN* lpen )<font class="keyword"></font>
05369 <font class="keyword">    </font>{
05370       lopnStyle = lpen-&gt;lopnStyle;
05371       lopnWidth = lpen-&gt;lopnWidth;
05372       lopnColor = lpen-&gt;lopnColor;
05373     }
<a name="l05377"></a><a class="code" href="classEMF_1_1PEN.html#a1">05377</a>     OBJECTTYPE <a class="code" href="classEMF_1_1PEN.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_PEN; }
<a name="l05384"></a><a class="code" href="classEMF_1_1PEN.html#a2">05384</a>     METARECORD* <a class="code" href="classEMF_1_1PEN.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05385 <font class="keyword">    </font>{
05386       contexts[dc] = emf_handle;
05387       <font class="keywordflow">return</font> <font class="keyword">new</font> EMRCREATEPEN( <font class="keyword">this</font>, emf_handle );
05388     }
05389   };
05390 
05392 
<a name="l05395"></a><a class="code" href="classEMF_1_1EXTPEN.html">05395</a>   <font class="keyword">class </font>EXTPEN : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> EXTLOGPEN {
05396   <font class="keyword">public</font>:
<a name="l05400"></a><a class="code" href="classEMF_1_1EXTPEN.html#a0">05400</a>     <a class="code" href="classEMF_1_1EXTPEN.html#a0">EXTPEN</a> ( <font class="keyword">const</font> EXTLOGPEN* lpen )<font class="keyword"></font>
05401 <font class="keyword">    </font>{
05402       elpPenStyle = lpen-&gt;elpPenStyle;
05403       elpWidth = lpen-&gt;elpWidth;
05404       elpBrushStyle = lpen-&gt;elpBrushStyle;
05405       elpColor = lpen-&gt;elpColor;
05406       elpHatch = lpen-&gt;elpHatch;
05407       elpNumEntries = 0;
05408       elpStyleEntry[0] = 0;
05409     }
<a name="l05413"></a><a class="code" href="classEMF_1_1EXTPEN.html#a1">05413</a>     OBJECTTYPE <a class="code" href="classEMF_1_1EXTPEN.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_EXTPEN; }
<a name="l05420"></a><a class="code" href="classEMF_1_1EXTPEN.html#a2">05420</a>     METARECORD* <a class="code" href="classEMF_1_1EXTPEN.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05421 <font class="keyword">    </font>{
05422       contexts[dc] = emf_handle;
05423       <font class="keywordflow">return</font> <font class="keyword">new</font> EMREXTCREATEPEN( <font class="keyword">this</font>, emf_handle );
05424     }
05425   };
05426 
05428 
<a name="l05431"></a><a class="code" href="classEMF_1_1BRUSH.html">05431</a>   <font class="keyword">class </font>BRUSH : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> LOGBRUSH {
05432   <font class="keyword">public</font>:
<a name="l05436"></a><a class="code" href="classEMF_1_1BRUSH.html#a0">05436</a>     <a class="code" href="classEMF_1_1BRUSH.html#a0">BRUSH</a> ( <font class="keyword">const</font> LOGBRUSH* lbrush )<font class="keyword"></font>
05437 <font class="keyword">    </font>{
05438       lbStyle = lbrush-&gt;lbStyle;
05439       lbColor = lbrush-&gt;lbColor;
05440       lbHatch = lbrush-&gt;lbHatch;
05441     }
<a name="l05445"></a><a class="code" href="classEMF_1_1BRUSH.html#a1">05445</a>     OBJECTTYPE <a class="code" href="classEMF_1_1BRUSH.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_BRUSH; }
<a name="l05452"></a><a class="code" href="classEMF_1_1BRUSH.html#a2">05452</a>     METARECORD* <a class="code" href="classEMF_1_1BRUSH.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05453 <font class="keyword">    </font>{
05454       contexts[dc] = emf_handle;
05455       <font class="keywordflow">return</font> <font class="keyword">new</font> EMRCREATEBRUSHINDIRECT( <font class="keyword">this</font>, emf_handle );
05456     }
05457   };
05458 
05460 
<a name="l05463"></a><a class="code" href="classEMF_1_1FONT.html">05463</a>   <font class="keyword">class </font>FONT : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> EXTLOGFONTW {
05464   <font class="keyword">public</font>:
<a name="l05468"></a><a class="code" href="classEMF_1_1FONT.html#a0">05468</a>     <a class="code" href="classEMF_1_1FONT.html#a0">FONT</a> ( <font class="keyword">const</font> LOGFONTW* lfont )<font class="keyword"></font>
05469 <font class="keyword">    </font>{
05470       this-&gt;elfLogFont = *lfont;
05471       <font class="comment">// There are a lot more entries in the EXTLOGFONTW structure than</font>
05472       <font class="comment">// the API has values for, so we invent them here</font>
05473       memset( &amp;elfFullName, 0, <font class="keyword">sizeof</font> elfFullName );
05474       memset( &amp;elfStyle, 0, <font class="keyword">sizeof</font> elfStyle );
05475       elfVersion = ELF_VERSION;
05476       elfStyleSize = 0;
05477       elfMatch = 0;
05478       elfReserved = 0;
05479       memset( &amp;elfVendorId, 0, <font class="keyword">sizeof</font> elfVendorId );
05480       elfCulture = ELF_CULTURE_LATIN;
05481       memset( &amp;elfPanose, 1, <font class="keyword">sizeof</font>(PANOSE) );
05482     }
<a name="l05486"></a><a class="code" href="classEMF_1_1FONT.html#a1">05486</a>     OBJECTTYPE <a class="code" href="classEMF_1_1FONT.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_FONT; }
<a name="l05493"></a><a class="code" href="classEMF_1_1FONT.html#a2">05493</a>     METARECORD* <a class="code" href="classEMF_1_1FONT.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05494 <font class="keyword">    </font>{
05495       contexts[dc] = emf_handle;
05496       <font class="keywordflow">return</font> <font class="keyword">new</font> EMREXTCREATEFONTINDIRECTW( <font class="keyword">this</font>, emf_handle );
05497     }
05498   };
05499 
05501 
<a name="l05504"></a><a class="code" href="classEMF_1_1PALETTE.html">05504</a>   <font class="keyword">class </font>PALETTE : <font class="keyword">public</font> GRAPHICSOBJECT, <font class="keyword">public</font> LOGPALETTE {
05505   <font class="keyword">public</font>:
<a name="l05509"></a><a class="code" href="classEMF_1_1PALETTE.html#a0">05509</a>     <a class="code" href="classEMF_1_1PALETTE.html#a0">PALETTE</a> ( <font class="keyword">const</font> LOGPALETTE* lpalette )<font class="keyword"></font>
05510 <font class="keyword">    </font>{
05511       (<font class="keywordtype">void</font>)lpalette;
05512       palVersion = 0;
05513       palNumEntries = 0;
05514       PALETTEENTRY zero_entry = { 0, 0, 0, 0 };
05515       palPalEntry[0] = zero_entry;
05516     }
<a name="l05520"></a><a class="code" href="classEMF_1_1PALETTE.html#a1">05520</a>     OBJECTTYPE <a class="code" href="classEMF_1_1PALETTE.html#a1">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_PALETTE; }
<a name="l05527"></a><a class="code" href="classEMF_1_1PALETTE.html#a2">05527</a>     METARECORD* <a class="code" href="classEMF_1_1PALETTE.html#a2">newEMR</a> ( HDC dc, HGDIOBJ emf_handle )<font class="keyword"></font>
05528 <font class="keyword">    </font>{
05529       contexts[dc] = emf_handle;
05530       <font class="keywordflow">return</font> <font class="keyword">new</font> EMRCREATEPALETTE( <font class="keyword">this</font>, emf_handle );
05531     }
05532   };
05533 
05535 
<a name="l05541"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html">05541</a>   <font class="keyword">class </font>METAFILEDEVICECONTEXT : <font class="keyword">public</font> OBJECT {
05549     <font class="keywordtype">void</font> init ( <font class="keyword">const</font> RECT* size, LPCWSTR description_w )<font class="keyword"> </font>{
05550 
05551       <font class="comment">// Evidently, metafile handles are numbered from 1, so don't</font>
05552       <font class="comment">// ever use 0.</font>
05553 
05554       handles.push_back( <font class="keyword">true</font> );
05555 
05556       <font class="comment">// Keep some of our graphics state in a header record</font>
05557 
05558       header = <font class="keyword">new</font> ENHMETAHEADER ( description_w );
05559       records.push_back( header );
05560 
05561       <font class="comment">// Compute the size and position of the metafile on the "page"</font>
05562 
05563       <font class="keywordflow">if</font> ( size ) {
05564         update_frame = <font class="keyword">false</font>;
05565 
05566         header-&gt;rclFrame.left = size-&gt;left;
05567         header-&gt;rclFrame.top = size-&gt;top;
05568         header-&gt;rclFrame.right = size-&gt;right;
05569         header-&gt;rclFrame.bottom = size-&gt;bottom;
05570 
05571         header-&gt;rclBounds.left =
05572           size-&gt;left * header-&gt;szlDevice.cx / ( header-&gt;szlMillimeters.cx * 100 );
05573         header-&gt;rclBounds.top =
05574           size-&gt;top * header-&gt;szlDevice.cy / ( header-&gt;szlMillimeters.cy * 100 );
05575         header-&gt;rclBounds.right =
05576           size-&gt;right * header-&gt;szlDevice.cx / ( header-&gt;szlMillimeters.cx * 100 );
05577         header-&gt;rclBounds.bottom =
05578           size-&gt;bottom * header-&gt;szlDevice.cy / ( header-&gt;szlMillimeters.cy * 100 );
05579       }
05580       <font class="keywordflow">else</font> {
05581         update_frame = <font class="keyword">true</font>;
05582 
05583         header-&gt;rclBounds.left = -10;
05584         header-&gt;rclBounds.top = -10;
05585         header-&gt;rclBounds.right = 10;
05586         header-&gt;rclBounds.bottom = 10;
05587 
05588         header-&gt;rclFrame.left = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.left *
05589           header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05590         header-&gt;rclFrame.top = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.top *
05591           header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05592         header-&gt;rclFrame.right = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.right *
05593           header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05594         header-&gt;rclFrame.bottom = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.bottom *
05595           header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05596       }
05597 
05598       <font class="comment">// Some default graphics state (are they really, though?)</font>
05599 
05600       SIZEL default_resolution = { RESOLUTION, RESOLUTION };
05601       resolution = default_resolution;
05602       SIZEL default_viewport_ext = { 1, 1 };
05603       viewport_ext = default_viewport_ext;
05604       POINT default_viewport_org = { 0, 0 };
05605       viewport_org = default_viewport_org;
05606       SIZEL default_window_ext = { 1, 1 };
05607       window_ext = default_window_ext;
05608       POINT default_window_org = { 0, 0 };
05609       window_org = default_window_org;
05610 
05611       min_device_point = viewport_org;
05612       max_device_point = viewport_org;
05613 
05614       pen = (PEN*)globalObjects.find( BLACK_PEN | ENHMETA_STOCK_OBJECT );
05615       brush = (BRUSH*)globalObjects.find( BLACK_BRUSH | ENHMETA_STOCK_OBJECT );
05616       font = (FONT*)globalObjects.find( DEVICE_DEFAULT_FONT | ENHMETA_STOCK_OBJECT);
05617       palette = (PALETTE*)globalObjects.find( DEFAULT_PALETTE|ENHMETA_STOCK_OBJECT);
05618 
05619       text_alignment = TA_BASELINE;
05620       text_color = RGB(0,0,0);
05621       bk_color = RGB(0xff,0xff,0xff);
05622       bk_mode = OPAQUE;
05623       polyfill_mode = ALTERNATE;
05624       map_mode = MM_TEXT;
05625 
05626       handle = globalObjects.add( <font class="keyword">this</font> );
05627     }
05628 
05629   <font class="keyword">public</font>:
<a name="l05633"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m0">05633</a>     ::FILE* fp;
<a name="l05638"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m1">05638</a>     DATASTREAM ds;
<a name="l05642"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m2">05642</a>     ENHMETAHEADER* header;
<a name="l05646"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m3">05646</a>     std::vector&lt; EMF::METARECORD* &gt; records;
05647 
05648     <font class="comment">// Keep a small set of graphics state information</font>
<a name="l05649"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m4">05649</a>     SIZEL resolution;           
<a name="l05650"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m5">05650</a>     SIZEL viewport_ext;         
<a name="l05651"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m6">05651</a>     POINT viewport_org;         
<a name="l05652"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m7">05652</a>     SIZEL window_ext;           
<a name="l05653"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m8">05653</a>     POINT window_org;           
<a name="l05654"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m9">05654</a>     <font class="keywordtype">bool</font> update_frame;          
<a name="l05655"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m10">05655</a>     POINT min_device_point;     
<a name="l05656"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m11">05656</a>     POINT max_device_point;     
<a name="l05657"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m12">05657</a>     POINT point;                
<a name="l05658"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m13">05658</a>     PEN* pen;                   
<a name="l05659"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m14">05659</a>     BRUSH* brush;               
<a name="l05660"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m15">05660</a>     FONT* font;                 
<a name="l05661"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m16">05661</a>     PALETTE* palette;           
<a name="l05662"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m17">05662</a>     UINT text_alignment;        
<a name="l05663"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m18">05663</a>     COLORREF text_color;        
<a name="l05664"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m19">05664</a>     COLORREF bk_color;          
<a name="l05665"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m20">05665</a>     INT bk_mode;                
<a name="l05666"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m21">05666</a>     INT polyfill_mode;          
<a name="l05667"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m22">05667</a>     INT map_mode;               
05668 
<a name="l05674"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m23">05674</a>     std::vector&lt; bool &gt; handles;
05675 
<a name="l05681"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#m24">05681</a>     std::map&lt; HGDIOBJ, HGDIOBJ &gt; emf_handles;
05682 
<a name="l05693"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a0">05693</a>       <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a0">METAFILEDEVICECONTEXT</a> ( FILE* fp_, <font class="keyword">const</font> RECT* size,
05694                               LPCWSTR description_w )
05695         : fp(fp_), ds( fp_ )
05696     {
05697           init( size, description_w );
05698     }
<a name="l05703"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a1">05703</a>     <font class="keyword">virtual</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a1">~METAFILEDEVICECONTEXT</a> ( )<font class="keyword"></font>
05704 <font class="keyword">    </font>{
05705       <font class="comment">// Purge all the metarecords (if there are any) {this include the</font>
05706       <font class="comment">// header record, too}</font>
05707       <font class="keywordflow">if</font> ( records.<a class="code" href="classEMF_1_1METARECORD.html#a2">size</a>() &gt; 0 )
05708         <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a7">deleteMetafile</a>();
05709     }
<a name="l05713"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a2">05713</a>     OBJECTTYPE <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a2">getType</a> ( <font class="keywordtype">void</font> )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> O_METAFILEDEVICECONTEXT; }
<a name="l05718"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a3">05718</a>     DWORD <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a3">nextHandle</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05719 <font class="keyword">    </font>{
05720       <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 1; i &lt; handles.size(); i++ ) {
05721         <font class="keywordflow">if</font> ( !handles[i] ) {
05722           handles[i] = <font class="keyword">true</font>;
05723           <font class="keywordflow">return</font> i;
05724         }
05725       }
05726       handles.push_back( <font class="keyword">true</font> );
05727       <font class="comment">// Well, it appears that even StockObject handles count for something.</font>
05728       <font class="comment">// Not sure what the right value here is, then.</font>
05729       header-&gt;nHandles = handles.size();
05730       <font class="keywordflow">return</font> handles.size()-1;
05731     }
<a name="l05735"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a4">05735</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a4">clearHandle</a> ( DWORD handle )<font class="keyword"></font>
05736 <font class="keyword">    </font>{
05737       handles[handle] = <font class="keyword">false</font>;
05738     }
<a name="l05744"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a5">05744</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a5">appendRecord</a> ( METARECORD* record )<font class="keyword"></font>
05745 <font class="keyword">    </font>{
05746       records.push_back( record );
05747 
05748       header-&gt;nBytes += record-&gt;size();
05749       header-&gt;nRecords++;
05750     }
<a name="l05756"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a6">05756</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a6">appendHandle</a> ( METARECORD* record )<font class="keyword"></font>
05757 <font class="keyword">    </font>{
05758       records.push_back( record );
05759 
05760       header-&gt;nBytes += record-&gt;size();
05761       header-&gt;nRecords++;
05762     }
<a name="l05767"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a7">05767</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a7">deleteMetafile</a> ( <font class="keywordtype">void</font> )<font class="keyword"></font>
05768 <font class="keyword">    </font>{
05769       <font class="keywordflow">for</font> ( std::vector&lt;METARECORD*&gt;::const_iterator r = records.begin();
05770             r != records.end();
05771             r++ ) {
05772         <font class="keyword">delete</font> *r;
05773       }
05774       records.clear();
05775     }
<a name="l05780"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">05780</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">mergePoint</a> ( <font class="keyword">const</font> LONG&amp; x, <font class="keyword">const</font> LONG&amp; y )<font class="keyword"></font>
05781 <font class="keyword">    </font>{
05782       POINT p;
05783       p.x = x;
05784       p.y = y;
05785       <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">mergePoint</a>( p );
05786     }
<a name="l05791"></a><a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a9">05791</a>     <font class="keywordtype">void</font> <a class="code" href="classEMF_1_1METAFILEDEVICECONTEXT.html#a8">mergePoint</a>( <font class="keyword">const</font> POINT&amp; p )<font class="keyword"></font>
05792 <font class="keyword">    </font>{
05793       POINT device_point;
05794 
05795       <font class="comment">// *** Note, it's possible for the global transformation matrix to</font>
05796       <font class="comment">// affect this too. ***</font>
05797 
05798       device_point.x = (LONG)( (<font class="keywordtype">float</font>)( p.x - window_org.x ) / window_ext.cx *
05799         viewport_ext.cx + viewport_org.x );
05800 
05801       device_point.y = (LONG)( (<font class="keywordtype">float</font>)( p.y - window_org.y ) / window_ext.cy *
05802         viewport_ext.cy + viewport_org.y );
05803 
05804       <font class="comment">// If the user didn't specify a bounding rectangle in the constructor,</font>
05805       <font class="comment">// compute one from this data, too.</font>
05806       <font class="keywordflow">if</font> ( device_point.x &lt; min_device_point.x ) {
05807         min_device_point.x = device_point.x;
05808         <font class="keywordflow">if</font> ( update_frame ) {
05809           header-&gt;rclBounds.left = min_device_point.x - 10;
05810           header-&gt;rclFrame.left = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.left *
05811             header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05812         }
05813       }
05814       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( device_point.x &gt; max_device_point.x ) {
05815         max_device_point.x = device_point.x;
05816         <font class="keywordflow">if</font> ( update_frame ) {
05817           header-&gt;rclBounds.right = max_device_point.x + 10;
05818           header-&gt;rclFrame.right = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.right *
05819             header-&gt;szlMillimeters.cx * 100 / header-&gt;szlDevice.cx );
05820         }
05821       }
05822 
05823       <font class="keywordflow">if</font> ( device_point.y &lt; min_device_point.y ) {
05824         min_device_point.y = device_point.y;
05825         <font class="keywordflow">if</font> ( update_frame ) {
05826           header-&gt;rclBounds.top = min_device_point.y - 10;
05827           header-&gt;rclFrame.top = (LONG)floor( (<font class="keywordtype">float</font>)header-&gt;rclBounds.top *
05828             header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05829         }
05830       }
05831       <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( device_point.y &gt; max_device_point.y ) {
05832         max_device_point.y = device_point.y;
05833         <font class="keywordflow">if</font> ( update_frame ) {
05834           header-&gt;rclBounds.bottom = max_device_point.y + 10;
05835           header-&gt;rclFrame.bottom = (LONG)ceil( (<font class="keywordtype">float</font>)header-&gt;rclBounds.bottom *
05836             header-&gt;szlMillimeters.cy * 100 / header-&gt;szlDevice.cy );
05837         }
05838       }
05839     }
05840   };
05841 
05842 } <font class="comment">// close EMF namespace</font>
05843 
05844 <font class="preprocessor">#endif </font><font class="comment">/* _LIBEMF_H */</font>
</pre></div><hr><address><small>Generated at Mon Jan 13 21:34:19 2003 for EMF by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.8.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
